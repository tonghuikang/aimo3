problem_id,problem,answer
aimo3-336,"Let $ABC$ be an acute-angled triangle with integer side lengths and $AB<AC$. Points $D$ and $E$ lie on segments $BC$ and $AC$, respectively, such that $AD=AE=AB$. Line $DE$ intersects $AB$ at $X$. Circles $BXD$ and $CED$ intersect for the second time at $Y \neq D$. Suppose that $Y$ lies on line $AD$. There is a unique such triangle with minimal perimeter. This triangle has side lengths $a=BC$, $b=CA$, and $c=AB$. Find the remainder when $abc$ is divided by $10^{5}$.",336
aimo3-32951,"Define a function $f \colon \mathbb{Z}_{\geq 1} \to \mathbb{Z}_{\geq 1}$ by
\begin{equation*}
    f(n) = \sum_{i = 1}^n \sum_{j = 1}^n j^{1024} \left\lfloor\frac1j + \frac{n-i}{n}\right\rfloor.
\end{equation*}
Let $M=2 \cdot 3 \cdot 5 \cdot 7 \cdot 11 \cdot 13$ and let $N = f{\left(M^{15}\right)} - f{\left(M^{15}-1\right)}$. Let $k$ be the largest non-negative integer such that $2^k$ divides $N$. What is the remainder when $2^k$ is divided by $5^7$?",32951
aimo3-21818,"A tournament is held with $2^{20}$ runners each of which has a different running speed. In each race, two runners compete against each other with the faster runner always winning the race. The competition consists of $20$ rounds with each runner starting with a score of $0$. In each round, the runners are paired in such a way that in each pair, both runners have the same score at the beginning of the round. The winner of each race in the $i^{\text{th}}$ round receives $2^{20-i}$ points and the loser gets no points.

At the end of the tournament, we rank the competitors according to their scores. Let $N$ denote the number of possible orderings of the competitors at the end of the tournament. Let $k$ be the largest positive integer such that $10^k$ divides $N$. What is the remainder when $k$ is divided by $10^{5}$?",21818
aimo3-32193,"On a blackboard, Ken starts off by writing a positive integer $n$ and then applies the following move until he first reaches $1$. Given that the number on the board is $m$, he chooses a base $b$, where $2 \leq b \leq m$, and considers the unique base-$b$ representation of $m$,
\begin{equation*}
    m = \sum_{k = 0}^\infty a_k \cdot b^k
\end{equation*}
where $a_k$ are non-negative integers and $0 \leq a_k < b$ for each $k$. Ken then erases $m$ on the blackboard and replaces it with $\sum\limits_{k = 0}^\infty a_k$.

Across all choices of $1 \leq n \leq 10^{10^5}$, the largest possible number of moves Ken could make is $M$. What is the remainder when $M$ is divided by $10^{5}$?",32193
aimo3-57447,"Let $ABC$ be a triangle with $AB \neq AC$, circumcircle $\Omega$, and incircle $\omega$. Let the contact points of $\omega$ with $BC$, $CA$, and $AB$ be $D$, $E$, and $F$, respectively. Let the circumcircle of $AFE$ meet $\Omega$ at $K$ and let the reflection of $K$ in $EF$ be $K'$. Let $N$ denote the foot of the perpendicular from $D$ to $EF$. The circle tangent to line $BN$ and passing through $B$ and $K$ intersects $BC$ again at $T \neq B$. 
    
Let sequence $(F_n)_{n \geq 0}$ be defined by $F_0 = 0$, $F_1 = 1$ and for $n \geq 2$, $F_n = F_{n-1} + F_{n-2}$. Call $ABC$ $n$\emph{-tastic} if $BD = F_n$, $CD = F_{n+1}$, and $KNK'B$ is cyclic. Across all $n$-tastic triangles, let $a_n$ denote the maximum possible value of $\frac{CT \cdot NB}{BT \cdot NE}$. Let $\alpha$ denote the smallest real number such that for all sufficiently large $n$, $a_{2n} < \alpha$. Given that $\alpha = p + \sqrt{q}$ for rationals $p$ and $q$, what is the remainder when $\left\lfloor p^{q^p} \right\rfloor$ is divided by $99991$?",57447
aimo3-8687,"Let $n \geq 6$ be a positive integer. We call a positive integer $n$-Norwegian if it has three distinct positive divisors whose sum is equal to $n$. Let $f(n)$ denote the smallest $n$-Norwegian positive integer. Let $M=3^{2025!}$ and for a non-negative integer $c$ define 
\begin{equation*}
    g(c)=\frac{1}{2025!}\left\lfloor \frac{2025! f(M+c)}{M}\right\rfloor.
\end{equation*}
We can write 
\begin{equation*}
    g(0)+g(4M)+g(1848374)+g(10162574)+g(265710644)+g(44636594)=\frac{p}{q}
\end{equation*}
where $p$ and $q$ are coprime positive integers. What is the remainder when $p+q$ is divided by $99991$?",8687
aimo3-50,"Alice and Bob are each holding some integer number of sweets. Alice says to Bob: ``If we each added the number of sweets we're holding to our (positive integer) age, my answer would be double yours. If we took the product, then my answer would be four times yours.'' Bob replies: ``Why don't you give me five of your sweets because then both our sum and product would be equal.'' What is the product of Alice and Bob's ages?",50
aimo3-580,"Let $f \colon \mathbb{Z}_{\geq 1} \to \mathbb{Z}_{\geq 1}$ be a function such that for all positive integers $m$ and $n$, 
\begin{equation*}
    f(m) + f(n) = f(m + n + mn).
\end{equation*}
Across all functions $f$ such that $f(n) \leq 1000$ for all $n \leq 1000$, how many different values can $f(2024)$ take?",580
aimo3-520,"A $500 \times 500$ square is divided into $k$ rectangles, each having integer side lengths. Given that no two of these rectangles have the same perimeter, the largest possible value of $k$ is $\mathcal{K}$. What is the remainder when $k$ is divided by $10^{5}$?",520
aimo3-160,"Let $\mathcal{F}$ be the set of functions $\alpha \colon \mathbb{Z}\to \mathbb{Z}$ for which there are only finitely many $n \in \mathbb{Z}$ such that $\alpha(n) \neq 0$. 

For two functions $\alpha$ and $\beta$ in $\mathcal{F}$, define their product $\alpha\star\beta$ to be $\sum\limits_{n\in\mathbb{Z}} \alpha(n)\cdot \beta(n)$. Also, for $n\in\mathbb{Z}$, define a shift operator $S_n \colon \mathcal{F}\to \mathcal{F}$ by $S_n(\alpha)(t)=\alpha(t+n)$ for all $t \in \mathbb{Z}$.

A function $\alpha \in \mathcal{F}$ is called \emph{shifty} if 
\begin{itemize}
    \item $\alpha(m)=0$ for all integers $m<0$ and $m>8$ and
    \item There exists $\beta \in \mathcal{F}$ and integers $k \neq l$ such that for all $n \in \mathbb{Z}$
    \begin{equation*}
        S_n(\alpha)\star\beta =
        \begin{cases}
            1 & n \in \{k,l\} \\
            0 & n \not \in \{k,l\}
        \end{cases}
        \; .
    \end{equation*}
\end{itemize}
How many shifty functions are there in $\mathcal{F}$?",160
pe-301,"Nim is a game played with heaps of stones, where two players take it in turn to remove any number of stones from any heap until no stones remain.

We'll consider the three-heap normal-play version of Nim, which works as follows:

- At the start of the game there are three heaps of stones.

- On each player's turn, the player may remove any positive number of stones from any single heap.

- The first player unable to move (because no stones remain) loses.

If $(n_1,n_2,n_3)$ indicates a Nim position consisting of heaps of size $n_1$, $n_2$, and $n_3$, then there is a simple function, which you may look up or attempt to deduce for yourself, $X(n_1,n_2,n_3)$ that returns:

- zero if, with perfect strategy, the player about to move will eventually lose; or

- non-zero if, with perfect strategy, the player about to move will eventually win.

For example $X(1,2,3) = 0$ because, no matter what the current player does, the opponent can respond with a move that leaves two heaps of equal size, at which point every move by the current player can be mirrored by the opponent until no stones remain; so the current player loses. To illustrate:

- current player moves to $(1,2,1)$

- opponent moves to $(1,0,1)$

- current player moves to $(0,0,1)$

- opponent moves to $(0,0,0)$, and so wins.

For how many positive integers $n \le 2^{30}$ does $X(n,2n,3n) = 0$ ?

Give your answer modulo $99991$.",REDACTED
pe-302,"A positive integer $n$ is powerful if $p^2$ is a divisor of $n$ for every prime factor $p$ in $n$.

A positive integer $n$ is a perfect power if $n$ can be expressed as a power of another positive integer.

A positive integer $n$ is an Achilles number if $n$ is powerful but not a perfect power. For example, $864$ and $1800$ are Achilles numbers: $864 = 2^5 \cdot 3^3$ and $1800 = 2^3 \cdot 3^2 \cdot 5^2$.

We shall call a positive integer $S$ a Strong Achilles number if both $S$ and $\phi(S)$ are Achilles numbers.1

For example, $864$ is a Strong Achilles number: $\phi(864) = 288 = 2^5 \cdot 3^2$. However, $1800$ isn't a Strong Achilles number because: $\phi(1800) = 480 = 2^5 \cdot 3^1 \cdot 5^1$.

There are $7$ Strong Achilles numbers below $10^4$ and $656$ below $10^8$.

How many Strong Achilles numbers are there below $10^{18}$?

1 $\phi$ denotes Euler's totient function.

Give your answer modulo $99991$.",REDACTED
pe-303,"For a positive integer $n$, define $f(n)$ as the least positive multiple of $n$ that, written in base $10$, uses only digits $\le 2$.

Thus $f(2)=2$, $f(3)=12$, $f(7)=21$, $f(42)=210$, $f(89)=1121222$.

Also, $\sum \limits_{n = 1}^{100} {\dfrac{f(n)}{n}} = 11363107$.

Find $\sum \limits_{n=1}^{10000} {\dfrac{f(n)}{n}}$.

Give your answer modulo $99991$.",REDACTED
pe-304,"For any positive integer $n$ the function $\operatorname{next\_prime}(n)$ returns the smallest prime $p$ such that $p \gt n$.

The sequence $a(n)$ is defined by:

$a(1)=\operatorname{next\_prime}(10^{14})$ and $a(n)=\operatorname{next\_prime}(a(n-1))$ for $n \gt 1$.

The Fibonacci sequence $f(n)$ is defined by:
$f(0)=0$, $f(1)=1$ and $f(n)=f(n-1)+f(n-2)$ for $n \gt 1$.

The sequence $b(n)$ is defined as $f(a(n))$.

Find $\sum b(n)$ for $1 \le n \le 100\,000$. 
Give your answer mod $1234567891011$.",REDACTED
pe-305,"Let's call $S$ the (infinite) string that is made by concatenating the consecutive positive integers (starting from $1$)  written down in base $10$.
 
Thus, $S = 1234567891011121314151617181920212223242\cdots$

It's easy to see that any number will show up an infinite number of times in $S$.

Let's call $f(n)$ the starting position of the $n$th occurrence of $n$ in $S$.
 
For example, $f(1)=1$, $f(5)=81$, $f(12)=271$ and $f(7780)=111111365$.

Find $\sum f(3^k)$ for $1 \le k \le 13$.

Give your answer modulo $99991$.",REDACTED
pe-308,"A program written in the programming language Fractran consists of a list of fractions.

The internal state of the Fractran Virtual Machine is a positive integer, which is initially set to a seed value. Each iteration of a Fractran program multiplies the state integer by the first fraction in the list which will leave it an integer.

For example, one of the Fractran programs that John Horton Conway wrote for prime-generation consists of the following 14 fractions:

$$\dfrac{17}{91}, \dfrac{78}{85}, \dfrac{19}{51}, \dfrac{23}{38}, \dfrac{29}{33}, \dfrac{77}{29}, \dfrac{95}{23}, \dfrac{77}{19}, \dfrac{1}{17}, \dfrac{11}{13}, \dfrac{13}{11}, \dfrac{15}{2}, \dfrac{1}{7}, \dfrac{55}{1}$$

Starting with the seed integer 2, successive iterations of the program produce the sequence:

15, 825, 725, 1925, 2275, 425, ..., 68, 4, 30, ..., 136, 8, 60, ..., 544, 32, 240, ...

The powers of 2 that appear in this sequence are 22, 23, 25, ...

It can be shown that all the powers of 2 in this sequence have prime exponents and that all the primes appear as exponents of powers of 2, in proper order!

If someone uses the above Fractran program to solve Project Euler Problem 7 (find the 10001st prime), how many iterations would be needed until the program produces 210001st prime ?

Give your answer modulo $99991$.",REDACTED
pe-310,"Alice and Bob play the game Nim Square.

Nim Square is just like ordinary three-heap normal play Nim, but the players may only remove a square number of stones from a heap.

The number of stones in the three heaps is represented by the ordered triple $(a,b,c)$.

If $0 \le a \le b \le c \le 29$ then the number of losing positions for the next player is $1160$.

Find the number of losing positions for the next player if $0 \le a \le b \le c \le 100\,000$.

Give your answer modulo $99991$.",REDACTED
pe-316,"Let $p = p_1 p_2 p_3 \cdots$ be an infinite sequence of random digits, selected from $\{0,1,2,3,4,5,6,7,8,9\}$ with equal probability.

It can be seen that $p$ corresponds to the real number $0.p_1 p_2 p_3 \cdots$ 

It can also be seen that choosing a random real number from the interval $[0,1)$ is equivalent to choosing an infinite sequence of random digits selected from $\{0,1,2,3,4,5,6,7,8,9\}$ with equal probability.

For any positive integer $n$ with $d$ decimal digits, let $k$ be the smallest index such that $p_k, p_{k + 1}, \dots, p_{k + d - 1}$ are the decimal digits of $n$, in the same order.

Also, let $g(n)$ be the expected value of $k$; it can be proven that $g(n)$ is always finite and, interestingly, always an integer number.

For example, if $n = 535$, then

for $p = 31415926\mathbf{535}897\cdots$, we get $k = 9$

for $p = 35528714365004956000049084876408468\mathbf{535}4\cdots$, we get $k = 36$

etc and we find that $g(535) = 1008$.

Given that $\displaystyle\sum_{n = 2}^{999} g \left(\left\lfloor\frac{10^6} n \right\rfloor\right) = 27280188$, find $\displaystyle\sum_{n = 2}^{999999} g \left(\left\lfloor\frac{10^{16}} n \right\rfloor\right)$.

Note: $\lfloor x \rfloor$ represents the floor function.

Give your answer modulo $99991$.",REDACTED
pe-318,"Consider the real number $\sqrt 2 + \sqrt 3$.

When we calculate the even powers of $\sqrt 2 + \sqrt 3$
we get:

$(\sqrt 2 + \sqrt 3)^2 = 9.898979485566356 \cdots $

$(\sqrt 2 + \sqrt 3)^4 = 97.98979485566356 \cdots $

$(\sqrt 2 + \sqrt 3)^6 = 969.998969071069263 \cdots $

$(\sqrt 2 + \sqrt 3)^8 = 9601.99989585502907 \cdots $

$(\sqrt 2 + \sqrt 3)^{10} = 95049.999989479221 \cdots $

$(\sqrt 2 + \sqrt 3)^{12} = 940897.9999989371855 \cdots $

$(\sqrt 2 + \sqrt 3)^{14} = 9313929.99999989263 \cdots $

$(\sqrt 2 + \sqrt 3)^{16} = 92198401.99999998915 \cdots $

It looks as if the number of consecutive nines at the beginning of the fractional part of these powers is non-decreasing.

In fact it can be proven that the fractional part of $(\sqrt 2 + \sqrt 3)^{2 n}$ approaches $1$ for large $n$.

Consider all real numbers of the form $\sqrt p + \sqrt q$ with $p$ and $q$ positive integers and $p &lt; q$, such that the fractional part 
of $(\sqrt p + \sqrt q)^{ 2 n}$ approaches $1$ for large $n$.

Let $C(p,q,n)$ be the number of consecutive nines at the beginning of the fractional part of $(\sqrt p + \sqrt q)^{ 2 n}$.

Let $N(p,q)$ be the minimal value of $n$ such that $C(p,q,n) \ge 2011$.

Find $\displaystyle \sum N(p,q) \,\, \text{ for } p+q \le 2011$.

Give your answer modulo $99991$.",REDACTED
pe-319,"Let $x_1, x_2, \dots, x_n$ be a sequence of length $n$ such that:

- $x_1 = 2$

- for all $1 \lt i \le n$: $x_{i - 1} \lt x_i$

- for all $i$ and $j$ with $1 \le i, j \le n$: $(x_i)^j \lt (x_j + 1)^i$.

There are only five such sequences of length $2$, namely:
$\{2,4\}$, $\{2,5\}$, $\{2,6\}$, $\{2,7\}$ and $\{2,8\}$.

There are $293$ such sequences of length $5$; three examples are given below:

$\{2,5,11,25,55\}$, $\{2,6,14,36,88\}$, $\{2,8,22,64,181\}$.

Let $t(n)$ denote the number of such sequences of length $n$.

You are given that $t(10) = 86195$ and $t(20) = 5227991891$.

Find $t(10^{10})$ and give your answer modulo $10^9$.",REDACTED
pe-320,"Let $N(i)$ be the smallest integer $n$ such that $n!$ is divisible by $(i!)^{1234567890}$

Let $S(u)=\sum N(i)$ for $10 \le i \le u$.

$S(1000)=614538266565663$.

Find $S(1\,000\,000) \bmod 10^{18}$.",REDACTED
pe-322,"Let $T(m, n)$ be the number of the binomial coefficients $^iC_n$ that are divisible by $10$ for $n \le i \lt m$ ($i$, $m$ and $n$ are positive integers).

You are given that $T(10^9, 10^7-10) = 989697000$.

Find $T(10^{18}, 10^{12}-10)$.

Give your answer modulo $99991$.",REDACTED
pe-324,"Let $f(n)$ represent the number of ways one can fill a $3 \times 3 \times n$ tower with blocks of $2 \times 1 \times 1$.
You're allowed to rotate the blocks in any way you like; however, rotations, reflections etc of the tower itself are counted as distinct.

For example (with $q = 100000007$):
$f(2) = 229$,
$f(4) = 117805$,
$f(10) \bmod q = 96149360$,
$f(10^3) \bmod q = 24806056$,
$f(10^6) \bmod q = 30808124$.

Find $f(10^{10000}) \bmod 100000007$.",REDACTED
pe-325,"A game is played with two piles of stones and two players.

On each player's turn, the player may remove a number of stones from the larger pile.

The number of stones removed must be a positive multiple of the number of stones in the smaller pile.

E.g. Let the ordered pair $(6,14)$ describe a configuration with $6$ stones in the smaller pile and $14$ stones in the larger pile, then the first player can remove $6$ or $12$ stones from the larger pile.

The player taking all the stones from a pile wins the game.

A winning configuration is one where the first player can force a win. For example, $(1,5)$, $(2,6)$, and $(3,12)$ are winning configurations because the first player can immediately remove all stones in the second pile.

A losing configuration is one where the second player can force a win, no matter what the first player does. For example, $(2,3)$ and $(3,4)$ are losing configurations: any legal move leaves a winning configuration for the second player.

Define $S(N)$ as the sum of $(x_i + y_i)$ for all losing configurations $(x_i, y_i), 0 \lt x_i \lt y_i \le N$.

We can verify that $S(10) = 211$ and $S(10^4) = 230312207313$.

Find $S(10^{16}) \bmod 7^{10}$.",REDACTED
pe-326,"Let $a_n$ be a sequence recursively defined by:$\quad a_1=1,\quad\displaystyle a_n=\biggl(\sum_{k=1}^{n-1}k\cdot a_k\biggr)\bmod n$.

So the first $10$ elements of $a_n$ are: $1,1,0,3,0,3,5,4,1,9$.

Let $f(N, M)$ represent the number of pairs $(p, q)$ such that: 

$$
\def\htmltext#1{\style{font-family:inherit;}{\text{#1}}}
1\le p\le q\le N \quad\htmltext{and}\quad\biggl(\sum_{i=p}^qa_i\biggr)\bmod M=0
$$

It can be seen that $f(10,10)=4$ with the pairs $(3,3)$, $(5,5)$, $(7,9)$ and $(9,10)$.

You are also given that $f(10^4,10^3)=97158$.

Find $f(10^{12},10^6)$.",REDACTED
pe-328,"We are trying to find a hidden number selected from the set of integers $\{1, 2, \dots, n\}$ by asking questions. 
Each number (question) we ask, has a cost equal to the number asked and we get one of three possible answers:

-  ""Your guess is lower than the hidden number"", or

-  ""Yes, that's it!"", or

-  ""Your guess is higher than the hidden number"".

Given the value of $n$, an optimal strategy minimizes the total cost (i.e. the sum of all the questions asked) for the worst possible case. E.g.

If $n=3$, the best we can do is obviously to ask the number ""2"". The answer will immediately lead us to find the hidden number (at a total cost $= 2$).

If $n=8$, we might decide to use a ""binary search"" type of strategy: Our first question would be ""$\mathbf 4$"" and if the hidden number is higher than $4$ we will need one or two additional questions.

Let our second question be ""$\mathbf 6$"". If the hidden number is still higher than $6$, we will need a third question in order to discriminate between $7$ and $8$.

Thus, our third question will be ""$\mathbf 7$"" and the total cost for this worst-case scenario will be $4+6+7={\color{red}\mathbf{17}}$.

We can improve considerably the worst-case cost for $n=8$, by asking ""$\mathbf 5$"" as our first question.

If we are told that the hidden number is higher than $5$, our second question will be ""$\mathbf 7$"", then we'll know for certain what the hidden number is (for a total cost of $5+7={\color{blue}\mathbf{12}}$).

If we are told that the hidden number is lower than $5$, our second question will be ""$\mathbf 3$"" and if the hidden number is lower than $3$ our third question will be ""$\mathbf 1$"", giving a total cost of $5+3+1={\color{blue}\mathbf 9}$.

Since ${\color{blue}\mathbf{12}} \gt {\color{blue}\mathbf 9}$, the worst-case cost for this strategy is ${\color{red}\mathbf{12}}$. That's better than what we achieved previously with the ""binary search"" strategy; it is also better than or equal to any other strategy.

So, in fact, we have just described an optimal strategy for $n=8$.

Let $C(n)$ be the worst-case cost achieved by an optimal strategy for $n$, as described above.

Thus $C(1) = 0$, $C(2) = 1$, $C(3) = 2$ and $C(8) = 12$.

Similarly, $C(100) = 400$ and $\sum \limits_{n = 1}^{100} C(n) = 17575$.

Find $\sum \limits_{n = 1}^{200000} C(n)$.

Give your answer modulo $99991$.",REDACTED
pe-330,"An infinite sequence of real numbers $a(n)$ is defined for all integers $n$ as follows:
$$a(n) = \begin{cases}
1 &amp; n \lt 0\\
\sum \limits_{i = 1}^{\infty}{\dfrac{a(n - i)}{i!}} &amp; n \ge 0
\end{cases}$$

For example,

$a(0) = \dfrac{1}{1!} + \dfrac{1}{2!} + \dfrac{1}{3!} + \cdots = e - 1$

$a(1) = \dfrac{e - 1}{1!} + \dfrac{1}{2!} + \dfrac{1}{3!} + \cdots = 2e - 3$

$a(2) = \dfrac{2e - 3}{1!} + \dfrac{e - 1}{2!} + \dfrac{1}{3!} + \cdots = \dfrac{7}{2}e - 6$

with $e = 2.7182818...$ being Euler's constant.

It can be shown that $a(n)$ is of the form $\dfrac{A(n)e + B(n)}{n!}$ for integers $A(n)$ and $B(n)$.

For example, $a(10) = \dfrac{328161643e - 652694486}{10!}$.

Find $A(10^9) + B(10^9)$ and give your answer mod $77\,777\,777$.",REDACTED
pe-333,"All positive integers can be partitioned in such a way that each and every term of the partition can be expressed as $2^i \times 3^j$, where $i,j \ge 0$.

Let's consider only such partitions where none of the terms can divide any of the other terms.

For example, the partition of $17 = 2 + 6 + 9 = (2^1 \times 3^0 + 2^1 \times 3^1 + 2^0 \times 3^2)$ would not be valid since $2$ can divide $6$. Neither would the partition $17 = 16 + 1 = (2^4 \times 3^0 + 2^0 \times 3^0)$ since $1$ can divide $16$. The only valid partition of $17$ would be $8 + 9 = (2^3 \times 3^0 + 2^0 \times 3^2)$.

Many integers have more than one valid partition, the first being $11$ having the following two partitions.

$11 = 2 + 9 = (2^1 \times 3^0 + 2^0 \times 3^2)$

$11 = 8 + 3 = (2^3 \times 3^0 + 2^0 \times 3^1)$

Let's define $P(n)$ as the number of valid partitions of $n$. For example, $P(11) = 2$.

Let's consider only the prime integers $q$ which would have a single valid partition such as $P(17)$.

The sum of the primes $q \lt 100$ such that $P(q)=1$ equals $233$.

Find the sum of the primes $q \lt 1000000$ such that $P(q)=1$.

Give your answer modulo $99991$.",REDACTED
pe-337,"Let $\{a_1, a_2, \dots, a_n\}$ be an integer sequence of length $n$ such that:

- $a_1 = 6$

- for all $1 \le i \lt n$: $\phi(a_i) \lt \phi(a_{i + 1}) \lt a_i \lt a_{i + 1}$.1

Let $S(N)$ be the number of such sequences with $a_n \le N$.

For example, $S(10) = 4$: $\{6\}$, $\{6, 8\}$, $\{6, 8, 9\}$ and $\{6, 10\}$.

We can verify that $S(100) = 482073668$ and $S(10\,000) \bmod 10^8 = 73808307$.

Find $S(20\,000\,000) \bmod 10^8$.

1 $\phi$ denotes Euler's totient function.",REDACTED
pe-340,"For fixed integers $a, b, c$, define the crazy function $F(n)$ as follows:

$F(n) = n - c$ for all $n \gt b$

$F(n) = F(a + F(a + F(a + F(a + n))))$ for all $n \le b$.

Also, define $S(a, b, c) = \sum \limits_{n = 0}^b F(n)$.

For example, if $a = 50$, $b = 2000$ and $c = 40$, then $F(0) = 3240$ and $F(2000) = 2040$.

Also, $S(50, 2000, 40) = 5204240$.

Find the last $9$ digits of $S(21^7, 7^{21}, 12^7)$.",REDACTED
pe-341,"The Golomb's self-describing sequence $(G(n))$ is the only nondecreasing sequence of natural numbers such that $n$ appears exactly $G(n)$ times in the sequence. The values of $G(n)$ for the first few $n$ are

$$
\begin{matrix}
n &amp; 1 &amp; 2 &amp; 3 &amp; 4 &amp; 5 &amp; 6 &amp; 7 &amp; 8 &amp; 9 &amp; 10 &amp; 11 &amp; 12 &amp; 13 &amp; 14 &amp; 15 &amp; \ldots \\
G(n) &amp; 1 &amp; 2 &amp; 2 &amp; 3 &amp; 3 &amp; 4 &amp; 4 &amp; 4 &amp; 5 &amp; 5 &amp; 5 &amp; 6 &amp; 6 &amp; 6 &amp; 6 &amp; \ldots
\end{matrix}
$$

You are given that $G(10^3) = 86$, $G(10^6) = 6137$.

You are also given that $\sum G(n^3) = 153506976$ for $1 \le n \lt 10^3$.

Find $\sum G(n^3)$ for $1 \le n \lt 10^6$.

Give your answer modulo $99991$.",REDACTED
pe-342,"Consider the number $50$.

$50^2 = 2500 = 2^2 \times 5^4$, so $\phi(2500) = 2 \times 4 \times 5^3 = 8 \times 5^3 = 2^3 \times 5^3$. 1

So $2500$ is a square and $\phi(2500)$ is a cube.

Find the sum of all numbers $n$, $1 \lt n \lt 10^{10}$ such that $\phi(n^2)$ is a cube.

1 $\phi$ denotes Euler's totient function.

Give your answer modulo $99991$.",REDACTED
pe-343,"For any positive integer $k$, a finite sequence $a_i$ of fractions $x_i/y_i$ is defined by:

$a_1 = 1/k$ and

$a_i = (x_{i - 1} + 1) / (y_{i - 1} - 1)$ reduced to lowest terms for $i \gt 1$.

When $a_i$ reaches some integer $n$, the sequence stops. (That is, when $y_i = 1$.)

Define $f(k) = n$. 

For example, for $k = 20$:

$1/20 \to 2/19 \to 3/18 = 1/6 \to 2/5 \to 3/4 \to 4/3 \to 5/2 \to 6/1 = 6$

So $f(20) = 6$.

Also $f(1) = 1$, $f(2) = 2$, $f(3) = 1$ and $\sum f(k^3) = 118937$ for $1 \le k \le 100$.

Find $\sum f(k^3)$ for $1 \le k \le 2 \times 10^6$.

Give your answer modulo $99991$.",REDACTED
pe-345,"We define the Matrix Sum of a matrix as the maximum possible sum of matrix elements such that none of the selected elements share the same row or column.

For example, the Matrix Sum of the matrix below equals 3315 ( = 863 + 383 + 343 + 959 + 767):

  7  53 183 439 863

497 383 563  79 973

287  63 343 169 583

627 343 773 959 943
767 473 103 699 303

Find the Matrix Sum of:

  7  53 183 439 863 497 383 563  79 973 287  63 343 169 583

627 343 773 959 943 767 473 103 699 303 957 703 583 639 913

447 283 463  29  23 487 463 993 119 883 327 493 423 159 743

217 623   3 399 853 407 103 983  89 463 290 516 212 462 350

960 376 682 962 300 780 486 502 912 800 250 346 172 812 350

870 456 192 162 593 473 915  45 989 873 823 965 425 329 803

973 965 905 919 133 673 665 235 509 613 673 815 165 992 326

322 148 972 962 286 255 941 541 265 323 925 281 601  95 973

445 721  11 525 473  65 511 164 138 672  18 428 154 448 848

414 456 310 312 798 104 566 520 302 248 694 976 430 392 198

184 829 373 181 631 101 969 613 840 740 778 458 284 760 390

821 461 843 513  17 901 711 993 293 157 274  94 192 156 574

 34 124   4 878 450 476 712 914 838 669 875 299 823 329 699

815 559 813 459 522 788 168 586 966 232 308 833 251 631 107

813 883 451 509 615  77 281 613 459 205 380 274 302  35 805

Give your answer modulo $99991$.",REDACTED
pe-346,"The number $7$ is special, because $7$ is $111$ written in base $2$, and $11$ written in base $6$ (i.e. $7_{10} = 11_6 = 111_2$). In other words, $7$ is a repunit in at least two bases $b \gt 1$. 

We shall call a positive integer with this property a strong repunit. It can be verified that there are $8$ strong repunits below $50$: $\{1,7,13,15,21,31,40,43\}$.

Furthermore, the sum of all strong repunits below $1000$ equals $15864$.

Find the sum of all strong repunits below $10^{12}$.

Give your answer modulo $99991$.",REDACTED
pe-347,"The largest integer $\le 100$ that is only divisible by both the primes $2$ and $3$ is $96$, as $96=32\times 3=2^5 \times 3$.
For two distinct primes $p$ and $q$ let $M(p,q,N)$ be the largest positive integer $\le N$ only divisible by both $p$ and $q$ and $M(p,q,N)=0$ if such a positive integer does not exist.

E.g. $M(2,3,100)=96$.
 
$M(3,5,100)=75$ and not $90$ because $90$ is divisible by $2$, $3$ and $5$.

Also $M(2,73,100)=0$ because there does not exist a positive integer $\le 100$ that is divisible by both $2$ and $73$.

Let $S(N)$ be the sum of all distinct $M(p,q,N)$.
$S(100)=2262$.

Find $S(10\,000\,000)$.

Give your answer modulo $99991$.",REDACTED
pe-348,"Many numbers can be expressed as the sum of a square and a cube. Some of them in more than one way.

Consider the palindromic numbers that can be expressed as the sum of a square and a cube, both greater than $1$, in exactly $4$ different ways.

For example, $5229225$ is a palindromic number and it can be expressed in exactly $4$ different ways:

$2285^2 + 20^3$

$2223^2 + 66^3$

$1810^2 + 125^3$

$1197^2 + 156^3$

 
Find the sum of the five smallest such palindromic numbers.

Give your answer modulo $99991$.",REDACTED
pe-349,"An ant moves on a regular grid of squares that are coloured either black or white.
 
The ant is always oriented in one of the cardinal directions (left, right, up or down) and moves from square to adjacent square according to the following rules:

- if it is on a black square, it flips the colour of the square to white, rotates $90$ degrees counterclockwise and moves forward one square.

- if it is on a white square, it flips the colour of the square to black, rotates $90$ degrees clockwise and moves forward one square.

Starting with a grid that is entirely white, how many squares are black after $10^{18}$ moves of the ant?

Give your answer modulo $99991$.",REDACTED
pe-350,"A list of size $n$ is a sequence of $n$ natural numbers.
 Examples are $(2,4,6)$, $(2,6,4)$, $(10,6,15,6)$, and $(11)$.

The greatest common divisor, or $\gcd$, of a list is the largest natural number that divides all entries of the list. 
Examples: $\gcd(2,6,4) = 2$, $\gcd(10,6,15,6) = 1$ and $\gcd(11) = 11$.

The least common multiple, or $\operatorname{lcm}$, of a list is the smallest natural number divisible by each entry of the list. 
Examples: $\operatorname{lcm}(2,6,4) = 12$, $\operatorname{lcm}(10,6,15,6) = 30$ and $\operatorname{lcm}(11) = 11$.

Let $f(G, L, N)$ be the number of lists of size $N$ with $\gcd \ge G$ and $\operatorname{lcm} \le L$. For example:

$f(10, 100, 1) = 91$.

$f(10, 100, 2) = 327$.

$f(10, 100, 3) = 1135$.

$f(10, 100, 1000) \bmod 101^4 = 3286053$.

Find $f(10^6, 10^{12}, 10^{18}) \bmod 101^4$.",REDACTED
pe-355,"Define $\operatorname{Co}(n)$ to be the maximal possible sum of a set of mutually co-prime elements from $\{1,2,\dots,n\}$.
 For example $\operatorname{Co}(10)$ is $30$ and hits that maximum on the subset $\{1,5,7,8,9\}$.

You are given that $\operatorname{Co}(30) = 193$ and $\operatorname{Co}(100) = 1356$. 

Find $\operatorname{Co}(200000)$.

Give your answer modulo $99991$.",REDACTED
pe-356,"Let $a_n$ be the largest real root of a polynomial $g(x) = x^3 - 2^n \cdot x^2 + n$.

For example, $a_2 = 3.86619826\cdots$

Find the last eight digits of $\sum \limits_{i = 1}^{30} \lfloor a_i^{987654321} \rfloor$.

Note: $\lfloor a \rfloor$ represents the floor function.",REDACTED
pe-357,"Consider the divisors of $30$: $1,2,3,5,6,10,15,30$.

It can be seen that for every divisor $d$ of $30$, $d + 30 / d$ is prime.

Find the sum of all positive integers $n$ not exceeding $100\,000\,000$
such that for every divisor $d$ of $n$, $d + n / d$ is prime.

Give your answer modulo $99991$.",REDACTED
pe-358,"A cyclic number with $n$ digits has a very interesting property:

When it is multiplied by $1, 2, 3, 4, \dots, n$, all the products have exactly the same digits, in the same order, but rotated in a circular fashion!

The smallest cyclic number is the $6$-digit number $142857$:

$142857 \times 1 = 142857$

$142857 \times 2 = 285714$

$142857 \times 3 = 428571$

$142857 \times 4 = 571428$

$142857 \times 5 = 714285$

$142857 \times 6 = 857142$

The next cyclic number is $0588235294117647$ with $16$ digits :

$0588235294117647 \times 1 = 0588235294117647$

$0588235294117647 \times 2 = 1176470588235294$

$0588235294117647 \times 3 = 1764705882352941$

$\dots$

$0588235294117647 \times 16 = 9411764705882352$

Note that for cyclic numbers, leading zeros are important.

There is only one cyclic number for which, the eleven leftmost digits are $00000000137$ and the five rightmost digits are $56789$ (i.e., it has the form $00000000137 \cdots 56789$ with an unknown number of digits in the middle). Find the sum of all its digits.

Give your answer modulo $99991$.",REDACTED
pe-359,"An infinite number of people (numbered $1$, $2$, $3$, etc.) are lined up to get a room at Hilbert's newest infinite hotel. The hotel contains an infinite number of floors (numbered $1$, $2$, $3$, etc.), and each floor contains an infinite number of rooms (numbered $1$, $2$, $3$, etc.). 

Initially the hotel is empty. Hilbert declares a rule on how the $n$th person is assigned a room: person $n$ gets the first vacant room in the lowest numbered floor satisfying either of the following:

- the floor is empty

- the floor is not empty, and if the latest person taking a room in that floor is person $m$, then $m + n$ is a perfect square

Person $1$ gets room $1$ in floor $1$ since floor $1$ is empty.

Person $2$ does not get room $2$ in floor $1$ since $1 + 2 = 3$ is not a perfect square.

Person $2$ instead gets room $1$ in floor $2$ since floor $2$ is empty.

Person $3$ gets room $2$ in floor $1$ since $1 + 3 = 4$ is a perfect square.

Eventually, every person in the line gets a room in the hotel.

Define $P(f, r)$ to be $n$ if person $n$ occupies room $r$ in floor $f$, and $0$ if no person occupies the room. Here are a few examples:

$P(1, 1) = 1$

$P(1, 2) = 3$

$P(2, 1) = 2$

$P(10, 20) = 440$

$P(25, 75) = 4863$

$P(99, 100) = 19454$

Find the sum of all $P(f, r)$ for all positive $f$ and $r$ such that $f \times r = 71328803586048$ and give the last $8$ digits as your answer.",REDACTED
pe-360,"Given two points $(x_1, y_1, z_1)$ and $(x_2, y_2, z_2)$ in three dimensional space, the Manhattan distance between those points is defined as
$|x_1 - x_2| + |y_1 - y_2| + |z_1 - z_2|$.

Let $C(r)$ be a sphere with radius $r$ and center in the origin $O(0,0,0)$.

Let $I(r)$ be the set of all points with integer coordinates on the surface of $C(r)$.

Let $S(r)$ be the sum of the Manhattan distances of all elements of $I(r)$ to the origin $O$.

E.g. $S(45)=34518$.

Find $S(10^{10})$.

Give your answer modulo $99991$.",REDACTED
pe-361,"The Thue-Morse sequence $\{T_n\}$ is a binary sequence satisfying:

- $T_0 = 0$

- $T_{2n} = T_n$

- $T_{2n + 1} = 1 - T_n$

The first several terms of $\{T_n\}$ are given as follows:

$01101001{\color{red}10010}1101001011001101001\cdots$

We define $\{A_n\}$ as the sorted sequence of integers such that the binary expression of each element appears as a subsequence in $\{T_n\}$.

For example, the decimal number $18$ is expressed as $10010$ in binary. $10010$ appears in $\{T_n\}$ ($T_8$ to $T_{12}$), so $18$ is an element of $\{A_n\}$.

The decimal number $14$ is expressed as $1110$ in binary. $1110$ never appears in $\{T_n\}$, so $14$ is not an element of $\{A_n\}$.

The first several terms of $\{A_n\}$ are given as follows:

<table align=""center""><tr>
<td align=""center"" width=""30"">$n$</td>
<td align=""right"" width=""30"">$0$</td>
<td align=""right"" width=""30"">$1$</td>
<td align=""right"" width=""30"">$2$</td>
<td align=""right"" width=""30"">$3$</td>
<td align=""right"" width=""30"">$4$</td>
<td align=""right"" width=""30"">$5$</td>
<td align=""right"" width=""30"">$6$</td>
<td align=""right"" width=""30"">$7$</td>
<td align=""right"" width=""30"">$8$</td>
<td align=""right"" width=""30"">$9$</td>
<td align=""right"" width=""30"">$10$</td>
<td align=""right"" width=""30"">$11$</td>
<td align=""right"" width=""30"">$12$</td>
<td align=""right"" width=""30"">$\cdots$</td>
</tr><tr>
<td align=""center"" width=""30"">$A_n$</td>
<td align=""right"" width=""30"">$0$</td>
<td align=""right"" width=""30"">$1$</td>
<td align=""right"" width=""30"">$2$</td>
<td align=""right"" width=""30"">$3$</td>
<td align=""right"" width=""30"">$4$</td>
<td align=""right"" width=""30"">$5$</td>
<td align=""right"" width=""30"">$6$</td>
<td align=""right"" width=""30"">$9$</td>
<td align=""right"" width=""30"">$10$</td>
<td align=""right"" width=""30"">$11$</td>
<td align=""right"" width=""30"">$12$</td>
<td align=""right"" width=""30"">$13$</td>
<td align=""right"" width=""30"">$18$</td>
<td align=""right"" width=""30"">$\cdots$</td>
</tr></table>

We can also verify that $A_{100} = 3251$ and $A_{1000} = 80852364498$.

Find the last $9$ digits of $\sum \limits_{k = 1}^{18} A_{10^k}$.",REDACTED
pe-362,"Consider the number $54$.

$54$ can be factored in $7$ distinct ways into one or more factors larger than $1$:

$54$, $2 \times 27$, $3 \times 18$, $6 \times 9$, $3 \times 3 \times 6$, $2 \times 3 \times 9$ and $2 \times 3 \times 3 \times 3$.

If we require that the factors are all squarefree only two ways remain: $3 \times 3 \times 6$ and $2 \times 3 \times 3 \times 3$.

Let's call $\operatorname{Fsf}(n)$ the number of ways $n$ can be factored into one or more squarefree factors larger than $1$, so
$\operatorname{Fsf}(54)=2$.

Let $S(n)$ be $\sum \operatorname{Fsf}(k)$ for $k=2$ to $n$.

$S(100)=193$.

Find $S(10\,000\,000\,000)$.

Give your answer modulo $99991$.",REDACTED
pe-365,"The binomial coefficient $\displaystyle{\binom{10^{18}}{10^9}}$ is a number with more than $9$ billion ($9\times 10^9$) digits.

Let $M(n,k,m)$ denote the binomial coefficient $\displaystyle{\binom{n}{k}}$ modulo $m$.

Calculate $\displaystyle{\sum M(10^{18},10^9,p\cdot q\cdot r)}$ for $1000\lt p\lt q\lt r\lt 5000$ and $p$,$q$,$r$ prime.",REDACTED
pe-366,"Two players, Anton and Bernhard, are playing the following game.

There is one pile of $n$ stones.

The first player may remove any positive number of stones, but not the whole pile.

Thereafter, each player may remove at most twice the number of stones his opponent took on the previous move.

The player who removes the last stone wins.

E.g. $n=5$.

If the first player takes anything more than one stone the next player will be able to take all remaining stones.

If the first player takes one stone, leaving four, his opponent will take also one stone, leaving three stones.

The first player cannot take all three because he may take at most $2 \times 1=2$ stones. So let's say he takes also one stone, leaving $2$. The second player can take the two remaining stones and wins.

So $5$ is a losing position for the first player.

For some winning positions there is more than one possible move for the first player.

E.g. when $n=17$ the first player can remove one or four stones.

Let $M(n)$ be the maximum number of stones the first player can take from a winning position at his first turn and $M(n)=0$ for any other position.

$\sum M(n)$ for $n \le 100$ is $728$.

Find $\sum M(n)$ for $n \le 10^{18}$.
Give your answer modulo $10^8$.",REDACTED
pe-367,"Bozo sort, not to be confused with the slightly less efficient bogo sort, consists out of checking if the input sequence is sorted and if not swapping randomly two elements. This is repeated until eventually the sequence is sorted.

If we consider all permutations of the first $4$ natural numbers as input the expectation value of the number of swaps, averaged over all $4!$ input sequences is $24.75$.

The already sorted sequence takes $0$ steps. 

In this problem we consider the following variant on bozo sort.

If the sequence is not in order we pick three elements at random and shuffle these three elements randomly.

All $3!=6$ permutations of those three elements are equally likely. 

The already sorted sequence will take $0$ steps.

If we consider all permutations of the first $4$ natural numbers as input the expectation value of the number of shuffles, averaged over all $4!$ input sequences is $27.5$. 

Consider as input sequences the permutations of the first $11$ natural numbers.

Averaged over all $11!$ input sequences, what is the expected number of shuffles this sorting algorithm will perform?

Give your answer rounded to the nearest integer.

Give your answer modulo $99991$.",REDACTED
pe-369,"In a standard $52$ card deck of playing cards, a set of $4$ cards is a Badugi if it contains $4$ cards with no pairs and no two cards of the same suit.

Let $f(n)$ be the number of ways to choose $n$ cards with a $4$ card subset that is a Badugi.  For example, there are $2598960$ ways to choose five cards from a standard $52$ card deck, of which $514800$ contain a $4$ card subset that is a Badugi, so $f(5) = 514800$.

Find $\sum f(n)$ for $4 \le n \le 13$.

Give your answer modulo $99991$.",REDACTED
pe-370,"Let us define a geometric triangle as an integer sided triangle with sides $a \le b \le c$ so that its sides form a geometric progression, i.e. $b^2 = a \cdot c$

 

An example of such a geometric triangle is the triangle with sides $a = 144$, $b = 156$ and $c = 169$.

There are $861805$ geometric triangles with perimeter $\le 10^6$.

How many geometric triangles exist with perimeter $\le 2.5 \cdot 10^{13}$?

Give your answer modulo $99991$.",REDACTED
pe-372,"Let $R(M, N)$ be the number of lattice points $(x, y)$ which satisfy $M\!\lt\!x\!\le\!N$, $M\!\lt\!y\!\le\!N$ and $\large\left\lfloor\!\frac{y^2}{x^2}\!\right\rfloor$ is odd.

We can verify that $R(0, 100) = 3019$ and $R(100, 10000) = 29750422$.

Find $R(2\cdot10^6, 10^9)$.

Note: $\lfloor x\rfloor$ represents the floor function.

Give your answer modulo $99991$.",REDACTED
pe-373,"Every triangle has a circumscribed circle that goes through the three vertices.
Consider all integer sided triangles for which the radius of the circumscribed circle is integral as well.

Let $S(n)$ be the sum of the radii of the circumscribed circles of all such triangles for which the radius does not exceed $n$.

$S(100)=4950$ and $S(1200)=1653605$.

Find $S(10^7)$.

Give your answer modulo $99991$.",REDACTED
pe-374,"An integer partition of a number $n$ is a way of writing $n$ as a sum of positive integers.

Partitions that differ only in the order of their summands are considered the same.
A partition of $n$ into distinct parts is a partition of $n$ in which every part occurs at most once.

The partitions of $5$ into distinct parts are:

$5$, $4+1$ and $3+2$.

Let $f(n)$ be the maximum product of the parts of any such partition of $n$ into distinct parts and let $m(n)$ be the number of elements of any such partition of $n$ with that product.

So $f(5)=6$ and $m(5)=2$.

For $n=10$ the partition with the largest product is $10=2+3+5$, which gives $f(10)=30$ and $m(10)=3$.

And their product, $f(10) \cdot m(10) = 30 \cdot 3 = 90$.

It can be verified that

$\sum f(n) \cdot m(n)$ for $1 \le n \le 100 = 1683550844462$.

Find $\sum f(n) \cdot m(n)$ for $1 \le n \le 10^{14}$.

Give your answer modulo $982451653$, the $50$ millionth prime.",REDACTED
pe-375,"Let $S_n$ be an integer sequence produced with the following pseudo-random number generator:

$$\begin{align}
S_0 &amp; = 290797 \\
S_{n+1} &amp; = S_n^2 \bmod 50515093
\end{align}$$

Let $A(i, j)$ be the minimum of the numbers $S_i, S_{i+1}, \dots, S_j$ for $i\le j$.

Let $M(N) = \sum A(i, j)$ for $1 \le i \le j \le N$.

We can verify that $M(10) = 432256955$ and $M(10\,000) = 3264567774119$.

Find $M(2\,000\,000\,000)$.",REDACTED
pe-376,"Consider the following set of dice with nonstandard pips:

Die $A$: $1$ $4$ $4$ $4$ $4$ $4$

Die $B$: $2$ $2$ $2$ $5$ $5$ $5$

Die $C$: $3$ $3$ $3$ $3$ $3$ $6$

A game is played by two players picking a die in turn and rolling it. The player who rolls the highest value wins.

If the first player picks die $A$ and the second player picks die $B$ we get

$P(\text{second player wins}) = 7/12 \gt 1/2$.

If the first player picks die $B$ and the second player picks die $C$ we get

$P(\text{second player wins}) = 7/12 \gt 1/2$.

If the first player picks die $C$ and the second player picks die $A$ we get

$P(\text{second player wins}) = 25/36 \gt 1/2$.

So whatever die the first player picks, the second player can pick another die and have a larger than $50\%$ chance of winning.

A set of dice having this property is called a nontransitive set of dice.

We wish to investigate how many sets of nontransitive dice exist. We will assume the following conditions:

- There are three six-sided dice with each side having between $1$ and $N$ pips, inclusive.

- Dice with the same set of pips are equal, regardless of which side on the die the pips are located.

- The same pip value may appear on multiple dice; if both players roll the same value neither player wins.

- The sets of dice $\{A,B,C\}$, $\{B,C,A\}$ and $\{C,A,B\}$ are the same set.

For $N = 7$ we find there are $9780$ such sets.

How many are there for $N = 30$?

Give your answer modulo $99991$.",REDACTED
pe-377,"There are $16$ positive integers that do not have a zero in their digits and that have a digital sum equal to $5$, namely: 

$5$, $14$, $23$, $32$, $41$, $113$, $122$, $131$, $212$, $221$, $311$, $1112$, $1121$, $1211$, $2111$ and $11111$.

Their sum is $17891$.

Let $f(n)$ be the sum of all positive integers that do not have a zero in their digits and have a digital sum equal to $n$.

Find $\displaystyle \sum_{i=1}^{17} f(13^i)$.

Give the last $9$ digits as your answer.",REDACTED
pe-378,"Let $T(n)$ be the nth triangle number, so $T(n) = \dfrac{n(n + 1)}{2}$.

Let $dT(n)$ be the number of divisors of $T(n)$.

E.g.: $T(7) = 28$ and $dT(7) = 6$.

Let $Tr(n)$ be the number of triples $(i, j, k)$ such that $1 \le i \lt j \lt k \le n$ and $dT(i) \gt dT(j) \gt dT(k)$.

$Tr(20) = 14$, $Tr(100) = 5772$, and $Tr(1000) = 11174776$.

Find $Tr(60 000 000)$. 

Give the last 18 digits of your answer.",REDACTED
pe-379,"Let $f(n)$ be the number of couples $(x, y)$ with $x$ and $y$ positive integers, $x \le y$ and the least common multiple of $x$ and $y$ equal to $n$.

Let $g$ be the summatory function of $f$, i.e.: 
$g(n) = \sum f(i)$ for $1 \le i \le n$.

You are given that $g(10^6) = 37429395$.

Find $g(10^{12})$.

Give your answer modulo $99991$.",REDACTED
pe-381,"For a prime $p$ let $S(p) = (\sum (p-k)!) \bmod (p)$ for $1 \le k \le 5$.

For example, if $p=7$,

$(7-1)! + (7-2)! + (7-3)! + (7-4)! + (7-5)! = 6! + 5! + 4! + 3! + 2! = 720+120+24+6+2 = 872$.
 
As $872 \bmod (7) = 4$, $S(7) = 4$.

It can be verified that $\sum S(p) = 480$ for $5 \le p \lt 100$.

Find $\sum S(p)$ for $5 \le p \lt 10^8$.",REDACTED
pe-382,"A polygon is a flat shape consisting of straight line segments that are joined to form a closed chain or circuit. A polygon consists of at least three sides and does not self-intersect.

A set $S$ of positive numbers is said to generate a polygon $P$ if:

-  no two sides of $P$ are the same length,

-  the length of every side of $P$ is in $S$, and

-  $S$ contains no other value.

For example:

The set $\{3, 4, 5\}$ generates a polygon with sides $3$, $4$, and $5$ (a triangle).

The set $\{6, 9, 11, 24\}$ generates a polygon with sides $6$, $9$, $11$, and $24$ (a quadrilateral).

The sets $\{1, 2, 3\}$ and $\{2, 3, 4, 9\}$ do not generate any polygon at all.

Consider the sequence $s$, defined as follows:

- $s_1 = 1$, $s_2 = 2$, $s_3 = 3$

- $s_n = s_{n-1} + s_{n-3}$ for $n \gt 3$.

Let $U_n$ be the set $\{s_1, s_2, \dots, s_n\}$. For example, $U_{10} = \{1, 2, 3, 4, 6, 9, 13, 19, 28, 41\}$.

Let $f(n)$ be the number of subsets of $U_n$ which generate at least one polygon.

For example, $f(5) = 7$, $f(10) = 501$ and $f(25) = 18635853$.

Find the last $9$ digits of $f(10^{18})$.",REDACTED
pe-383,"Let $f_5(n)$ be the largest integer $x$ for which $5^x$ divides $n$.

For example, $f_5(625000) = 7$.

Let $T_5(n)$ be the number of integers $i$ which satisfy $f_5((2 \cdot i - 1)!) \lt 2 \cdot f_5(i!)$ and $1 \le i \le n$.

It can be verified that $T_5(10^3) = 68$ and $T_5(10^9) = 2408210$.

Find $T_5(10^{18})$.

Give your answer modulo $99991$.",REDACTED
pe-384,"Define the sequence $a(n)$ as the number of adjacent pairs of ones in the binary expansion of $n$ (possibly overlapping).

E.g.: $a(5) = a(101_2) = 0$, $a(6) = a(110_2) = 1$, $a(7) = a(111_2) = 2$.

Define the sequence $b(n) = (-1)^{a(n)}$.

This sequence is called the Rudin-Shapiro sequence.

Also consider the summatory sequence of $b(n)$: $s(n) = \sum \limits_{i = 0}^n b(i)$.

The first couple of values of these sequences are:

<table align=""center""><tr>
<td align=""center"" width=""30"">$n$</td>
<td align=""right"" width=""30"">$0$</td>
<td align=""right"" width=""30"">$1$</td>
<td align=""right"" width=""30"">$2$</td>
<td align=""right"" width=""30"">$3$</td>
<td align=""right"" width=""30"">$4$</td>
<td align=""right"" width=""30"">$5$</td>
<td align=""right"" width=""30"">$6$</td>
<td align=""right"" width=""30"">$7$</td>
</tr><tr>
<td align=""center"" width=""30"">$a(n)$</td>
<td align=""right"" width=""30"">$0$</td>
<td align=""right"" width=""30"">$0$</td>
<td align=""right"" width=""30"">$0$</td>
<td align=""right"" width=""30"">$1$</td>
<td align=""right"" width=""30"">$0$</td>
<td align=""right"" width=""30"">$0$</td>
<td align=""right"" width=""30"">$1$</td>
<td align=""right"" width=""30"">$2$</td>
</tr><tr>
<td align=""center"" width=""30"">$b(n)$</td>
<td align=""right"" width=""30"">$1$</td>
<td align=""right"" width=""30"">$1$</td>
<td align=""right"" width=""30"">$1$</td>
<td align=""right"" width=""30"">$-1$</td>
<td align=""right"" width=""30"">$1$</td>
<td align=""right"" width=""30"">$1$</td>
<td align=""right"" width=""30"">$-1$</td>
<td align=""right"" width=""30"">$1$</td>
</tr><tr>
<td align=""center"" width=""30"">$s(n)$</td>
<td align=""right"" width=""30"">$1$</td>
<td align=""right"" width=""30"">$2$</td>
<td align=""right"" width=""30"">$3$</td>
<td align=""right"" width=""30"">$2$</td>
<td align=""right"" width=""30"">$3$</td>
<td align=""right"" width=""30"">$4$</td>
<td align=""right"" width=""30"">$3$</td>
<td align=""right"" width=""30"">$4$</td>
</tr></table>

The sequence $s(n)$ has the remarkable property that all elements are positive and every positive integer $k$ occurs exactly $k$ times.

Define $g(t,c)$, with $1 \le c \le t$, as the index in $s(n)$ for which $t$ occurs for the $c$'th time in $s(n)$.

E.g.: $g(3,3) = 6$, $g(4,2) = 7$ and $g(54321,12345) = 1220847710$.

Let $F(n)$ be the Fibonacci sequence defined by:

$F(0)=F(1)=1$ and

$F(n)=F(n-1)+F(n-2)$ for $n \gt 1$.

Define $GF(t)=g(F(t),F(t-1))$.

Find $\sum GF(t)$ for $2 \le t \le 45$.

Give your answer modulo $99991$.",REDACTED
pe-386,"Let $n$ be an integer and $S(n)$ be the set of factors of $n$.

A subset $A$ of $S(n)$ is called an antichain of $S(n)$ if $A$ contains only one element or if none of the elements of $A$ divides any of the other elements of $A$.

For example: $S(30) = \{1, 2, 3, 5, 6, 10, 15, 30\}$.

$\{2, 5, 6\}$ is not an antichain of $S(30)$.

$\{2, 3, 5\}$ is an antichain of $S(30)$.

Let $N(n)$ be the maximum length of an antichain of $S(n)$.

Find $\sum N(n)$ for $1 \le n \le 10^8$.

Give your answer modulo $99991$.",REDACTED
pe-387,"A Harshad or Niven number is a number that is divisible by the sum of its digits.

$201$ is a Harshad number because it is divisible by $3$ (the sum of its digits.)

When we truncate the last digit from $201$, we get $20$, which is a Harshad number.

When we truncate the last digit from $20$, we get $2$, which is also a Harshad number.

Let's call a Harshad number that, while recursively truncating the last digit, always results in a Harshad number a right truncatable Harshad number.

  

Also:

$201/3=67$ which is prime.

Let's call a Harshad number that, when divided by the sum of its digits, results in a prime a strong Harshad number.

Now take the number $2011$ which is prime.

When we truncate the last digit from it we get $201$, a strong Harshad number that is also right truncatable.

Let's call such primes strong, right truncatable Harshad primes.

You are given that the sum of the strong, right truncatable Harshad primes less than $10000$ is $90619$.

Find the sum of the strong, right truncatable Harshad primes less than $10^{14}$.

Give your answer modulo $99991$.",REDACTED
pe-388,"Consider all lattice points $(a,b,c)$ with $0 \le a,b,c \le N$.

From the origin $O(0,0,0)$ all lines are drawn to the other lattice points.

Let $D(N)$ be the number of distinct such lines.

You are given that $D(1\,000\,000) = 831909254469114121$.

Find $D(10^{10})$. Give as your answer the first nine digits followed by the last nine digits.",REDACTED
pe-390,"Consider the triangle with sides $\sqrt 5$, $\sqrt {65}$ and $\sqrt {68}$.
It can be shown that this triangle has area $9$.

$S(n)$ is the sum of the areas of  all triangles with sides $\sqrt{1+b^2}$, $\sqrt {1+c^2}$ and $\sqrt{b^2+c^2}\,$ (for positive integers $b$ and $c$) that have an integral area not exceeding $n$.

The example triangle has $b=2$ and $c=8$.

$S(10^6)=18018206$.

Find $S(10^{10})$.

Give your answer modulo $99991$.",REDACTED
pe-391,"Let $s_k$ be the number of 1’s when writing the numbers from 0 to $k$ in binary.

For example, writing 0 to 5 in binary, we have $0, 1, 10, 11, 100, 101$. There are seven 1’s, so $s_5 = 7$.

The sequence $S = \{s_k : k \ge 0\}$ starts $\{0, 1, 2, 4, 5, 7, 9, 12, ...\}$.

A game is played by two players. Before the game starts, a number $n$ is chosen. A counter $c$ starts at 0. At each turn, the player chooses a number from 1 to $n$ (inclusive) and increases $c$ by that number. The resulting value of $c$ must be a member of $S$. If there are no more valid moves, then the player loses.

For example, with $n = 5$ and starting with $c = 0$:

Player 1 chooses 4, so $c$ becomes $0 + 4 = 4$.

Player 2 chooses 5, so $c$ becomes $4 + 5 = 9$.

Player 1 chooses 3, so $c$ becomes $9 + 3 = 12$.

etc.

Note that $c$ must always belong to $S$, and each player can increase $c$ by at most $n$.

Let $M(n)$ be the highest number that the first player could choose at the start to force a win, and $M(n) = 0$ if there is no such move. For example, $M(2) = 2$, $M(7) = 1$, and $M(20) = 4$.

It can be verified that $\sum{M(n)^3} = 8150$ for $1 \le n \le 20$.

Find $\sum{M(n)^3}$ for $1 \le n \le 1000$.

Give your answer modulo $99991$.",REDACTED
pe-393,"An $n \times n$ grid of squares contains $n^2$ ants, one ant per square.

All ants decide to move simultaneously to an adjacent square (usually $4$ possibilities, except for ants on the edge of the grid or at the corners).

We define $f(n)$ to be the number of ways this can happen without any ants ending on the same square and without any two ants crossing the same edge between two squares.

You are given that $f(4) = 88$.

Find $f(10)$.

Give your answer modulo $99991$.",REDACTED
pe-396,"For any positive integer $n$, the $n$th weak Goodstein sequence $\{g_1, g_2, g_3, \dots\}$ is defined as:

-  $g_1 = n$

-  for $k \gt 1$, $g_k$ is obtained by writing $g_{k-1}$ in base $k$, interpreting it as a base $k + 1$ number, and subtracting $1$.

The sequence terminates when $g_k$ becomes $0$.

For example, the $6$th weak Goodstein sequence is $\{6, 11, 17, 25, \dots\}$:

-  $g_1 = 6$.

-  $g_2 = 11$ since $6 = 110_2$, $110_3 = 12$, and $12 - 1 = 11$.

-  $g_3 = 17$ since $11 = 102_3$, $102_4 = 18$, and $18 - 1 = 17$.

-  $g_4 = 25$ since $17 = 101_4$, $101_5 = 26$, and $26 - 1 = 25$.

and so on.

It can be shown that every weak Goodstein sequence terminates.

Let $G(n)$ be the number of nonzero elements in the $n$th weak Goodstein sequence.

It can be verified that $G(2) = 3$, $G(4) = 21$ and $G(6) = 381$.

It can also be verified that $\sum G(n) = 2517$ for $1 \le n \lt 8$.

Find the last $9$ digits of $\sum G(n)$ for $1 \le n \lt 16$.",REDACTED
pe-397,"On the parabola $y = x^2/k$, three points $A(a, a^2/k)$, $B(b, b^2/k)$ and $C(c, c^2/k)$ are chosen.

Let $F(K, X)$ be the number of the integer quadruplets $(k, a, b, c)$ such that at least one angle of the triangle $ABC$ is $45$-degree, with $1 \le k \le K$ and $-X \le a \lt b \lt c \le X$.

For example, $F(1, 10) = 41$ and $F(10, 100) = 12492$.

Find $F(10^6, 10^9)$.

Give your answer modulo $99991$.",REDACTED
pe-401,"The divisors of $6$ are $1,2,3$ and $6$.

The sum of the squares of these numbers is $1+4+9+36=50$.

Let $\operatorname{sigma}_2(n)$ represent the sum of the squares of the divisors of $n$.
Thus $\operatorname{sigma}_2(6)=50$.

Let $\operatorname{SIGMA}_2$ represent the summatory function of $\operatorname{sigma}_2$, that is $\operatorname{SIGMA}_2(n)=\sum \operatorname{sigma}_2(i)$ for $i=1$ to $n$.

The first $6$ values of $\operatorname{SIGMA}_2$ are: $1,6,16,37,63$ and $113$.

Find $\operatorname{SIGMA}_2(10^{15})$ modulo $10^9$.",REDACTED
pe-402,"It can be shown that the polynomial $n^4 + 4n^3 + 2n^2 + 5n$ is a multiple of $6$ for every integer $n$. It can also be shown that $6$ is the largest integer satisfying this property.

Define $M(a, b, c)$ as the maximum $m$ such that $n^4 + an^3 + bn^2 + cn$ is a multiple of $m$ for all integers $n$. For example, $M(4, 2, 5) = 6$.

Also, define $S(N)$ as the sum of $M(a, b, c)$ for all $0 \lt a, b, c \leq N$.

We can verify that $S(10) = 1972$ and $S(10000) = 2024258331114$.

Let $F_k$ be the Fibonacci sequence:

$F_0 = 0$, $F_1 = 1$ and

$F_k = F_{k-1} + F_{k-2}$ for $k \geq 2$.

Find the last $9$ digits of $\sum S(F_k)$ for $2 \leq k \leq 1234567890123$.",REDACTED
pe-403,"For integers $a$ and $b$, we define $D(a, b)$ as the domain enclosed by the parabola $y = x^2$ and the line $y = a\cdot x + b$:
$D(a, b) = \{(x, y) \mid x^2 \leq y \leq a\cdot x + b \}$.

$L(a, b)$ is defined as the number of lattice points contained in $D(a, b)$.

For example, $L(1, 2) = 8$ and $L(2, -1) = 1$.

We also define $S(N)$ as the sum of $L(a, b)$ for all the pairs $(a, b)$ such that the area of $D(a, b)$ is a rational number and $|a|,|b| \leq N$.

We can verify that $S(5) = 344$ and $S(100) = 26709528$.

Find $S(10^{12})$. Give your answer mod $10^8$.",REDACTED
pe-407,"If we calculate $a^2 \bmod 6$ for $0 \leq a \leq 5$ we get: $0,1,4,3,4,1$.

The largest value of $a$ such that $a^2 \equiv a \bmod 6$ is $4$.

Let's call $M(n)$ the largest value of $a \lt n$ such that $a^2 \equiv a \pmod n$.

So $M(6) = 4$.

Find $\sum M(n)$ for $1 \leq n \leq 10^7$.",REDACTED
pe-408,"Let's call a lattice point $(x, y)$ inadmissible if $x, y$ and $x+y$ are all positive perfect squares.

For example, $(9, 16)$ is inadmissible, while $(0, 4)$, $(3, 1)$ and $(9, 4)$ are not.

Consider a path from point $(x_1, y_1)$ to point $(x_2, y_2)$ using only unit steps north or east.

Let's call such a path admissible if none of its intermediate points are inadmissible.

Let $P(n)$ be the number of admissible paths from $(0, 0)$ to $(n, n)$.

It can be verified that $P(5) = 252$, $P(16) = 596994440$ and $P(1000) \bmod 1\,000\,000\,007 = 341920854$.

Find $P(10\,000\,000) \bmod 1\,000\,000\,007$.",REDACTED
pe-409,"Let $n$ be a positive integer. Consider nim positions where:

- There are $n$ non-empty piles.

- Each pile has size less than $2^n$.

- No two piles have the same size.

Let $W(n)$ be the number of winning nim positions satisfying the above conditions (a position is winning if the first player has a winning strategy). For example, $W(1) = 1$, $W(2) = 6$, $W(3) = 168$, $W(5) = 19764360$ and $W(100) \bmod 1\,000\,000\,007 = 384777056$.

Find $W(10\,000\,000) \bmod 1\,000\,000\,007$.",REDACTED
pe-410,"Let $C$ be the circle with radius $r$, $x^2 + y^2 = r^2$. We choose two points $P(a, b)$ and $Q(-a, c)$ so that the line passing through $P$ and $Q$ is tangent to $C$.

For example, the quadruplet $(r, a, b, c) = (2, 6, 2, -7)$ satisfies this property.

Let $F(R, X)$ be the number of the integer quadruplets $(r, a, b, c)$ with this property, and with $0 \lt r \leq R$ and $0 \lt a \leq X$.

We can verify that $F(1, 5) = 10$, $F(2, 10) = 52$ and $F(10, 100) = 3384$.

Find $F(10^8, 10^9) + F(10^9, 10^8)$.

Give your answer modulo $99991$.",REDACTED
pe-413,"We say that a $d$-digit positive number (no leading zeros) is a one-child number if exactly one of its sub-strings is divisible by $d$.

For example, $5671$ is a $4$-digit one-child number. Among all its sub-strings $5$, $6$, $7$, $1$, $56$, $67$, $71$, $567$, $671$ and $5671$, only $56$ is divisible by $4$.

Similarly, $104$ is a $3$-digit one-child number because only $0$ is divisible by $3$.

$1132451$ is a $7$-digit one-child number because only $245$ is divisible by $7$.

Let $F(N)$ be the number of the one-child numbers less than $N$.

We can verify that $F(10) = 9$, $F(10^3) = 389$ and $F(10^7) = 277674$.

Find $F(10^{19})$.

Give your answer modulo $99991$.",REDACTED
pe-414,"$6174$ is a remarkable number; if we sort its digits in increasing order and subtract that number from the number you get when you sort the digits in decreasing order, we get $7641-1467=6174$.

Even more remarkable is that if we start from any $4$ digit number and repeat this process of sorting and subtracting, we'll eventually end up with $6174$ or immediately with $0$ if all digits are equal.
 
This also works with numbers that have less than $4$ digits if we pad the number with leading zeroes until we have $4$ digits.

E.g. let's start with the number $0837$:

$8730-0378=8352$

$8532-2358=6174$

$6174$ is called the Kaprekar constant. The process of sorting and subtracting and repeating this until either $0$ or the Kaprekar constant is reached is called the Kaprekar routine.

We can consider the Kaprekar routine for other bases and number of digits.
 
Unfortunately, it is not guaranteed a Kaprekar constant exists in all cases; either the routine can end up in a cycle for some input numbers or the constant the routine arrives at can be different for different input numbers.

However, it can be shown that for $5$ digits and a base $b = 6t+3\neq 9$, a Kaprekar constant exists.

E.g. base $15$: $(10,4,14,9,5)_{15}$

base $21$: $(14,6,20,13,7)_{21}$

Define $C_b$ to be the Kaprekar constant in base $b$ for $5$ digits.
Define the function $sb(i)$ to be

- $0$ if $i = C_b$ or if $i$ written in base $b$ consists of $5$ identical digits

- the number of iterations it takes the Kaprekar routine in base $b$ to arrive at $C_b$, otherwise

Note that we can define $sb(i)$ for all integers $i \lt b^5$. If $i$ written in base $b$ takes less than $5$ digits, the number is padded with leading zero digits until we have $5$ digits before applying the Kaprekar routine.

Define $S(b)$ as the sum of $sb(i)$ for $0 \lt i \lt b^5$.

E.g. $S(15) = 5274369$

$S(111) = 400668930299$

Find the sum of $S(6k+3)$ for $2 \leq k \leq 300$.

Give the last $18$ digits as your answer.",REDACTED
pe-415,"A set of lattice points $S$ is called a titanic set if there exists a line passing through exactly two points in $S$.

An example of a titanic set is $S = \{(0, 0), (0, 1), (0, 2), (1, 1), (2, 0), (1, 0)\}$, where the line passing through $(0, 1)$ and $(2, 0)$ does not pass through any other point in $S$.

On the other hand, the set $\{(0, 0), (1, 1), (2, 2), (4, 4)\}$ is not a titanic set since the line passing through any two points in the set also passes through the other two.

For any positive integer $N$, let $T(N)$ be the number of titanic sets $S$ whose every point $(x, y)$ satisfies $0 \leq x, y \leq N$.
It can be verified that $T(1) = 11$, $T(2) = 494$, $T(4) = 33554178$, $T(111) \bmod 10^8 = 13500401$ and $T(10^5) \bmod 10^8 = 63259062$.

Find $T(10^{11})\bmod 10^8$.",REDACTED
pe-416,"A row of $n$ squares contains a frog in the leftmost square. By successive jumps the frog goes to the rightmost square and then back to the leftmost square. On the outward trip he jumps one, two or three squares to the right, and on the homeward trip he jumps to the left in a similar manner. He cannot jump outside the squares. He repeats the round-trip travel $m$ times.

Let $F(m, n)$ be the number of the ways the frog can travel so that at most one square remains unvisited.

For example, $F(1, 3) = 4$, $F(1, 4) = 15$, $F(1, 5) = 46$, $F(2, 3) = 16$ and $F(2, 100) \bmod 10^9 = 429619151$.

Find the last $9$ digits of $F(10, 10^{12})$.",REDACTED
pe-417,"A unit fraction contains $1$ in the numerator. The decimal representation of the unit fractions with denominators $2$ to $10$ are given:

$$\begin{align}
1/2 &amp;= 0.5\\
1/3 &amp;=0.(3)\\
1/4 &amp;=0.25\\
1/5 &amp;= 0.2\\
1/6 &amp;= 0.1(6)\\
1/7 &amp;= 0.(142857)\\
1/8 &amp;= 0.125\\
1/9 &amp;= 0.(1)\\
1/10 &amp;= 0.1
\end{align}$$

Where $0.1(6)$ means $0.166666\cdots$, and has a $1$-digit recurring cycle. It can be seen that $1/7$ has a $6$-digit recurring cycle.

Unit fractions whose denominator has no other prime factors than $2$ and/or $5$ are not considered to have a recurring cycle.

We define the length of the recurring cycle of those unit fractions as $0$.

Let $L(n)$ denote the length of the recurring cycle of $1/n$.
You are given that $\sum L(n)$ for $3 \leq n \leq 1\,000\,000$ equals $55535191115$.

Find $\sum L(n)$ for $3 \leq n \leq 100\,000\,000$.

Give your answer modulo $99991$.",REDACTED
pe-418,"Let $n$ be a positive integer. An integer triple $(a, b, c)$ is called a factorisation triple of $n$ if:

- $1 \leq a \leq b \leq c$
- $a \cdot b \cdot c = n$.

Define $f(n)$ to be $a + b + c$ for the factorisation triple $(a, b, c)$ of $n$ which minimises $c / a$. One can show that this triple is unique.

For example, $f(165) = 19$, $f(100100) = 142$ and $f(20!) = 4034872$.

Find $f(43!)$.

Give your answer modulo $99991$.",REDACTED
pe-420,"A positive integer matrix is a matrix whose elements are all positive integers.

Some positive integer matrices can be expressed as a square of a positive integer matrix in two different ways. Here is an example:

$$\begin{pmatrix}
40 &amp; 12\\
48 &amp; 40
\end{pmatrix} =
\begin{pmatrix}
2 &amp; 3\\
12 &amp; 2
\end{pmatrix}^2 =
\begin{pmatrix}
6 &amp; 1\\
4 &amp; 6
\end{pmatrix}^2
$$

We define $F(N)$ as the number of the $2\times 2$ positive integer matrices which have a tracethe sum of the elements on the main diagonal less than $N$ and which can be expressed as a square of a positive integer matrix in two different ways.

We can verify that $F(50) = 7$ and $F(1000) = 1019$.

Find $F(10^7)$.

Give your answer modulo $99991$.",REDACTED
pe-421,"Numbers of the form $n^{15}+1$ are composite for every integer $n \gt 1$.

For positive integers $n$ and $m$ let $s(n,m)$ be defined as the sum of the distinct prime factors of $n^{15}+1$ not exceeding $m$.

E.g. $2^{15}+1 = 3 \times 3 \times 11 \times 331$.

So $s(2,10) = 3$ and $s(2,1000) = 3+11+331 = 345$.

Also $10^{15}+1 = 7 \times 11 \times 13 \times 211 \times 241 \times 2161 \times 9091$.

So $s(10,100) = 31$ and $s(10,1000) = 483$.

Find $\sum s(n,10^8)$ for $1 \leq n \leq 10^{11}$.

Give your answer modulo $99991$.",REDACTED
pe-423,"Let $n$ be a positive integer.

A 6-sided die is thrown $n$ times. Let $c$ be the number of pairs of consecutive throws that give the same value.

For example, if $n = 7$ and the values of the die throws are (1,1,5,6,6,6,3), then the following pairs of consecutive throws give the same value:

(1,1,5,6,6,6,3)

(1,1,5,6,6,6,3)

(1,1,5,6,6,6,3)

Therefore, $c = 3$ for (1,1,5,6,6,6,3).

Define $C(n)$ as the number of outcomes of throwing a 6-sided die $n$ times such that $c$ does not exceed $\pi(n)$.1

For example, $C(3) = 216$, $C(4) = 1290$, $C(11) = 361912500$ and $C(24) = 4727547363281250000$.

Define $S(L)$ as $\sum C(n)$ for $1 \leq n \leq L$.

For example, $S(50) \bmod 1\,000\,000\,007 = 832833871$.

Find $S(50\,000\,000) \bmod 1\,000\,000\,007$.

 1 $\pi$ denotes the prime-counting function, i.e. $\pi(n)$ is the number of primes $\leq n$.",REDACTED
pe-425,"Two positive numbers $A$ and $B$ are said to be connected (denoted by ""$A \leftrightarrow B$"") if one of these conditions holds:

(1) $A$ and $B$ have the same length and differ in exactly one digit; for example, $123 \leftrightarrow 173$.

(2) Adding one digit to the left of $A$ (or $B$) makes $B$ (or $A$); for example, $23 \leftrightarrow 223$ and $123 \leftrightarrow 23$.

We call a prime $P$ a $2$'s relative if there exists a chain of connected primes between $2$ and $P$ and no prime in the chain exceeds $P$.

For example, $127$ is a $2$'s relative. One of the possible chains is shown below:

$2 \leftrightarrow 3 \leftrightarrow 13 \leftrightarrow 113 \leftrightarrow 103 \leftrightarrow 107 \leftrightarrow 127$

However, $11$ and $103$ are not $2$'s relatives.

Let $F(N)$ be the sum of the primes $\leq N$ which are not $2$'s relatives.

We can verify that $F(10^3) = 431$ and $F(10^4) = 78728$.

Find $F(10^7)$.

Give your answer modulo $99991$.",REDACTED
pe-427,"A sequence of integers $S = \{s_i\}$ is called an $n$-sequence if it has $n$ elements and each element $s_i$ satisfies $1 \leq s_i \leq n$. Thus there are $n^n$ distinct $n$-sequences in total.
For example, the sequence $S = \{1, 5, 5, 10, 7, 7, 7, 2, 3, 7\}$ is a $10$-sequence.

For any sequence $S$, let $L(S)$ be the length of the longest contiguous subsequence of $S$ with the same value.
For example, for the given sequence $S$ above, $L(S) = 3$, because of the three consecutive $7$'s.

Let $f(n) = \sum L(S)$ for all $n$-sequences S.

For example, $f(3) = 45$, $f(7) = 1403689$ and $f(11) = 481496895121$.

Find $f(7\,500\,000) \bmod 1\,000\,000\,009$.",REDACTED
pe-429,"A unitary divisor $d$ of a number $n$ is a divisor of $n$ that has the property $\gcd(d, n/d) = 1$.

The unitary divisors of $4! = 24$ are $1, 3, 8$ and $24$.

The sum of their squares is $1^2 + 3^2 + 8^2 + 24^2 = 650$.

Let $S(n)$ represent the sum of the squares of the unitary divisors of $n$. Thus $S(4!)=650$.

Find $S(100\,000\,000!)$ modulo $1\,000\,000\,009$.",REDACTED
pe-432,"Let $S(n,m) = \sum\phi(n \times i)$ for $1 \leq i \leq m$. ($\phi$ is Euler's totient function)

You are given that $S(510510,10^6)= 45480596821125120$. 

Find $S(510510,10^{11})$.

Give the last $9$ digits of your answer.",REDACTED
pe-433,"Let $E(x_0, y_0)$ be the number of steps it takes to determine the greatest common divisor of $x_0$ and $y_0$ with Euclid's algorithm. More formally:
$x_1 = y_0$, $y_1 = x_0 \bmod y_0$
$x_n = y_{n-1}$, $y_n = x_{n-1} \bmod y_{n-1}$

$E(x_0, y_0)$ is the smallest $n$ such that $y_n = 0$.

We have $E(1,1) = 1$, $E(10,6) = 3$ and $E(6,10) = 4$.

Define $S(N)$ as the sum of $E(x,y)$ for $1 \leq x,y \leq N$.

We have $S(1) = 1$, $S(10) = 221$ and $S(100) = 39826$.

Find $S(5\cdot 10^6)$.",REDACTED
pe-435,"The Fibonacci numbers $\{f_n, n \ge 0\}$ are defined recursively as $f_n = f_{n-1} + f_{n-2}$ with base cases $f_0 = 0$ and $f_1 = 1$.

Define the polynomials $\{F_n, n \ge 0\}$ as $F_n(x) = \displaystyle{\sum_{i=0}^n f_i x^i}$.

For example, $F_7(x) = x + x^2 + 2x^3 + 3x^4 + 5x^5 + 8x^6 + 13x^7$, and $F_7(11) = 268\,357\,683$.

Let $n = 10^{15}$. Find the sum $\displaystyle{\sum_{x=0}^{100} F_n(x)}$ and give your answer modulo $1\,307\,674\,368\,000 \ (= 15!)$.",REDACTED
pe-437,"When we calculate $8^n$ modulo $11$ for $n=0$ to $9$ we get: $1, 8, 9, 6, 4, 10, 3, 2, 5, 7$.

As we see all possible values from $1$ to $10$ occur. So $8$ is a primitive root of $11$.

But there is more:

If we take a closer look we see:

$1+8=9$

$8+9=17 \equiv 6 \bmod 11$

$9+6=15 \equiv 4 \bmod 11$

$6+4=10$

$4+10=14 \equiv 3 \bmod 11$

$10+3=13 \equiv 2 \bmod 11$

$3+2=5$

$2+5=7$

$5+7=12 \equiv 1 \bmod 11$.

So the powers of $8 \bmod 11$ are cyclic with period $10$, and $8^n + 8^{n+1} \equiv 8^{n+2} \pmod{11}$.

$8$ is called a Fibonacci primitive root of $11$.

Not every prime has a Fibonacci primitive root.

There are $323$ primes less than $10000$ with one or more Fibonacci primitive roots and the sum of these primes is $1480491$.

Find the sum of the primes less than $100\,000\,000$ with at least one Fibonacci primitive root.",REDACTED
pe-438,"For an $n$-tuple of integers $t = (a_1, \dots, a_n)$, let $(x_1, \dots, x_n)$ be the solutions of the polynomial equation $x^n + a_1 x^{n-1} + a_2 x^{n-2} + \cdots + a_{n-1}x + a_n = 0$.

Consider the following two conditions:

- $x_1, \dots, x_n$ are all real.

- If $x_1, \dots, x_n$ are sorted, $\lfloor x_i\rfloor = i$ for $1 \leq i \leq n$. ($\lfloor \cdot \rfloor$: floor function.)

In the case of $n = 4$, there are $12$ $n$-tuples of integers which satisfy both conditions.

We define $S(t)$ as the sum of the absolute values of the integers in $t$.

For $n = 4$ we can verify that $\sum S(t) = 2087$ for all $n$-tuples $t$ which satisfy both conditions.

Find $\sum S(t)$ for $n = 7$.

Give your answer modulo $99991$.",REDACTED
pe-439,"Let $d(k)$ be the sum of all divisors of $k$.

We define the function $S(N) = \sum_{i=1}^N \sum_{j=1}^Nd(i \cdot j)$.

For example, $S(3) = d(1) + d(2) + d(3) + d(2) + d(4) + d(6) + d(3) + d(6) + d(9) = 59$.

You are given that $S(10^3) = 563576517282$ and $S(10^5) \bmod 10^9 = 215766508$.

Find $S(10^{11}) \bmod 10^9$.",REDACTED
pe-442,"An integer is called eleven-free if its decimal expansion does not contain any substring representing a power of $11$ except $1$.

For example, $2404$ and $13431$ are eleven-free, while $911$ and $4121331$ are not.

Let $E(n)$ be the $n$th positive eleven-free integer. For example, $E(3) = 3$, $E(200) = 213$ and $E(500\,000) = 531563$.

Find $E(10^{18})$.

Give your answer modulo $99991$.",REDACTED
pe-443,"Let $g(n)$ be a sequence defined as follows:

$g(4) = 13$,

$g(n) = g(n-1) + \gcd(n, g(n-1))$ for $n \gt 4$.

The first few values are:

    <table cellspacing=""1"" cellpadding=""5"" border=""0"" align=""center""><tr><td>$n$</td><td>4</td><td>5</td><td>6</td><td>7</td><td>8</td><td>9</td><td>10</td><td>11</td><td>12</td><td>13</td><td>14</td><td>15</td><td>16</td><td>17</td><td>18</td><td>19</td><td>20</td><td>...</td>
    </tr><tr><td>$g(n)$</td><td>13</td><td>14</td><td>16</td><td>17</td><td>18</td><td>27</td><td>28</td><td>29</td><td>30</td><td>31</td><td>32</td><td>33</td><td>34</td><td>51</td><td>54</td><td>55</td><td>60</td><td>...</td>
    </tr></table>

You are given that $g(1\,000) = 2524$ and $g(1\,000\,000) = 2624152$.

Find $g(10^{15})$.

Give your answer modulo $99991$.",REDACTED
pe-445,"For every integer $n&gt;1$, the family of functions $f_{n,a,b}$ is defined 
by  

$f_{n,a,b}(x)\equiv a x + b \mod n\,\,\, $ for $a,b,x$ integer and  $0&lt; a &lt;n, 0 \le b &lt; n,0 \le x &lt; n$. 

We will call $f_{n,a,b}$ a retraction if $\,\,\, f_{n,a,b}(f_{n,a,b}(x)) \equiv f_{n,a,b}(x) \mod n \,\,\,$ for every $0 \le x &lt; n$.

Let $R(n)$ be the number of retractions for $n$.

You are given that

$\displaystyle \sum_{k=1}^{99\,999} R(\binom {100\,000} k)  \equiv 628701600 \mod 1\,000\,000\,007$.

 
Find $\displaystyle \sum_{k=1}^{9\,999\,999} R(\binom {10\,000\,000} k)$.

Give your answer modulo $1\,000\,000\,007$.",REDACTED
pe-446,"For every integer $n&gt;1$, the family of functions $f_{n,a,b}$ is defined 
by  

$f_{n,a,b}(x)\equiv a x + b \mod n\,\,\, $ for $a,b,x$ integer and  $0&lt; a &lt;n, 0 \le b &lt; n,0 \le x &lt; n$. 

We will call $f_{n,a,b}$ a retraction if $\,\,\, f_{n,a,b}(f_{n,a,b}(x)) \equiv f_{n,a,b}(x) \mod n \,\,\,$ for every $0 \le x &lt; n$.

Let $R(n)$ be the number of retractions for $n$.

$\displaystyle F(N)=\sum_{n=1}^NR(n^4+4)$. 
 
$F(1024)=77532377300600$.

Find $F(10^7)$.

Give your answer modulo $1\,000\,000\,007$.",REDACTED
pe-447,"For every integer $n&gt;1$, the family of functions $f_{n,a,b}$ is defined 
by  

$f_{n,a,b}(x)\equiv a x + b \mod n\,\,\, $ for $a,b,x$ integer and  $0&lt; a &lt;n, 0 \le b &lt; n,0 \le x &lt; n$. 

We will call $f_{n,a,b}$ a retraction if $\,\,\, f_{n,a,b}(f_{n,a,b}(x)) \equiv f_{n,a,b}(x) \mod n \,\,\,$ for every $0 \le x &lt; n$.

Let $R(n)$ be the number of retractions for $n$.

$\displaystyle F(N)=\sum_{n=2}^N R(n)$. 
 
$F(10^7)\equiv 638042271 \mod 1\,000\,000\,007$.

Find $F(10^{14})$.

Give your answer modulo $1\,000\,000\,007$.",REDACTED
pe-448,"The function $\operatorname{\mathbf{lcm}}(a,b)$ denotes the least common multiple of $a$ and $b$.

Let $A(n)$ be the average of the values of $\operatorname{lcm}(n,i)$ for $1 \le i \le n$.

E.g: $A(2)=(2+2)/2=2$ and $A(10)=(10+10+30+20+10+30+70+40+90+10)/10=32$. 

Let $S(n)=\sum A(k)$ for $1 \le k \le n$.

$S(100)=122726$.

Find $S(99999999019) \bmod 999999017$.",REDACTED
pe-450,"A hypocycloid is the curve drawn by a point on a small circle rolling inside a larger circle. The parametric equations of a hypocycloid centered at the origin, and starting at the right most point is given by:

$$x(t) = (R - r) \cos(t) + r \cos(\frac {R - r} r t)$$
$$y(t) = (R - r) \sin(t) - r \sin(\frac {R - r} r t)$$

Where $R$ is the radius of the large circle and $r$ the radius of the small circle.

Let $C(R, r)$ be the set of distinct points with integer coordinates on the hypocycloid with radius R and r and for which there is a corresponding value of t such that $\sin(t)$ and $\cos(t)$ are rational numbers.

Let $S(R, r) = \sum_{(x,y) \in C(R, r)} |x| + |y|$ be the sum of the absolute values of the $x$ and $y$ coordinates of the points in $C(R, r)$.

Let $T(N) = \sum_{R = 3}^N \sum_{r=1}^{\lfloor \frac {R - 1} 2 \rfloor} S(R, r)$ be the sum of $S(R, r)$ for R and r positive integers, $R\leq N$  and $2r &lt; R$.

You are given:

<table>
<tr>
<td class=""right"">$C(3, 1)$</td><td>=</td><td>$\{(3, 0), (-1, 2), (-1,0), (-1,-2)\}$</td>
</tr>
<tr>
<td>$C(2500, 1000)$</td><td>=</td><td>$\{(2500, 0), (772, 2376), (772, -2376), (516, 1792), (516, -1792), (500, 0), (68, 504), (68, -504),$</td>
</tr>
<tr>
<td colspan=""2""> </td><td>$(-1356, 1088), (-1356, -1088), (-1500, 1000), (-1500, -1000)\}$</td>
</tr>
</table>

Note: $(-625, 0)$ is not an element of $C(2500, 1000)$ because $\sin(t)$ is not a rational number for the corresponding values of $t$.

$S(3, 1) = (|3| + |0|) + (|-1| + |2|) + (|-1| + |0|) + (|-1| + |-2|) = 10$

$T(3) = 10; T(10) = 524; T(100) = 580442; T(10^3) = 583108600$.

Find $T(10^6)$.

Give your answer modulo $99991$.",REDACTED
pe-451,"Consider the number $15$.

There are eight positive numbers less than $15$ which are coprime to $15$: $1, 2, 4, 7, 8, 11, 13, 14$.

The modular inverses of these numbers modulo $15$ are: $1, 8, 4, 13, 2, 11, 7, 14$
  
because

$1 \cdot 1 \bmod 15=1$

$2 \cdot 8=16 \bmod 15=1$

$4 \cdot 4=16 \bmod 15=1$

$7 \cdot 13=91 \bmod 15=1$

$11 \cdot 11=121 \bmod 15=1$

$14 \cdot 14=196 \bmod 15=1
$

Let $I(n)$ be the largest positive number $m$ smaller than $n-1$ such that the modular inverse of $m$ modulo $n$ equals $m$ itself.

So $I(15)=11$.

Also $I(100)=51$ and $I(7)=1$.

Find $\sum I(n)$ for $3 \le n \le 2 \times 10^7$.",REDACTED
pe-452,"Define $F(m,n)$ as the number of $n$-tuples of positive integers for which the product of the elements doesn't exceed $m$.

$F(10, 10) = 571$.

$F(10^6, 10^6) \bmod 1\,234\,567\,891 = 252903833$.

Find $F(10^9, 10^9) \bmod 1\,234\,567\,891$.",REDACTED
pe-454,"In the following equation $x$, $y$, and $n$ are positive integers.

$$\dfrac{1}{x} + \dfrac{1}{y} = \dfrac{1}{n}$$
For a limit $L$ we define $F(L)$ as the number of solutions which satisfy $x \lt y \le L$.

We can verify that $F(15) = 4$ and $F(1000) = 1069$.

Find $F(10^{12})$.

Give your answer modulo $99991$.",REDACTED
pe-455,"Let $f(n)$ be the largest positive integer $x$ less than $10^9$ such that the last $9$ digits of $n^x$ form the number $x$ (including leading zeros), or zero if no such integer exists.

For example:

- $f(4) = 411728896$ ($4^{411728896} = \cdots 490\underline{411728896}$) 

- $f(10) = 0$

- $f(157) = 743757$ ($157^{743757} = \cdots 567\underline{000743757}$)

- $\sum_{2 \le n \le 10^3} f(n) = 442530011399$

Find $\sum_{2 \le n \le 10^6}f(n)$.",REDACTED
pe-456,"Define:
$x_n = (1248^n \bmod 32323) - 16161$
$y_n = (8421^n \bmod 30103) - 15051$

$P_n = \{(x_1, y_1), (x_2, y_2), \dots, (x_n, y_n)\}$

For example, $P_8 = \{(-14913, -6630),$$(-10161, 5625),$$(5226, 11896),$$(8340, -10778),$$(15852, -5203),$$(-15165, 11295),$$(-1427, -14495),$$(12407, 1060)\}$.

Let $C(n)$ be the number of triangles whose vertices are in $P_n$ which contain the origin in the interior.

Examples:

$C(8) = 20$

$C(600) = 8950634$

$C(40\,000) = 2666610948988$

Find $C(2\,000\,000)$.",REDACTED
pe-457,"Let $f(n) = n^2 - 3n - 1$.

Let $p$ be a prime.

Let $R(p)$ be the smallest positive integer $n$ such that $f(n) \bmod p^2 = 0$ if such an integer $n$ exists, otherwise $R(p) = 0$.

Let $SR(L)$ be $\sum R(p)$ for all primes not exceeding $L$.

Find $SR(10^7)$.",REDACTED
pe-458,"Consider the alphabet $A$ made out of the letters of the word ""$\text{project}$"": $A=\{\text c,\text e,\text j,\text o,\text p,\text r,\text t\}$.

Let $T(n)$ be the number of strings of length $n$ consisting of letters from $A$ that do not have a substring that is one of the $5040$ permutations of ""$\text{project}$"".

$T(7)=7^7-7!=818503$.

Find $T(10^{12})$. Give the last $9$ digits of your answer.",REDACTED
pe-461,"Let $f_n(k) = e^{k/n} - 1$, for all non-negative integers $k$.

Remarkably, $f_{200}(6)+f_{200}(75)+f_{200}(89)+f_{200}(226)=\underline{3.1415926}44529\cdots\approx\pi$.

In fact, it is the best approximation of $\pi$ of the form $f_n(a) + f_n(b) + f_n(c) + f_n(d)$ for $n=200$.

Let $g(n)=a^2 + b^2 + c^2 + d^2$ for $a, b, c, d$ that minimize the error: $|f_n(a) + f_n(b) + f_n(c) + f_n(d) - \pi|$

(where $|x|$ denotes the absolute value of $x$).

You are given $g(200)=6^2+75^2+89^2+226^2=64658$.

Find $g(10000)$.

Give your answer modulo $99991$.",REDACTED
pe-463,"The function $f$ is defined for all positive integers as follows:

- $f(1)=1$

- $f(3)=3$

- $f(2n)=f(n)$

- $f(4n + 1)=2f(2n + 1) - f(n)$

- $f(4n + 3)=3f(2n + 1) - 2f(n)$

The function $S(n)$ is defined as $\sum_{i=1}^{n}f(i)$.

$S(8)=22$ and $S(100)=3604$.

Find $S(3^{37})$. Give the last $9$ digits of your answer.",REDACTED
pe-464,"The Möbius function, denoted $\mu(n)$, is defined as:

- $\mu(n) = (-1)^{\omega(n)}$ if $n$ is squarefree (where $\omega(n)$ is the number of distinct prime factors of $n$)

- $\mu(n) = 0$ if $n$ is not squarefree.

Let $P(a, b)$ be the number of integers $n$ in the interval $[a, b]$ such that $\mu(n) = 1$.

Let $N(a, b)$ be the number of integers $n$ in the interval $[a, b]$ such that $\mu(n) = -1$.

For example, $P(2,10) = 2$ and $N(2,10) = 4$.

Let $C(n)$ be the number of integer pairs $(a, b)$ such that:

-  $1\le a \le b \le n$,

-  $99 \cdot N(a, b) \le 100 \cdot P(a, b)$, and

-  $99 \cdot P(a, b) \le 100 \cdot N(a, b)$.

For example, $C(10) = 13$, $C(500) = 16676$ and $C(10\,000) = 20155319$.

Find $C(20\,000\,000)$.

Give your answer modulo $99991$.",REDACTED
pe-466,"Let $P(m,n)$ be the number of distinct terms in an $m\times n$ multiplication table.

For example, a $3\times 4$ multiplication table looks like this:

<table class=""p466""><tr><th>$\times$</th> <th>1</th><th>2</th><th>3</th><th>4</th></tr><tr><th>1</th> <td>1</td><td>2</td><td>3</td><td>4</td></tr><tr><th>2</th> <td>2</td><td>4</td><td>6</td><td>8</td></tr><tr><th>3</th> <td>3</td><td>6</td><td>9</td><td>12</td></tr></table>

There are $8$ distinct terms $\{1,2,3,4,6,8,9,12\}$, therefore $P(3,4) = 8$.

You are given that:

$P(64,64) = 1263$,

$P(12,345) = 1998$, and

$P(32,10^{15}) = 13826382602124302$.

Find $P(64,10^{16})$.

Give your answer modulo $99991$.",REDACTED
pe-467,"An integer $s$ is called a superinteger of another integer $n$ if the digits of $n$ form a subsequenceA subsequence is a sequence that can be derived from another sequence by deleting some elements without changing the order of the remaining elements. of the digits of $s$.

For example, $2718281828$ is a superinteger of $18828$, while $314159$ is not a superinteger of $151$.

Let $p(n)$ be the $n$th prime number, and let $c(n)$ be the $n$th composite number. For example, $p(1) = 2$, $p(10) = 29$, $c(1)$ = 4 and $c(10) = 18$.

$\{p(i) : i \ge 1\} = \{2, 3, 5, 7, 11, 13, 17, 19, 23, 29, \dots\}$

$\{c(i) : i \ge 1\} = \{4, 6, 8, 9, 10, 12, 14, 15, 16, 18, \dots\}$

Let $P^D$ be the sequence of the digital roots of $\{p(i)\}$ ($C^D$ is defined similarly for $\{c(i)\}$):

$P^D = \{2, 3, 5, 7, 2, 4, 8, 1, 5, 2, \dots\}$

$C^D = \{4, 6, 8, 9, 1, 3, 5, 6, 7, 9, \dots\}$

Let $P_n$ be the integer formed by concatenating the first $n$ elements of $P^D$ ($C_n$ is defined similarly for $C^D$).

$P_{10} = 2357248152$

$C_{10} = 4689135679$

Let $f(n)$ be the smallest positive integer that is a common superinteger of $P_n$ and $C_n$. 
For example, $f(10) = 2357246891352679$, and $f(100) \bmod 1\,000\,000\,007 = 771661825$.

Find $f(10\,000) \bmod 1\,000\,000\,007$.",REDACTED
pe-468,"An integer is called B-smooth if none of its prime factors is greater than $B$.

Let $S_B(n)$ be the largest $B$-smooth divisor of $n$.

Examples:

$S_1(10)=1$

$S_4(2100) = 12$

$S_{17}(2496144) = 5712$

Define $\displaystyle F(n)=\sum_{B=1}^n \sum_{r=0}^n S_B(\binom n r)$. Here, $\displaystyle \binom n r$ denotes the binomial coefficient.

Examples:

$F(11) = 3132$

$F(1111) \mod 1\,000\,000\,993 = 706036312$

$F(111\,111) \mod 1\,000\,000\,993 = 22156169$

Find $F(11\,111\,111)  \mod 1\,000\,000\,993$.",REDACTED
pe-470,"Consider a single game of Ramvok:

Let $t$ represent the maximum number of turns the game lasts. If $t = 0$, then the game ends immediately. Otherwise, on each turn $i$, the player rolls a die. After rolling, if $i \lt t$ the player can either stop the game and receive a prize equal to the value of the current roll, or discard the roll and try again next turn. If $i = t$, then the roll cannot be discarded and the prize must be accepted. Before the game begins, $t$ is chosen by the player, who must then pay an up-front cost $ct$ for some constant $c$. For $c = 0$, $t$ can be chosen to be infinite (with an up-front cost of $0$). Let $R(d, c)$ be the expected profit (i.e. net gain) that the player receives from a single game of optimally-played Ramvok, given a fair $d$-sided die and cost constant $c$. For example, $R(4, 0.2) = 2.65$. Assume that the player has sufficient funds for paying any/all up-front costs.

Now consider a game of Super Ramvok:

In Super Ramvok, the game of Ramvok is played repeatedly, but with a slight modification. After each game, the die is altered. The alteration process is as follows: The die is rolled once, and if the resulting face has its pips visible, then that face is altered to be blank instead. If the face is already blank, then it is changed back to its original value. After the alteration is made, another game of Ramvok can begin (and during such a game, at each turn, the die is rolled until a face with a value on it appears). The player knows which faces are blank and which are not at all times. The game of Super Ramvok ends once all faces of the die are blank.

Let $S(d, c)$ be the expected profit that the player receives from an optimally-played game of Super Ramvok, given a fair $d$-sided die to start (with all sides visible), and cost constant $c$. For example, $S(6, 1) = 208.3$.

Let $F(n) = \sum_{4 \le d \le n} \sum_{0 \le c \le n} S(d, c)$.

Calculate $F(20)$, rounded to the nearest integer.

Give your answer modulo $99991$.",REDACTED
pe-473,"Let $\varphi$ be the golden ratio: $\varphi=\frac{1+\sqrt{5}}{2}.$

Remarkably it is possible to write every positive integer as a sum of powers of $\varphi$ even if we require that every power of $\varphi$ is used at most once in this sum.

Even then this representation is not unique.

We can make it unique by requiring that no powers with consecutive exponents are used and that the representation is finite.

E.g: 
$2=\varphi+\varphi^{-2}$ and $3=\varphi^{2}+\varphi^{-2}$

To represent this sum of powers of $\varphi$ we use a string of 0's and 1's with a point to indicate where the negative exponents start.

We call this the representation in the phigital numberbase.

So $1=1_{\varphi}$, $2=10.01_{\varphi}$, $3=100.01_{\varphi}$ and $14=100100.001001_{\varphi}$. 

The strings representing $1$, $2$ and $14$ in the phigital number base are palindromic, while the string representing $3$ is not.
 (the phigital point is not the middle character).

The sum of the positive integers not exceeding $1000$ whose phigital representation is palindromic is $4345$.

Find the sum of the positive integers not exceeding $10^{10}$ whose phigital representation is palindromic.

Give your answer modulo $99991$.",REDACTED
pe-474,"For a positive integer $n$ and digits $d$, we define $F(n, d)$ as the number of the divisors of $n$ whose last digits equal $d$.

For example, $F(84, 4) = 3$. Among the divisors of $84$ ($1, 2, 3, 4, 6, 7, 12, 14, 21, 28, 42, 84$), three of them ($4, 14, 84$) have the last digit $4$.

We can also verify that $F(12!, 12) = 11$ and $F(50!, 123) = 17888$.

Find $F(10^6!, 65432)$ modulo ($10^{16} + 61$).",REDACTED
pe-475,"$12n$ musicians participate at a music festival. On the first day, they form $3n$ quartets and practice all day.

It is a disaster. At the end of the day, all musicians decide they will never again agree to play with any member of their quartet.

On the second day, they form $4n$ trios, with every musician avoiding any previous quartet partners.

Let $f(12n)$ be the number of ways to organize the trios amongst the $12n$ musicians.

You are given $f(12) = 576$ and $f(24) \bmod 1\,000\,000\,007 = 509089824$.

Find $f(600) \bmod 1\,000\,000\,007$.",REDACTED
pe-477,"The number sequence game starts with a sequence $S$ of $N$ numbers written on a line.

Two players alternate turns. The players on their respective turns must select and remove either the first or the last number remaining in the sequence.

A player's own score is (determined by) the sum of all the numbers that player has taken. Each player attempts to maximize their own sum.

If $N = 4$ and $S = \{1, 2, 10, 3\}$, then each player maximizes their own score as follows:

- Player 1: removes the first number ($1$)

- Player 2: removes the last number from the remaining sequence ($3$)

- Player 1: removes the last number from the remaining sequence ($10$)

- Player 2: removes the remaining number ($2$)

Player 1 score is $1 + 10 = 11$.

Let $F(N)$ be the score of player 1 if both players follow the optimal strategy for the sequence $S = \{s_1, s_2, \dots, s_N\}$ defined as:

- $s_1 = 0$

- $s_{i + 1} = (s_i^2 + 45)$ modulo $1\,000\,000\,007$

The sequence begins with $S=\{0, 45, 2070, 4284945, 753524550, 478107844, 894218625, \dots\}$.

You are given $F(2)=45$, $F(4)=4284990$, $F(100)=26365463243$, $F(10^4)=2495838522951$.

Find $F(10^8)$.",REDACTED
pe-478,"Let us consider mixtures of three substances: A, B and C. A mixture can be described by a ratio of the amounts of A, B, and C in it, i.e., $(a : b : c)$. For example, a mixture described by the ratio $(2 : 3 : 5)$ contains $20\%$ A, $30\%$ B and $50\%$ C.

For the purposes of this problem, we cannot separate the individual components from a mixture. However, we can combine different amounts of different mixtures to form mixtures with new ratios.

For example, say we have three mixtures with ratios $(3 : 0 : 2)$, $(3: 6 : 11)$ and $(3 : 3 : 4)$. By mixing $10$ units of the first, $20$ units of the second and $30$ units of the third, we get a new mixture with ratio $(6 : 5 : 9)$, since:

$(10 \cdot \tfrac 3 5$ + $20 \cdot \tfrac 3 {20} + 30 \cdot \tfrac 3 {10} : 10 \cdot \tfrac 0 5 + 20 \cdot \tfrac 6 {20} + 30 \cdot \tfrac 3 {10} : 10 \cdot \tfrac 2 5 + 20 \cdot \tfrac {11} {20} + 30 \cdot \tfrac 4 {10})
= (18 : 15 : 27) = (6 : 5 : 9)$

However, with the same three mixtures, it is impossible to form the ratio $(3 : 2 : 1)$, since the amount of B is always less than the amount of C.

Let $n$ be a positive integer. Suppose that for every triple of integers $(a, b, c)$ with $0 \le a, b, c \le n$ and $\gcd(a, b, c) = 1$, we have a mixture with ratio $(a : b : c)$. Let $M(n)$ be the set of all such mixtures.

For example, $M(2)$ contains the $19$ mixtures with the following ratios:

$$\begin{align}
\{&amp;(0 : 0 : 1), (0 : 1 : 0), (0 : 1 : 1), (0 : 1 : 2), (0 : 2 : 1),\\
&amp;(1 : 0 : 0), (1 : 0 : 1), (1 : 0 : 2), (1 : 1 : 0), (1 : 1 : 1),\\
&amp;(1 : 1 : 2), (1 : 2 : 0), (1 : 2 : 1), (1 : 2 : 2), (2 : 0 : 1),\\
&amp;(2 : 1 : 0), (2 : 1 : 1), (2 : 1 : 2), (2 : 2 : 1)\}.
\end{align}$$

Let $E(n)$ be the number of subsets of $M(n)$ which can produce the mixture with ratio $(1 : 1 : 1)$, i.e., the mixture with equal parts A, B and C.

We can verify that $E(1) = 103$, $E(2) = 520447$, $E(10) \bmod 11^8 = 82608406$ and $E(500) \bmod 11^8 = 13801403$.

Find $E(10\,000\,000) \bmod 11^8$.",REDACTED
pe-479,"Let $a_k$, $b_k$, and $c_k$ represent the three solutions (real or complex numbers) to the equation
$\frac 1 x = (\frac k x)^2(k+x^2)-k x$.

For instance, for $k=5$, we see that $\{a_5, b_5, c_5 \}$ is approximately $\{5.727244, -0.363622+2.057397i, -0.363622-2.057397i\}$.

Let $\displaystyle S(n) = \sum_{p=1}^n\sum_{k=1}^n(a_k+b_k)^p(b_k+c_k)^p(c_k+a_k)^p$. 

Interestingly, $S(n)$ is always an integer. For example, $S(4) = 51160$.

Find $S(10^6)$ modulo $1\,000\,000\,007$.",REDACTED
pe-482,"$ABC$ is an integer sided triangle with incenter $I$ and perimeter $p$.

The segments $IA$, $IB$ and $IC$ have integral length as well. 

Let $L = p + |IA| + |IB| + |IC|$. 

Let $S(P) = \sum L$ for all such triangles where $p \le P$. For example, $S(10^3) = 3619$.

Find $S(10^7)$.

Give your answer modulo $99991$.",REDACTED
pe-484,"The arithmetic derivative is defined by

- $p^\prime = 1$ for any prime $p$

- $(ab)^\prime = a^\prime b + ab^\prime$ for all integers $a, b$ (Leibniz rule)

For example, $20^\prime = 24$.

Find $\sum \operatorname{\mathbf{gcd}}(k,k^\prime)$ for $1 \lt k \le 5 \times 10^{15}$.

Note: $\operatorname{\mathbf{gcd}}(x,y)$ denotes the greatest common divisor of $x$ and $y$.

Give your answer modulo $99991$.",REDACTED
pe-485,"Let $d(n)$ be the number of divisors of $n$.

Let $M(n,k)$ be the maximum value of $d(j)$ for $n \le j \le n+k-1$.

Let $S(u,k)$ be the sum of $M(n,k)$ for $1 \le n \le u-k+1$.

You are given that $S(1000,10)=17176$.

Find $S(100\,000\,000, 100\,000)$.

Give your answer modulo $99991$.",REDACTED
pe-486,"Let $F_5(n)$ be the number of strings $s$ such that:

- $s$ consists only of '0's and '1's,

- $s$ has length at most $n$, and

- $s$ contains a palindromic substring of length at least $5$.

For example, $F_5(4) = 0$, $F_5(5) = 8$, 
$F_5(6) = 42$ and $F_5(11) = 3844$.

Let $D(L)$ be the number of integers $n$ such that $5 \le n \le L$ and $F_5(n)$ is divisible by $87654321$.

For example, $D(10^7) = 0$ and $D(5 \cdot 10^9) = 51$.

Find $D(10^{18})$.

Give your answer modulo $99991$.",REDACTED
pe-487,"Let $f_k(n)$ be the sum of the $k$th powers of the first $n$ positive integers.

For example, $f_2(10) = 1^2 + 2^2 + 3^2 + 4^2 + 5^2 + 6^2 + 7^2 + 8^2 + 9^2 + 10^2 = 385$.

Let $S_k(n)$ be the sum of $f_k(i)$ for $1 \le i \le n$. For example, $S_4(100) = 35375333830$.

What is $\sum (S_{10000}(10^{12}) \bmod p)$ over all primes $p$ between $2 \cdot 10^9$ and $2 \cdot 10^9 + 2000$?",REDACTED
pe-488,"Alice and Bob have enjoyed playing Nim every day. However, they finally got bored of playing ordinary three-heap Nim.

So, they added an extra rule:

- Must not make two heaps of the same size.

The triple $(a, b, c)$ indicates the size of three heaps.

Under this extra rule, $(2,4,5)$ is one of the losing positions for the next player.

To illustrate:

- Alice moves to $(2,4,3)$

- Bob   moves to $(0,4,3)$

- Alice moves to $(0,2,3)$

- Bob   moves to $(0,2,1)$

Unlike ordinary three-heap Nim, $(0,1,2)$ and its permutations are the end states of this game.

For an integer $N$, we define $F(N)$ as the sum of $a + b + c$ for all the losing positions for the next player, with $0 \lt a \lt b \lt c \lt N$.

For example, $F(8) = 42$, because there are $4$ losing positions for the next player, $(1,3,5)$, $(1,4,6)$, $(2,3,6)$ and $(2,4,5)$.

We can also verify that $F(128) = 496062$.

Find the last $9$ digits of $F(10^{18})$.",REDACTED
pe-489,"Let $G(a, b)$ be the smallest non-negative integer $n$ for which $\operatorname{\mathbf{gcd}}$Greatest common divisor$(n^3 + b, (n + a)^3 + b)$ is maximized.

For example, $G(1, 1) = 5$ because $\gcd(n^3 + 1, (n + 1)^3 + 1)$ reaches its maximum value of $7$ for $n = 5$, and is smaller for $0 \le n \lt 5$.

Let $H(m, n) = \sum G(a, b)$ for $1 \le a \le m$, $1 \le b \le n$.

You are given $H(5, 5) = 128878$ and $H(10, 10) = 32936544$.

Find $H(18, 1900)$.

Give your answer modulo $99991$.",REDACTED
pe-490,"There are $n$ stones in a pond, numbered $1$ to $n$. Consecutive stones are spaced one unit apart.

A frog sits on stone $1$. He wishes to visit each stone exactly once, stopping on stone $n$. However, he can only jump from one stone to another if they are at most $3$ units apart. In other words, from stone $i$, he can reach a stone $j$ if $1 \le j \le n$ and $j$ is in the set $\{i-3, i-2, i-1, i+1, i+2, i+3\}$.

Let $f(n)$ be the number of ways he can do this. For example, $f(6) = 14$, as shown below:

$1 \to 2 \to 3 \to 4 \to 5 \to 6$ 

$1 \to 2 \to 3 \to 5 \to 4 \to 6$ 

$1 \to 2 \to 4 \to 3 \to 5 \to 6$ 

$1 \to 2 \to 4 \to 5 \to 3 \to 6$ 

$1 \to 2 \to 5 \to 3 \to 4 \to 6$ 

$1 \to 2 \to 5 \to 4 \to 3 \to 6$ 

$1 \to 3 \to 2 \to 4 \to 5 \to 6$ 

$1 \to 3 \to 2 \to 5 \to 4 \to 6$ 

$1 \to 3 \to 4 \to 2 \to 5 \to 6$ 

$1 \to 3 \to 5 \to 2 \to 4 \to 6$ 

$1 \to 4 \to 2 \to 3 \to 5 \to 6$ 

$1 \to 4 \to 2 \to 5 \to 3 \to 6$ 

$1 \to 4 \to 3 \to 2 \to 5 \to 6$ 

$1 \to 4 \to 5 \to 2 \to 3 \to 6$

Other examples are $f(10) = 254$ and $f(40) = 1439682432976$.

Let $S(L) = \sum f(n)^3$ for $1 \le n \le L$.

Examples:

$S(10) = 18230635$

$S(20) = 104207881192114219$

$S(1\,000) \bmod 10^9 = 225031475$

$S(1\,000\,000) \bmod 10^9 = 363486179$

Find $S(10^{14}) \bmod 10^9$.",REDACTED
pe-491,"We call a positive integer double pandigital if it uses all the digits $0$ to $9$ exactly twice (with no leading zero). For example, $40561817703823564929$ is one such number.

How many double pandigital numbers are divisible by $11$?

Give your answer modulo $99991$.",REDACTED
pe-492,"Define the sequence $a_1, a_2, a_3, \dots$ as:

- $a_1 = 1$

- $a_{n+1} = 6a_n^2 + 10a_n + 3$ for $n \ge 1$.

Examples:

$a_3 = 2359$

$a_6 = 269221280981320216750489044576319$

$a_6 \bmod 1\,000\,000\,007 = 203064689$

$a_{100} \bmod 1\,000\,000\,007 = 456482974$

Define $B(x,y,n)$ as $\sum (a_n \bmod p)$ for every prime $p$ such that $x \le p \le x+y$.

Examples:

$B(10^9, 10^3, 10^3) = 23674718882$

$B(10^9, 10^3, 10^{15}) = 20731563854$

Find $B(10^9, 10^7, 10^{15})$.",REDACTED
pe-494,"The Collatz sequence is defined as:
$a_{i+1} = \left\{  \large{\frac {a_i} 2 \atop 3 a_i+1} {\text{if }a_i\text{ is even} \atop \text{if }a_i\text{ is odd}} \right.$.

The Collatz conjecture states that starting from any positive integer, the sequence eventually reaches the cycle $1,4,2,1, \dots$.

We shall define the sequence prefix $p(n)$ for the Collatz sequence starting with $a_1 = n$ as the sub-sequence of all numbers not a power of $2$ ($2^0=1$ is considered a power of $2$ for this problem). For example:
$p(13) = \{13, 40, 20, 10, 5\}$ 
$p(8) = \{\}$

Any number invalidating the conjecture would have an infinite length sequence prefix.

Let $S_m$ be the set of all sequence prefixes of length $m$. Two sequences $\{a_1, a_2, \dots, a_m\}$ and $\{b_1, b_2, \dots, b_m\}$ in $S_m$ are said to belong to the same prefix family if $a_i \lt a_j$ if and only if $b_i \lt b_j$ for all $1 \le i,j \le m$.

For example, in $S_4$, $\{6, 3, 10, 5\}$ is in the same family as $\{454, 227, 682, 341\}$, but not $\{113, 340, 170, 85\}$.

Let $f(m)$ be the number of distinct prefix families in $S_m$.

You are given $f(5) = 5$, $f(10) = 55$, $f(20) = 6771$.

Find $f(90)$.

Give your answer modulo $99991$.",REDACTED
pe-495,"Let $W(n,k)$ be the number of ways in which $n$ can be written as the product of $k$ distinct positive integers.

For example, $W(144,4) = 7$. There are $7$ ways in which $144$ can be written as a product of $4$ distinct positive integers:

- $144 = 1 \times 2 \times 4 \times 18$

- $144 = 1 \times 2 \times 8 \times 9$

- $144 = 1 \times 2 \times 3 \times 24$

- $144 = 1 \times 2 \times 6 \times 12$

- $144 = 1 \times 3 \times 4 \times 12$

- $144 = 1 \times 3 \times 6 \times 8$

- $144 = 2 \times 3 \times 4 \times 6$

Note that permutations of the integers themselves are not considered distinct.

Furthermore, $W(100!,10)$ modulo $1\,000\,000\,007 = 287549200$.

Find $W(10000!,30)$ modulo $1\,000\,000\,007$.",REDACTED
pe-496,"Given an integer sided triangle $ABC$:

Let $I$ be the incenter of $ABC$.

Let $D$ be the intersection between the line $AI$ and the circumcircle of $ABC$ ($A \ne D$).

We define $F(L)$ as the sum of $BC$ for the triangles $ABC$ that satisfy $AC = DI$ and $BC \le L$.

For example, $F(15) = 45$ because the triangles $ABC$ with $(BC,AC,AB) = (6,4,5), (12,8,10), (12,9,7), (15,9,16)$ satisfy the conditions.

Find $F(10^9)$.

Give your answer modulo $99991$.",REDACTED
pe-498,"For positive integers $n$ and $m$, we define two polynomials $F_n(x) = x^n$ and $G_m(x) = (x-1)^m$.

We also define a polynomial $R_{n,m}(x)$ as the remainder of the division of $F_n(x)$ by $G_m(x)$.

For example, $R_{6,3}(x) = 15x^2 - 24x + 10$.

Let $C(n, m, d)$ be the absolute value of the coefficient of the $d$-th degree term of $R_{n,m}(x)$.

We can verify that $C(6, 3, 1) = 24$ and $C(100, 10, 4) = 227197811615775$.

Find $C(10^{13}, 10^{12}, 10^4) \bmod 999999937$.",REDACTED
pe-500,"The number of divisors of $120$ is $16$.

In fact $120$ is the smallest number having $16$ divisors.

Find the smallest number with $2^{500500}$ divisors.

Give your answer modulo $500500507$.",REDACTED
pe-501,"The eight divisors of $24$ are $1, 2, 3, 4, 6, 8, 12$ and $24$.
The ten numbers not exceeding $100$ having exactly eight divisors are $24, 30, 40, 42, 54, 56, 66, 70, 78$ and $88$.
Let $f(n)$ be the count of numbers not exceeding $n$ with exactly eight divisors.

You are given $f(100) = 10$, $f(1000) = 180$ and $f(10^6) = 224427$.

Find $f(10^{12})$.

Give your answer modulo $99991$.",REDACTED
pe-504,"Let $ABCD$ be a quadrilateral whose vertices are lattice points lying on the coordinate axes as follows:

$A(a, 0)$, $B(0, b)$, $C(-c, 0)$, $D(0, -d)$, where $1 \le a, b, c, d \le m$ and $a, b, c, d, m$ are integers.

It can be shown that for $m = 4$ there are exactly $256$ valid ways to construct $ABCD$. Of these $256$ quadrilaterals, $42$ of them strictly contain a square number of lattice points.

How many quadrilaterals $ABCD$ strictly contain a square number of lattice points for $m = 100$?

Give your answer modulo $99991$.",REDACTED
pe-505,"Let:

$\begin{array}{ll} x(0)&amp;=0 \\ x(1)&amp;=1 \\ x(2k)&amp;=(3x(k)+2x(\lfloor \frac k 2 \rfloor)) \text{ mod } 2^{60} \text{ for } k \ge 1 \text {, where } \lfloor \text { } \rfloor \text { is the floor function} \\ x(2k+1)&amp;=(2x(k)+3x(\lfloor \frac k 2 \rfloor)) \text{ mod } 2^{60} \text{ for } k \ge 1 \\ y_n(k)&amp;=\left\{{\begin{array}{lc} x(k) &amp;&amp; \text{if } k \ge n \\ 2^{60} - 1 - max(y_n(2k),y_n(2k+1)) &amp;&amp; \text{if } k &lt; n \end{array}} \right. \\ A(n)&amp;=y_n(1) \end{array}$

You are given:

$\begin{array}{ll} x(2)&amp;=3 \\ x(3)&amp;=2 \\ x(4)&amp;=11 \\ y_4(4)&amp;=11 \\ y_4(3)&amp;=2^{60}-9\\ y_4(2)&amp;=2^{60}-12 \\ y_4(1)&amp;=A(4)=8 \\ A(10)&amp;=2^{60}-34\\ A(10^3)&amp;=101881 \end{array}$

Find $A(10^{12})$.",REDACTED
pe-506,"Consider the infinite repeating sequence of digits:

1234321234321234321...

Amazingly, you can break this sequence of digits into a sequence of integers such that the sum of the digits in the $n$-th value is $n$.

The sequence goes as follows:

1, 2, 3, 4, 32, 123, 43, 2123, 432, 1234, 32123, ...

Let $v_n$ be the $n$-th value in this sequence. For example, $v_2=2$, $v_5=32$ and $v_{11}=32123$.

Let $S(n)$ be $v_1+v_2+\cdots+v_n$. For example, $S(11)=36120$, and $S(1000)\bmod 123454321=18232686$.

Find $S(10^{14})\bmod 123454321$.",REDACTED
pe-507,"Let $t_n$ be the tribonacci numbers defined as:

$t_0 = t_1 = 0$;

$t_2 = 1$;

$t_n = t_{n-1} + t_{n-2} + t_{n-3}$ for $n \ge 3$

and let $r_n = t_n \text{ mod } 10^7$.

For each pair of Vectors $V_n=(v_1,v_2,v_3)$ and $W_n=(w_1,w_2,w_3)$ with $v_1=r_{12n-11}-r_{12n-10}, v_2=r_{12n-9}+r_{12n-8}, v_3=r_{12n-7} \cdot r_{12n-6}$  and 
 $w_1=r_{12n-5}-r_{12n-4}, w_2=r_{12n-3}+r_{12n-2}, w_3=r_{12n-1} \cdot r_{12n}$

we define $S(n)$ as the minimal value of the manhattan length of the vector $D=k \cdot V_n+l \cdot W_n$ measured as $|k \cdot v_1+l \cdot w_1|+|k \cdot v_2+l \cdot w_2|+|k \cdot v_3+l \cdot w_3|$
 for any integers $k$ and $l$ with $(k,l)\neq (0,0)$.

The first vector pair  is $(-1, 3, 28)$, $(-11, 125, 40826)$.

You are given that $S(1)=32$ and $\sum_{n=1}^{10} S(n)=130762273722$.

Find $\sum_{n=1}^{20000000} S(n)$.",REDACTED
pe-508,"Consider the Gaussian integer $i-1$. A base $i-1$ representation of a Gaussian integer $a+bi$ is a finite sequence of digits $d_{n - 1}d_{n - 2}\cdots d_1 d_0$ such that:

- $a+bi = d_{n - 1}(i - 1)^{n - 1} + d_{n - 2}(i - 1)^{n - 2} + \cdots + d_1(i - 1) + d_0$

- Each $d_k$ is in $\{0,1\}$

- There are no leading zeroes, i.e. $d_{n-1} \ne 0$, unless $a+bi$ is itself $0$

Here are base $i-1$ representations of a few Gaussian integers:

$11+24i \to 111010110001101$

$24-11i \to 110010110011$

$8+0i \to 111000000$

$-5+0i \to 11001101$

$0+0i \to 0$

Remarkably, every Gaussian integer has a unique base $i-1$ representation!

Define $f(a + bi)$ as the number of $1$s in the unique base $i-1$ representation of $a + bi$. For example, $f(11+24i) = 9$ and $f(24-11i) = 7$.

Define $B(L)$ as the sum of $f(a + bi)$ for all integers $a, b$ such that $|a| \le L$ and $|b| \le L$. For example, $B(500) = 10795060$.

Find $B(10^{15}) \bmod 1\,000\,000\,007$.",REDACTED
pe-509,"Anton and Bertrand love to play three pile Nim.

However, after a lot of games of Nim they got bored and changed the rules somewhat.

They may only take a number of stones from a pile that is a proper divisora proper divisor of $n$ is a divisor of $n$ smaller than $n$ of the number of stones present in the pile.
 E.g. if a pile at a certain moment contains $24$ stones they may take only $1,2,3,4,6,8$ or $12$ stones from that pile.

So if a pile contains one stone they can't take the last stone from it as $1$ isn't a proper divisor of $1$.

The first player that can't make a valid move loses the game.

Of course both Anton and Bertrand play optimally.

The triple $(a, b, c)$ indicates the number of stones in the three piles.

Let $S(n)$ be the number of winning positions for the next player for $1 \le a, b, c \le n$.
$S(10) = 692$ and $S(100) = 735494$.

Find $S(123456787654321)$ modulo $1234567890$.",REDACTED
pe-511,"Let $Seq(n,k)$ be the number of positive-integer sequences $\{a_i\}_{1 \le i \le n}$ of length $n$ such that:

- $n$ is divisible by $a_i$ for $1 \le i \le n$, and
  
- $n + a_1 + a_2 + \cdots + a_n$ is divisible by $k$.

Examples:

$Seq(3,4) = 4$, and the $4$ sequences are:

$\{1, 1, 3\}$

$\{1, 3, 1\}$

$\{3, 1, 1\}$

$\{3, 3, 3\}$

$Seq(4,11) = 8$, and the $8$ sequences are:

$\{1, 1, 1, 4\}$

$\{1, 1, 4, 1\}$

$\{1, 4, 1, 1\}$

$\{4, 1, 1, 1\}$

$\{2, 2, 2, 1\}$

$\{2, 2, 1, 2\}$

$\{2, 1, 2, 2\}$

$\{1, 2, 2, 2\}$

The last nine digits of $Seq(1111,24)$ are $840643584$.

Find the last nine digits of $Seq(1234567898765,4321)$.",REDACTED
pe-512,"Let $\varphi(n)$ be Euler's totient function.

Let $f(n)=(\sum_{i=1}^{n}\varphi(n^i)) \bmod (n+1)$.

Let $g(n)=\sum_{i=1}^{n} f(i)$.

$g(100)=2007$.

Find $g(5 \times 10^8)$.",REDACTED
pe-513,"$ABC$ is an integral sided triangle with sides $a \le b \le c$.

$m_C$ is the median connecting $C$ and the midpoint of $AB$. 

$F(n)$ is the number of such triangles with  $c \le n$ for which $m_C$ has integral length as well.

$F(10)=3$ and $F(50)=165$.

Find $F(100000)$.

Give your answer modulo $99991$.",REDACTED
pe-515,"Let $d(p, n, 0)$ be the multiplicative inverse of $n$ modulo prime $p$, defined as $n \times d(p, n, 0) = 1 \bmod p$.

Let $d(p, n, k) = \sum_{i = 1}^n d(p, i, k - 1)$ for $k \ge 1$.

Let $D(a, b, k) = \sum (d(p, p-1, k) \bmod p)$ for all primes $a \le p \lt a + b$.

You are given:

- $D(101,1,10) = 45$

- $D(10^3,10^2,10^2) = 8334$

- $D(10^6,10^3,10^3) = 38162302$
Find $D(10^9,10^5,10^5)$.",REDACTED
pe-516,"$5$-smooth numbers are numbers whose largest prime factor doesn't exceed $5$.

$5$-smooth numbers are also called Hamming numbers.

Let $S(L)$ be the sum of the numbers $n$ not exceeding $L$ such that Euler's totient function $\phi(n)$ is a Hamming number.

$S(100)=3728$.

Find $S(10^{12})$. Give your answer modulo $2^{32}$.",REDACTED
pe-517,"For every real number $a \gt 1$ is given the sequence $g_a$ by:

$g_{a}(x)=1$ for $x \lt a$

$g_{a}(x)=g_{a}(x-1)+g_a(x-a)$ for $x \ge a$

$G(n)=g_{\sqrt {n}}(n)$

$G(90)=7564511$.

Find $\sum G(p)$ for $p$ prime and $10000000 \lt p \lt 10010000$

Give your answer modulo $1000000007$.",REDACTED
pe-518,"Let $S(n) = \sum a + b + c$ over all triples $(a, b, c)$ such that:

- $a$, $b$ and $c$ are prime numbers.

- $a \lt b \lt c \lt n$.

- $a+1$, $b+1$, and $c+1$ form a geometric sequence.

For example, $S(100) = 1035$ with the following triples: 

$(2, 5, 11)$, $(2, 11, 47)$, $(5, 11, 23)$, $(5, 17, 53)$, $(7, 11, 17)$, $(7, 23, 71)$, $(11, 23, 47)$, $(17, 23, 31)$, $(17, 41, 97)$, $(31, 47, 71)$, $(71, 83, 97)$

Find $S(10^8)$.

Give your answer modulo $99991$.",REDACTED
pe-520,"We define a simber to be a positive integer in which any odd digit, if present, occurs an odd number of times, and any even digit, if present, occurs an even number of times.

For example, $141221242$ is a $9$-digit simber because it has three $1$'s, four $2$'s and two $4$'s. 

Let $Q(n)$ be the count of all simbers with at most $n$ digits.

 

You are given $Q(7) = 287975$ and $Q(100) \bmod 1\,000\,000\,123 = 123864868$.

Find $(\sum_{1 \le u \le 39} Q(2^u)) \bmod 1\,000\,000\,123$.",REDACTED
pe-521,"Let $\operatorname{smpf}(n)$ be the smallest prime factor of $n$.

$\operatorname{smpf}(91)=7$ because $91=7\times 13$ and $\operatorname{smpf}(45)=3$ because $45=3\times 3\times 5$.

Let $S(n)$ be the sum of $\operatorname{smpf}(i)$ for $2 \le i \le n$.

E.g. $S(100)=1257$.

Find $S(10^{12}) \bmod 10^9$.",REDACTED
pe-524,"Consider the following algorithm for sorting a list:

- 1. Starting from the beginning of the list, check each pair of adjacent elements in turn.

- 2. If the elements are out of order:

- a. Move the smallest element of the pair at the beginning of the list.

- b. Restart the process from step 1.

- 3. If all pairs are in order, stop.

For example, the list $\{\,4\,1\,3\,2\,\}$ is sorted as follows:

- $\underline{4\,1}\,3\,2$ ($4$ and $1$ are out of order so move $1$ to the front of the list)

- $1\,\underline{4\,3}\,2$ ($4$ and $3$ are out of order so move $3$ to the front of the list)

- $\underline{3\,1}\,4\,2$ ($3$ and $1$ are out of order so move $1$ to the front of the list)

- $1\,3\,\underline{4\,2}$ ($4$ and $2$ are out of order so move $2$ to the front of the list)

- $\underline{2\,1}\,3\,4$ ($2$ and $1$ are out of order so move $1$ to the front of the list)

- $1\,2\,3\,4$ (The list is now sorted)

Let $F(L)$ be the number of times step 2a is executed to sort list $L$. For example, $F(\{\,4\,1\,3\,2\,\}) = 5$.

We can list all permutations $P$ of the integers $\{1, 2, \dots, n\}$ in lexicographical order, and assign to each permutation an index $I_n(P)$ from $1$ to $n!$ corresponding to its position in the list.

Let $Q(n, k) = \min(I_n(P))$ for $F(P) = k$, the index of the first permutation requiring exactly $k$ steps to sort with First Sort. If there is no permutation for which $F(P) = k$, then $Q(n, k)$ is undefined.

For $n = 4$ we have:

<table border=""1"" style=""text-align:left;"">
<tr><th>P</th><th>I4(P)</th><th>F(P)</th><th></th></tr>
<tr><td>{1, 2, 3, 4}</td><td>1</td><td>0</td><td>Q(4, 0) = 1</td></tr>
<tr><td>{1, 2, 4, 3}</td><td>2</td><td>4</td><td>Q(4, 4) = 2</td></tr>
<tr><td>{1, 3, 2, 4}</td><td>3</td><td>2</td><td>Q(4, 2) = 3</td></tr>
<tr><td>{1, 3, 4, 2}</td><td>4</td><td>2</td><td></td></tr>
<tr><td>{1, 4, 2, 3}</td><td>5</td><td>6</td><td>Q(4, 6) = 5</td></tr>
<tr><td>{1, 4, 3, 2}</td><td>6</td><td>4</td><td></td></tr>
<tr><td>{2, 1, 3, 4}</td><td>7</td><td>1</td><td>Q(4, 1) = 7</td></tr>
<tr><td>{2, 1, 4, 3}</td><td>8</td><td>5</td><td>Q(4, 5) = 8</td></tr>
<tr><td>{2, 3, 1, 4}</td><td>9</td><td>1</td><td></td></tr>
<tr><td>{2, 3, 4, 1}</td><td>10</td><td>1</td><td></td></tr>
<tr><td>{2, 4, 1, 3}</td><td>11</td><td>5</td><td></td></tr>
<tr><td>{2, 4, 3, 1}</td><td>12</td><td>3</td><td>Q(4, 3) = 12</td></tr>
<tr><td>{3, 1, 2, 4}</td><td>13</td><td>3</td><td></td></tr>
<tr><td>{3, 1, 4, 2}</td><td>14</td><td>3</td><td></td></tr>
<tr><td>{3, 2, 1, 4}</td><td>15</td><td>2</td><td></td></tr>
<tr><td>{3, 2, 4, 1}</td><td>16</td><td>2</td><td></td></tr>
<tr><td>{3, 4, 1, 2}</td><td>17</td><td>3</td><td></td></tr>
<tr><td>{3, 4, 2, 1}</td><td>18</td><td>2</td><td></td></tr>
<tr><td>{4, 1, 2, 3}</td><td>19</td><td>7</td><td>Q(4, 7) = 19</td></tr>
<tr><td>{4, 1, 3, 2}</td><td>20</td><td>5</td><td></td></tr>
<tr><td>{4, 2, 1, 3}</td><td>21</td><td>6</td><td></td></tr>
<tr><td>{4, 2, 3, 1}</td><td>22</td><td>4</td><td></td></tr>
<tr><td>{4, 3, 1, 2}</td><td>23</td><td>4</td><td></td></tr>
<tr><td>{4, 3, 2, 1}</td><td>24</td><td>3</td><td></td></tr>
</table>

Let $R(k) = \min(Q(n, k))$ over all $n$ for which $Q(n, k)$ is defined.

Find $R(12^{12})$.

Give your answer modulo $99991$.",REDACTED
pe-526,"Let $f(n)$ be the largest prime factor of $n$.

Let $g(n) = f(n) + f(n + 1) + f(n + 2) + f(n + 3) + f(n + 4) + f(n + 5) + f(n + 6) + f(n + 7) + f(n + 8)$, the sum of the largest prime factor of each of nine consecutive numbers starting with $n$.

Let $h(n)$ be the maximum value of $g(k)$ for $2 \le k \le n$.

You are given:

- $f(100) = 5$

- $f(101) = 101$

- $g(100) = 409$

- $h(100) = 417$

- $h(10^9) = 4896292593$

Find $h(10^{16})$.

Give your answer modulo $99991$.",REDACTED
pe-528,"Let $S(n, k, b)$ represent the number of valid solutions to $x_1 + x_2 + \cdots + x_k \le n$, where $0 \le x_m \le b^m$ for all $1 \le m \le k$.

For example, $S(14,3,2) = 135$, $S(200,5,3) = 12949440$, and $S(1000,10,5) \bmod 1\,000\,000\,007 = 624839075$.

Find $(\sum_{10 \le k \le 15} S(10^k, k, k)) \bmod 1\,000\,000\,007$.",REDACTED
pe-529,"A $10$-substring of a number is a substring of its digits that sum to $10$. For example, the $10$-substrings of the number $3523014$ are:

- 3523014

- 3523014

- 3523014

- 3523014

A number is called $10$-substring-friendly if every one of its digits belongs to a $10$-substring. For example, $3523014$ is $10$-substring-friendly, but $28546$ is not.

Let $T(n)$ be the number of $10$-substring-friendly numbers from $1$ to $10^n$ (inclusive).

For example $T(2) = 9$ and $T(5) = 3492$.

Find $T(10^{18}) \bmod 1\,000\,000\,007$.",REDACTED
pe-530,"Every divisor $d$ of a number $n$ has a complementary divisor $n/d$.

Let $f(n)$ be the sum of the greatest common divisor of $d$ and $n/d$ over all positive divisors $d$ of $n$, that is
$f(n)=\displaystyle\sum_{d\mid n}\gcd(d,\frac n d)$.

Let $F$ be the summatory function of $f$, that is
$F(k)=\displaystyle\sum_{n=1}^k f(n)$.

You are given that $F(10)=32$ and $F(1000)=12776$.

Find $F(10^{15})$.

Give your answer modulo $99991$.",REDACTED
pe-531,"Let $g(a, n, b, m)$ be the smallest non-negative solution $x$ to the system:

$x = a \bmod n$

$x = b \bmod m$

if such a solution exists, otherwise $0$.

E.g. $g(2,4,4,6)=10$, but $g(3,4,4,6)=0$.

Let $\phi(n)$ be Euler's totient function.

Let $f(n,m)=g(\phi(n),n,\phi(m),m)$

Find $\sum f(n,m)$ for $1000000 \le n \lt m \lt 1005000$.",REDACTED
pe-533,"The Carmichael function $\lambda(n)$ is defined as the smallest positive integer $m$ such that $a^m = 1$ modulo $n$ for all integers $a$ coprime with $n$.

For example $\lambda(8) = 2$ and $\lambda(240) = 4$.

Define $L(n)$ as the smallest positive integer $m$ such that $\lambda(k) \ge n$ for all $k \ge m$.

For example, $L(6) = 241$ and $L(100) = 20\,174\,525\,281$.

Find $L(20\,000\,000)$. Give the last $9$ digits of your answer.",REDACTED
pe-534,"The classical eight queens puzzle is the well known problem of placing eight chess queens on an $8 \times 8$ chessboard so that no two queens threaten each other. Allowing configurations to reappear in rotated or mirrored form, a total of $92$ distinct configurations can be found for eight queens. The general case asks for the number of distinct ways of placing $n$ queens on an $n \times n$ board, e.g. you can find $2$ distinct configurations for $n=4$.

Let's define a weak queen on an $n \times n$ board to be a piece which can move any number of squares if moved horizontally, but a maximum of $n - 1 - w$ squares if moved vertically or diagonally, $0 \le w \lt n$ being the ""weakness factor"". For example, a weak queen on an $n \times n$ board with a weakness factor of $w=1$ located in the bottom row will not be able to threaten any square in the top row as the weak queen would need to move $n - 1$ squares vertically or diagonally to get there, but may only move $n - 2$ squares in these directions. In contrast, the weak queen is not handicapped horizontally, thus threatening every square in its own row, independently from its current position in that row.

Let $Q(n,w)$ be the number of ways $n$ weak queens with weakness factor $w$ can be placed on an $n \times n$ board so that no two queens threaten each other. It can be shown, for example, that $Q(4,0)=2$, $Q(4,2)=16$ and $Q(4,3)=256$.

Let $S(n)=\displaystyle\sum_{w=0}^{n-1} Q(n,w)$.

You are given that $S(4)=276$ and $S(5)=3347$.

Find $S(14)$.

Give your answer modulo $99991$.",REDACTED
pe-535,"Consider the infinite integer sequence S starting with:

$S = 1, 1, 2, 1, 3, 2, 4, 1, 5, 3, 6, 2, 7, 8, 4, 9, 1, 10, 11, 5, \dots$

Circle the first occurrence of each integer.

$S = \enclose{circle}1, 1, \enclose{circle}2, 1, \enclose{circle}3, 2, \enclose{circle}4, 1, \enclose{circle}5, 3, \enclose{circle}6, 2, \enclose{circle}7, \enclose{circle}8, 4, \enclose{circle}9, 1, \enclose{circle}{10}, \enclose{circle}{11}, 5, \dots$

The sequence is characterized by the following properties:

- The circled numbers are consecutive integers starting with $1$.

- Immediately preceding each non-circled numbers $a_i$, there are exactly $\lfloor \sqrt{a_i} \rfloor$ adjacent circled numbers, where $\lfloor\,\rfloor$ is the floor function.

- If we remove all circled numbers, the remaining numbers form a sequence identical to $S$, so $S$ is a fractal sequence.

Let $T(n)$ be the sum of the first $n$ elements of the sequence.

You are given $T(1) = 1$, $T(20) = 86$, $T(10^3) = 364089$ and $T(10^9) = 498676527978348241$.

Find $T(10^{18})$. Give the last $9$ digits of your answer.",REDACTED
pe-536,"Let $S(n)$ be the sum of all positive integers $m$ not exceeding $n$ having the following property:

$a^{m + 4} \equiv a \pmod m$ for all integers $a$.

The values of $m \le 100$ that satisfy this property are $1, 2, 3, 5$ and $21$, thus $S(100) = 1+2+3+5+21 = 32$.

You are given $S(10^6) = 22868117$.

Find $S(10^{12})$.",REDACTED
pe-537,"Let $\pi(x)$ be the prime counting function, i.e. the number of prime numbers less than or equal to $x$.

For example,$\pi(1)=0$, $\pi(2)=1$, $\pi(100)=25$.

Let $T(n, k)$ be the number of $k$-tuples $(x_1, \dots, x_k)$ which satisfy:

1. every $x_i$ is a positive integer;

2. $\displaystyle \sum_{i=1}^k \pi(x_i)=n$

For example $T(3,3)=19$.

The $19$ tuples are $(1,1,5)$, $(1,5,1)$, $(5,1,1)$, $(1,1,6)$, $(1,6,1)$, $(6,1,1)$, $(1,2,3)$, $(1,3,2)$, $(2,1,3)$, $(2,3,1)$, $(3,1,2)$, $(3,2,1)$, $(1,2,4)$, $(1,4,2)$, $(2,1,4)$, $(2,4,1)$, $(4,1,2)$, $(4,2,1)$, $(2,2,2)$.

You are given $T(10, 10) = 869\,985$ and $T(10^3,10^3) \equiv 578\,270\,566 \pmod{1\,004\,535\,809}$.

Find $T(20\,000, 20\,000) \pmod{1\,004\,535\,809}$.",REDACTED
pe-538,"Consider a positive integer sequence $S = (s_1, s_2, \dots, s_n)$.

Let $f(S)$ be the perimeter of the maximum-area quadrilateral whose side lengths are $4$ elements $(s_i, s_j, s_k, s_l)$ of $S$ (all $i, j, k, l$ distinct). If there are many quadrilaterals with the same maximum area, then choose the one with the largest perimeter.

For example, if $S = (8, 9, 14, 9, 27)$, then we can take the elements $(9, 14, 9, 27)$ and form an isosceles trapeziumAn isosceles trapezium (US: trapezoid) is a quadrilateral where one pair of opposite sides are parallel and of different lengths, and the other pair has the same length. with parallel side lengths $14$ and $27$ and both leg lengths $9$. The area of this quadrilateral is $127.611470879\cdots$ It can be shown that this is the largest area for any quadrilateral that can be formed using side lengths from $S$. Therefore, $f(S) = 9 + 14 + 9 + 27 = 59$.

Let $u_n = 2^{B(3n)} + 3^{B(2n)} + B(n + 1)$, where $B(k)$ is the number of $1$ bits of $k$ in base $2$.

For example, $B(6) = 2$, $B(10) = 2$ and $B(15) = 4$, and $u_5 = 2^4 + 3^2 + 2 = 27$.

Also, let $U_n$ be the sequence $(u_1, u_2, \dots, u_n)$.

For example, $U_{10} = (8, 9, 14, 9, 27, 16, 36, 9, 27, 28)$.

It can be shown that $f(U_5) = 59$, $f(U_{10}) = 118$, $f(U_{150}) = 3223$.

It can also be shown that $\sum f(U_n) = 234761$ for $4 \le n \le 150$.

Find $\sum f(U_n)$ for $4 \le n \le 3\,000\,000$.

Give your answer modulo $99991$.",REDACTED
pe-539,"Start from an ordered list of all integers from $1$ to $n$. Going from left to right, remove the first number and every other number afterward until the end of the list. Repeat the procedure from right to left, removing the right most number and every other number from the numbers left. Continue removing every other numbers, alternating left to right and right to left, until a single number remains.

Starting with $n = 9$, we have:

$\underline 1\,2\,\underline 3\,4\,\underline 5\,6\,\underline 7\,8\,\underline 9$

$2\,\underline 4\,6\,\underline 8$

$\underline 2\,6$

$6$

Let $P(n)$ be the last number left starting with a list of length $n$.

Let $\displaystyle S(n) = \sum_{k=1}^n P(k)$.

You are given $P(1)=1$, $P(9) = 6$, $P(1000)=510$, $S(1000)=268271$.

Find $S(10^{18}) \bmod 987654321$.",REDACTED
pe-540,"A Pythagorean triple consists of three positive integers $a, b$ and $c$ satisfying $a^2+b^2=c^2$.

The triple is called primitive if $a, b$ and $c$ are relatively prime.

Let $P(n)$ be the number of primitive Pythagorean triples with $a \lt b \lt c \le n$.

For example $P(20) = 3$, since there are three triples: $(3,4,5)$, $(5,12,13)$ and $(8,15,17)$.

You are given that $P(10^6) = 159139$.

Find $P(3141592653589793)$.

Give your answer modulo $99991$.",REDACTED
pe-541,"The $n$th harmonic number $H_n$ is defined as the sum of the multiplicative inverses of the first $n$ positive integers, and can be written as a reduced fraction $a_n/b_n$.

$H_n = \displaystyle \sum_{k=1}^n \frac 1 k = \frac {a_n} {b_n}$, with $\gcd(a_n, b_n)=1$.

Let $M(p)$ be the largest value of $n$ such that $b_n$ is not divisible by $p$.

For example, $M(3) = 68$ because $H_{68} = \frac {a_{68}} {b_{68}} = \frac {14094018321907827923954201611} {2933773379069966367528193600}$, $b_{68}=2933773379069966367528193600$ is not divisible by $3$, but all larger harmonic numbers have denominators divisible by $3$.

You are given $M(7) = 719102$.

Find $M(137)$.

Give your answer modulo $99991$.",REDACTED
pe-542,"Let $S(k)$ be the sum of three or more distinct positive integers having the following properties:

- No value exceeds $k$.

- The values form a geometric progression.

- The sum is maximal.

$S(4) = 4 + 2 + 1 = 7$

$S(10) = 9 + 6 + 4 = 19$

$S(12) = 12 + 6 + 3 = 21$

$S(1000) = 1000 + 900 + 810 + 729 = 3439$

Let $T(n) = \sum_{k=4}^n (-1)^k S(k)$.

$T(1000) = 2268$

Find $T(10^{17})$.

Give your answer modulo $99991$.",REDACTED
pe-543,"Define function $P(n, k) = 1$ if $n$ can be written as the sum of $k$ prime numbers (with repetitions allowed), and $P(n, k) = 0$ otherwise.

For example, $P(10,2) = 1$ because $10$ can be written as either $3 + 7$ or $5 + 5$, but $P(11,2) = 0$ because no two primes can sum to $11$.

Let $S(n)$ be the sum of all $P(i,k)$ over $1 \le i,k \le n$.

For example, $S(10) = 20$, $S(100) = 2402$, and $S(1000) = 248838$.

Let $F(k)$ be the $k$th Fibonacci number (with $F(0) = 0$ and $F(1) = 1$).

Find the sum of all $S(F(k))$ over $3 \le k \le 44$.

Give your answer modulo $99991$.",REDACTED
pe-544,"Let $F(r, c, n)$ be the number of ways to colour a rectangular grid with $r$ rows and $c$ columns using at most $n$ colours such that no two adjacent cells share the same colour. Cells that are diagonal to each other are not considered adjacent.

For example, $F(2,2,3) = 18$, $F(2,2,20) = 130340$, and $F(3,4,6) = 102923670$.

Let $S(r, c, n) = \sum_{k=1}^{n} F(r, c, k)$.

For example, $S(4,4,15) \bmod 10^9+7 = 325951319$.

Find $S(9,10,1112131415) \bmod 10^9+7$.",REDACTED
pe-545,"The sum of the $k$th powers of the first $n$ positive integers can be expressed as a polynomial of degree $k+1$ with rational coefficients, the Faulhaber's Formulas:

$1^k + 2^k + ... + n^k = \sum_{i=1}^n i^k = \sum_{i=1}^{k+1} a_{i} n^i = a_{1} n + a_{2} n^2 + ... + a_{k} n^k + a_{k+1} n^{k + 1}$,

where $a_i$'s are rational coefficients that can be written as reduced fractions $p_i/q_i$ (if $a_i = 0$, we shall consider $q_i = 1$).

For example, $1^4 + 2^4 + ... + n^4 = -\frac 1 {30} n + \frac 1 3 n^3 + \frac 1 2 n^4 + \frac 1 5 n^5.$

Define $D(k)$ as the value of $q_1$ for the sum of $k$th powers (i.e. the denominator of the reduced fraction $a_1$).

Define $F(m)$ as the $m$th value of $k \ge 1$ for which $D(k) = 20010$.

You are given $D(4) = 30$ (since $a_1 = -1/30$), $D(308) = 20010$, $F(1) = 308$, $F(10) = 96404$.

Find $F(10^5)$.

Give your answer modulo $99991$.",REDACTED
pe-546,"Define $f_k(n) = \sum_{i=0}^n f_k(\lfloor\frac i k \rfloor)$ where $f_k(0) = 1$ and $\lfloor x \rfloor$ denotes the floor function.

For example, $f_5(10) = 18$, $f_7(100) = 1003$, and $f_2(10^3) = 264830889564$.

Find $(\sum_{k=2}^{10} f_k(10^{14})) \bmod (10^9+7)$.",REDACTED
pe-548,"A gozinta chain for $n$ is a sequence $\{1,a,b,\dots,n\}$ where each element properly divides the next.

There are eight gozinta chains for $12$:

$\{1,12\}$, $\{1,2,12\}$, $\{1,2,4,12\}$, $\{1,2,6,12\}$, $\{1,3,12\}$, $\{1,3,6,12\}$, $\{1,4,12\}$ and $\{1,6,12\}$.
 
Let $g(n)$ be the number of gozinta chains for $n$, so $g(12)=8$.

$g(48)=48$ and $g(120)=132$.

Find the sum of the numbers $n$  not exceeding $10^{16}$ for which $g(n)=n$.

Give your answer modulo $99991$.",REDACTED
pe-549,"The smallest number $m$ such that $10$ divides $m!$ is $m=5$.

The smallest number $m$ such that $25$ divides $m!$ is $m=10$.
 

Let $s(n)$ be the smallest number $m$ such that $n$ divides $m!$.

So $s(10)=5$ and $s(25)=10$.

Let $S(n)$ be $\sum s(i)$ for $2 \le i \le n$.

$S(100)=2012$.

Find $S(10^8)$.

Give your answer modulo $99991$.",REDACTED
pe-550,"Two players are playing a game, alternating turns. There are $k$ piles of stones.
On each turn, a player has to choose a pile and replace it with two piles of stones under the following two conditions:

-  Both new piles must have a number of stones more than one and less than the number of stones of the original pile.

-  The number of stones of each of the new piles must be a divisor of the number of stones of the original pile.

The first player unable to make a valid move loses.

Let $f(n,k)$ be the number of winning positions for the first player, assuming perfect play, when the game is played with $k$ piles each having between $2$ and $n$ stones (inclusively).
$f(10,5)=40085$.

Find $f(10^7,10^{12})$.
Give your answer modulo $987654321$.",REDACTED
pe-551,"Let $a_0, a_1, \dots$ be an integer sequence defined by:

- $a_0 = 1$;

- for $n \ge 1$, $a_n$ is the sum of the digits of all preceding terms.

The sequence starts with $1, 1, 2, 4, 8, 16, 23, 28, 38, 49, \dots$

You are given $a_{10^6} = 31054319$.

Find $a_{10^{15}}$.

Give your answer modulo $99991$.",REDACTED
pe-552,"Let $A_n$ be the smallest positive integer satisfying $A_n \bmod p_i = i$ for all $1 \le i \le n$, where $p_i$ is the
$i$-th prime.

For example $A_2 = 5$, since this is the smallest positive solution of the system of equations

-  $A_2 \bmod 2 = 1$ 

-  $A_2 \bmod 3 = 2$ 

The system of equations for $A_3$ adds another constraint. That is, $A_3$ is the smallest positive solution of

-  $A_3 \bmod 2 = 1$ 

-  $A_3 \bmod 3 = 2$ 

-  $A_3 \bmod 5 = 3$ 

and hence $A_3 = 23$. Similarly, one gets $A_4 = 53$ and $A_5 = 1523$.

Let $S(n)$ be the sum of all primes up to $n$ that divide at least one element in the sequence $A$.

For example, $S(50) = 69 = 5 + 23 + 41$, since $5$ divides $A_2$, $23$ divides $A_3$ and $41$ divides $A_{10} = 5765999453$. No other prime number up to $50$ divides an element in $A$.

Find $S(300000)$.",REDACTED
pe-555,"The McCarthy 91 function is defined as follows:
$$
M_{91}(n) = 
    \begin{cases}
        n - 10 &amp; \text{if } n &gt; 100 \\
        M_{91}(M_{91}(n+11)) &amp; \text{if } 0 \leq n \leq 100
    \end{cases}
$$

We can generalize this definition by abstracting away the constants into new variables:

$$
M_{m,k,s}(n) = 
    \begin{cases}
        n - s &amp; \text{if } n &gt; m \\
        M_{m,k,s}(M_{m,k,s}(n+k)) &amp; \text{if } 0 \leq n \leq m
    \end{cases}
$$

This way, we have $M_{91} = M_{100,11,10}$.

Let $F_{m,k,s}$ be the set of fixed points of $M_{m,k,s}$. That is, 

$$F_{m,k,s}= \left\{ n \in \mathbb{N} \, | \, M_{m,k,s}(n) = n \right\}$$

For example, the only fixed point of $M_{91}$ is $n = 91$. In other words, $F_{100,11,10}= \{91\}$.

 

Now, define $SF(m,k,s)$ as the sum of the elements in $F_{m,k,s}$ and let $S(p,m) = \displaystyle \sum_{1 \leq s &lt; k \leq p}{SF(m,k,s)}$.

For example, $S(10, 10) = 225$ and $S(1000, 1000)=208724467$.

Find $S(10^6, 10^6)$.

Give your answer modulo $99991$.",REDACTED
pe-556,"A Gaussian integer is a number $z = a + bi$ where $a$, $b$ are integers and $i^2 = -1$.

Gaussian integers are a subset of the complex numbers, and the integers are the subset of Gaussian integers for which $b = 0$.

A Gaussian integer unit is one for which $a^2 + b^2 = 1$, i.e. one of $1, i, -1, -i$.

Let's define a proper Gaussian integer as one for which $a \gt 0$ and $b \ge 0$.

A Gaussian integer $z_1 = a_1 + b_1 i$ is said to be divisible by $z_2 = a_2 + b_2 i$ if $z_3 = a_3 + b_3 i = z_1 / z_2$ is a Gaussian integer.

$\frac {z_1} {z_2} = \frac {a_1 + b_1 i} {a_2 + b_2 i} = \frac {(a_1 + b_1 i)(a_2 - b_2 i)} {(a_2 + b_2 i)(a_2 - b_2 i)} = \frac {a_1 a_2 + b_1 b_2} {a_2^2 + b_2^2} + \frac  {a_2 b_1 - a_1 b_2}  {a_2^2 + b_2^2}i = a_3 + b_3 i$

So, $z_1$ is divisible by $z_2$ if $\frac {a_1 a_2 + b_1 b_2} {a_2^2 + b_2^2}$ and $\frac  {a_2 b_1 - a_1 b_2}  {a_2^2 + b_2^2}$ are integers.

For example, $2$ is divisible by $1 + i$ because $2/(1 + i) = 1 - i$ is a Gaussian integer.

A Gaussian prime is a Gaussian integer that is divisible only by a unit, itself or itself times a unit.

For example, $1 + 2i$ is a Gaussian prime, because it is only divisible by $1$, $i$, $-1$, $-i$, $1 + 2i$, $i(1 + 2i) = i - 2$, $-(1 + 2i) = -1 - 2i$ and $-i(1 + 2i) = 2 - i$.

$2$ is not a Gaussian prime as it is divisible by $1 + i$.

A Gaussian integer can be uniquely factored as the product of a unit and proper Gaussian primes.

For example $2 = -i(1 + i)^2$ and $1 + 3i = (1 + i)(2 + i)$.

A Gaussian integer is said to be squarefree if its prime factorization does not contain repeated proper Gaussian primes.

So $2$ is not squarefree over the Gaussian integers, but $1 + 3i$ is.

Units and Gaussian primes are squarefree by definition.

Let $f(n)$ be the count of proper squarefree Gaussian integers with $a^2 + b^2 \le n$.

For example $f(10) = 7$ because $1$, $1 + i$, $1 + 2i$, $1 + 3i = (1 + i)(2 + i)$, $2 + i$, $3$ and $3 + i = -i(1 + i)(1 + 2i)$ are squarefree, while $2 = -i(1 + i)^2$ and $2 + 2i = -i(1 + i)^3$ are not.

You are given $f(10^2) = 54$, $f(10^4) = 5218$ and $f(10^8) = 52126906$.

Find $f(10^{14})$.

Give your answer modulo $99991$.",REDACTED
pe-558,"Let $r$ be the real root of the equation $x^3 = x^2 + 1$.

Every positive integer can be written as the sum of distinct increasing powers of $r$.

If we require the number of terms to be finite and the difference between any two exponents to be three or more, then the representation is unique.

For example, $3 = r^{-10} + r^{-5} + r^{-1} + r^2$ and $10 = r^{-10} + r^{-7} + r^6$.

Interestingly, the relation holds for the complex roots of the equation.

Let $w(n)$ be the number of terms in this unique representation of $n$. Thus $w(3) = 4$ and $w(10) = 3$.

More formally, for all positive integers $n$, we have:

$n = \displaystyle \sum_{k=-\infty}^\infty b_k r^k$

under the conditions that:

$b_k$ is $0$ or $1$ for all $k$;

$b_k + b_{k + 1} + b_{k + 2} \le 1$ for all $k$;

$w(n) = \displaystyle \sum_{k=-\infty}^\infty b_k$ is finite.

Let $S(m) = \displaystyle \sum_{j=1}^m w(j^2)$.

You are given $S(10) = 61$ and $S(1000) = 19403$.

Find $S(5\,000\,000)$.

Give your answer modulo $99991$.",REDACTED
pe-559,"An ascent of a column $j$ in a matrix occurs if the value of column $j$ is smaller than the value of column $j + 1$ in all rows.

Let $P(k, r, n)$ be the number of $r \times n$ matrices with the following properties:

- The rows are permutations of $\{1, 2, 3, \dots, n\}$.

-  Numbering the first column as $1$, a column ascent occurs at column $j \lt n$ if and only if $j$ is not a multiple of $k$.

For example, $P(1, 2, 3) = 19$, $P(2, 4, 6) = 65508751$ and $P(7, 5, 30) \bmod 1000000123 = 161858102$.

Let $Q(n) = \displaystyle \sum_{k=1}^n P(k, n, n)$.

For example, $Q(5) = 21879393751$ and $Q(50) \bmod 1000000123 = 819573537$.

Find $Q(50000) \bmod 1000000123$.",REDACTED
pe-560,"Coprime Nim is just like ordinary normal play Nim, but the players may only remove a number of stones from a pile that is coprime with the current size of the pile. Two players remove stones in turn. The player who removes the last stone wins.

Let $L(n, k)$ be the number of losing starting positions for the first player, assuming perfect play, when the game is played with $k$ piles, each having between $1$ and $n - 1$ stones inclusively.

For example, $L(5, 2) = 6$ since the losing initial positions are $(1, 1)$, $(2, 2)$, $(2, 4)$, $(3, 3)$, $(4, 2)$ and $(4, 4)$.

You are also given $L(10, 5) = 9964$, $L(10, 10) = 472400303$, $L(10^3, 10^3) \bmod 1\,000\,000\,007 = 954021836$.

Find $L(10^7, 10^7)\bmod 1\,000\,000\,007$.",REDACTED
pe-561,"Let $S(n)$ be the number of pairs $(a,b)$ of distinct divisors of $n$ such that $a$ divides $b$.

For $n=6$ we get the following pairs: $(1,2), (1,3), (1,6),( 2,6)$ and $(3,6)$. So $S(6)=5$.

Let $p_m\#$ be the product of the first $m$ prime numbers,  so $p_2\# = 2*3 = 6$.

Let $E(m, n)$ be the highest integer $k$ such that $2^k$ divides $S((p_m\#)^n)$.

$E(2,1) = 0$ since $2^0$ is the highest power of 2 that divides S(6)=5.

Let $Q(n)=\sum_{i=1}^{n} E(904961, i)$

$Q(8)=2714886$.

Evaluate $Q(10^{12})$.

Give your answer modulo $99991$.",REDACTED
pe-562,"Construct triangle $ABC$ such that:

- Vertices $A$, $B$ and $C$ are lattice points inside or on the circle of radius $r$ centered at the origin;

- the triangle contains no other lattice point inside or on its edges;

- the perimeter is maximum.

Let $R$ be the circumradius of triangle $ABC$ and $T(r) = R/r$.

For $r = 5$, one possible triangle has vertices $(-4,-3)$, $(4,2)$ and $(1,0)$ with perimeter $\sqrt{13}+\sqrt{34}+\sqrt{89}$ and circumradius $R = \sqrt {\frac {19669} 2 }$, so $T(5) = \sqrt {\frac {19669} {50} }$.

You are given $T(10) \approx 97.26729$ and $T(100) \approx 9157.64707$.

Find $T(10^7)$. Give your answer rounded to the nearest integer.

Give your answer modulo $99991$.",REDACTED
pe-563,"A company specialises in producing large rectangular metal sheets, starting from unit square metal plates.  The welding is performed by a range of robots of increasing size.  Unfortunately, the programming options of these robots are rather limited.  Each one can only process up to $25$ identical rectangles of metal, which they can weld along either edge to produce a larger rectangle.  The only programmable variables are the number of rectangles to be processed (up to and including $25$), and whether to weld the long or short edge.

For example, the first robot could be programmed to weld together $11$ raw unit square plates to make a $11 \times 1$ strip. The next could take $10$ of these $11 \times 1$ strips, and weld them either to make a longer $110 \times 1$ strip, or a $11 \times 10$ rectangle. Many, but not all, possible dimensions of  metal sheets can be constructed in this way.

One regular customer has a particularly unusual order: The finished product should have an exact area, and the long side must not be more than $10\%$ larger than the short side. If these requirements can be met in more than one way, in terms of the exact dimensions of the two sides, then the customer will demand that all variants be produced. For example, if the order calls for a metal sheet of area $889200$, then there are three final dimensions that can be produced: $900 \times 988$, $912 \times 975$ and $936 \times 950$. The target area of $889200$ is the smallest area which can be manufactured in three different variants, within the limitations of the robot welders.

Let $M(n)$ be the minimal area that can be manufactured in exactly $n$ variants with the longer edge not greater than $10\%$ bigger than the shorter edge. Hence $M(3) = 889200$.

Find $\sum_{n=2}^{100} M(n)$.

Give your answer modulo $99991$.",REDACTED
pe-565,"Let $\sigma(n)$ be the sum of the divisors of $n$.

E.g. the divisors of $4$ are $1$, $2$ and $4$, so $\sigma(4)=7$.

The numbers $n$ not exceeding $20$ such that $7$ divides  $\sigma(n)$ are:  $4$, $12$, $13$ and $20$, the sum of these numbers being $49$.

Let $S(n, d)$ be the sum of the numbers $i$ not exceeding $n$ such that $d$ divides $\sigma(i)$.

So $S(20 , 7)=49$.

You are given: $S(10^6,2017)=150850429$ and $S(10^9, 2017)=249652238344557$.

Find $S(10^{11}, 2017)$.

Give your answer modulo $99991$.",REDACTED
pe-568,"Tom has built a random generator that is connected to a row of $n$ light bulbs. Whenever the random generator is activated each of the $n$ lights is turned on with the probability of $\frac 1 2$, independently of its former state or the state of the other light bulbs.

While discussing with his friend Jerry how to use his generator, they invent two different games, they call the reciprocal games:

Both games consist of $n$ turns. Each turn is started by choosing a number $k$ randomly between (and including) $1$ and $n$, with equal probability of $\frac 1 n$ for each number, while the possible win for that turn is the reciprocal of $k$, that is $\frac 1 k$.

In game A, Tom activates his random generator once in each turn. If the number of lights turned on is the same as the previously chosen number $k$, Jerry wins and gets $\frac 1 k$, otherwise he will receive nothing for that turn. Jerry's expected win after playing the total game A consisting of $n$ turns is called $J_A(n)$. For example $J_A(6)=0.39505208$, rounded to $8$ decimal places.

For each turn in game B, after $k$ has been randomly selected, Tom keeps reactivating his random generator until exactly $k$ lights are turned on. After that Jerry takes over and reactivates the random generator until he, too, has generated a pattern with exactly $k$ lights turned on. If this pattern is identical to Tom's last pattern, Jerry wins and gets $\frac 1 k$, otherwise he will receive nothing. Jerry's expected win after the total game B consisting of $n$ turns is called $J_B(n)$. For example $J_B(6)=0.43333333$, rounded to $8$ decimal places.

Let $D(n)=J_B(n)−J_A(n)$. For example, $D(6) = 0.03828125$.

Find the $7$ most significant digits of $D(123456789)$ after removing all leading zeros.

(If, for example, we had asked for the $7$ most significant digits of $D(6)$, the answer would have been 3828125.)

Give your answer modulo $99991$.",REDACTED
pe-571,"A positive number is pandigital in base $b$ if it contains all digits from $0$ to $b - 1$ at least once when written in base $b$.

An $n$-super-pandigital number is a number that is simultaneously pandigital in all bases from $2$ to $n$ inclusively.

For example $978 = 1111010010_2 = 1100020_3 = 33102_4 = 12403_5$ is the smallest $5$-super-pandigital number.

Similarly, $1093265784$ is the smallest $10$-super-pandigital number.

The sum of the $10$ smallest $10$-super-pandigital numbers is $20319792309$.

What is the sum of the $10$ smallest $12$-super-pandigital numbers?

Give your answer modulo $99991$.",REDACTED
pe-572,"A matrix $M$ is called idempotent if $M^2 = M$.

Let $M$ be a three by three matrix : 
$M=\begin{pmatrix} 
  a &amp; b &amp; c\\ 
  d &amp; e &amp; f\\
  g &amp;h &amp;i\\
\end{pmatrix}$.

Let $C(n)$ be the number of idempotent three by three matrices $M$ with integer elements such that

$ -n \le a,b,c,d,e,f,g,h,i \le n$.

$C(1)=164$ and $C(2)=848$.

Find $C(200)$.

Give your answer modulo $99991$.",REDACTED
pe-574,"Let $q$ be a prime and $A \ge B &gt;0$ be two integers with the following properties:

-  $A$ and $B$ have no prime factor in common, that is $\gcd(A,B)=1$.

-  The product $AB$ is divisible by every prime less than q.

It can be shown that, given these conditions, any sum $A+B&lt;q^2$ and any difference $1&lt;A-B&lt;q^2$ has to be a prime number. Thus you can verify that a number $p$ is prime by showing that either $p=A+B&lt;q^2$ or $p=A-B&lt;q^2$ for some $A,B,q$ fulfilling the conditions listed above.

Let $V(p)$ be the smallest possible value of $A$ in any sum $p=A+B$ and any difference $p=A-B$, that verifies $p$ being prime. Examples:

$V(2)=1$, since $2=1+1&lt; 2^2$. 

$V(37)=22$, since $37=22+15=2 \cdot 11+3 \cdot 5&lt; 7^2$ is the associated sum with the smallest possible $A$.

$V(151)=165$ since $151=165-14=3 \cdot 5 \cdot 11 - 2 \cdot 7&lt;13^2$ is the associated difference with the smallest possible $A$. 

Let $S(n)$ be the sum of $V(p)$ for all primes $p&lt;n$. For example, $S(10)=10$ and $S(200)=7177$.

Find $S(3800)$.

Give your answer modulo $99991$.",REDACTED
pe-578,"Any positive integer can be written as a product of prime powers: $p_1^{a_1} \times p_2^{a_2} \times \cdots \times p_k^{a_k}$,

where $p_i$ are distinct prime integers, $a_i \gt 0$ and $p_i \lt p_j$ if $i \lt j$.

A decreasing prime power positive integer is one for which $a_i \ge a_j$ if $i \lt j$.

For example, $1$, $2$, $15=3 \times 5$, $360=2^3 \times 3^2 \times 5$ and $1000=2^3 \times 5^3$ are decreasing prime power integers.

Let $C(n)$ be the count of decreasing prime power positive integers not exceeding $n$.

$C(100) = 94$ since all positive integers not exceeding $100$ have decreasing prime powers except $18$, $50$, $54$, $75$, $90$ and $98$.

You are given $C(10^6) = 922052$.

Find $C(10^{13})$.

Give your answer modulo $99991$.",REDACTED
pe-579,"A lattice cube is a cube in which all vertices have integer coordinates. Let $C(n)$ be the number of different lattice cubes in which the coordinates of all vertices range between (and including) $0$ and $n$. Two cubes are hereby considered different if any of their vertices have different coordinates.

For example, $C(1)=1$, $C(2)=9$, $C(4)=100$, $C(5)=229$, $C(10)=4469$ and $C(50)=8154671$.

Different cubes may contain different numbers of lattice points.

For example, the cube with the vertices

$(0, 0, 0)$, $(3, 0, 0)$, $(0, 3, 0)$, $(0, 0, 3)$, $(0, 3, 3)$, $(3, 0, 3)$, $(3, 3, 0)$, $(3, 3, 3)$ contains $64$ lattice points ($56$ lattice points on the surface including the $8$ vertices and $8$ points within the cube). 

In contrast, the cube with the vertices

$(0, 2, 2)$, $(1, 4, 4)$, $(2, 0, 3)$, $(2, 3, 0)$, $(3, 2, 5)$, $(3, 5, 2)$, $(4, 1, 1)$, $(5, 3, 3)$ contains only $40$ lattice points ($20$ points on the surface and $20$ points within the cube), although both cubes have the same side length $3$.

Let $S(n)$ be the sum of the lattice points contained in the different lattice cubes in which the coordinates of all vertices range between (and including) $0$ and $n$.

For example, $S(1)=8$, $S(2)=91$, $S(4)=1878$, $S(5)=5832$, $S(10)=387003$ and $S(50)=29948928129$.

Find $S(5000) \bmod 10^9$.",REDACTED
pe-580,"A Hilbert number is any positive integer of the form $4k+1$ for integer $k\geq 0$.  We shall define a squarefree Hilbert number as a Hilbert number which is not divisible by the square of any Hilbert number other than one.  For example, $117$ is a squarefree Hilbert number, equaling $9\times13$.  However $6237$ is a Hilbert number that is not squarefree in this sense, as it is divisible by $9^2$.  The number $3969$ is also not squarefree, as it is divisible by both $9^2$ and $21^2$.  

There are $2327192$ squarefree Hilbert numbers below $10^7$. 

How many squarefree Hilbert numbers are there below $10^{16}$?

Give your answer modulo $99991$.",REDACTED
pe-581,"A number is $p$-smooth if it has no prime factors larger than $p$.

Let $T$ be the sequence of triangular numbers, i.e. $T(n)=n(n+1)/2$.

Find the sum of all indices $n$ such that $T(n)$ is $47$-smooth.

Give your answer modulo $99991$.",REDACTED
pe-582,"Let $a, b$ and $c$ be the sides of an integer sided triangle with one angle of $120$ degrees, $a \le b \le c$ and $b-a \le 100$.

Let $T(n)$ be the number of such triangles with $c \le n$.

$T(1000)=235$ and $T(10^8)=1245$.

Find $T(10^{100})$.

Give your answer modulo $99991$.",REDACTED
pe-585,"Consider the term $\small \sqrt{x+\sqrt{y}+\sqrt{z}}$ that is representing a nested square root. $x$, $y$ and $z$ are positive integers and $y$ and $z$ are not allowed to be perfect squares, so the number below the outer square root is irrational. Still it can be shown that for some combinations of $x$, $y$ and $z$ the given term can be simplified into a sum and/or difference of simple square roots of integers, actually denesting the square roots in the initial expression. 

Here are some examples of this denesting:

$\small \sqrt{3+\sqrt{2}+\sqrt{2}}=\sqrt{2}+\sqrt{1}=\sqrt{2}+1$

$\small \sqrt{8+\sqrt{15}+\sqrt{15}}=\sqrt{5}+\sqrt{3}$

$\small \sqrt{20+\sqrt{96}+\sqrt{12}}=\sqrt{9}+\sqrt{6}+\sqrt{3}-\sqrt{2}=3+\sqrt{6}+\sqrt{3}-\sqrt{2}$

$\small \sqrt{28+\sqrt{160}+\sqrt{108}}=\sqrt{15}+\sqrt{6}+\sqrt{5}-\sqrt{2}$

As you can see the integers used in the denested expression may also be perfect squares resulting in further simplification.

Let F($n$) be the number of different terms $\small \sqrt{x+\sqrt{y}+\sqrt{z}}$, that can be denested into the sum and/or difference of a finite number of square roots, given the additional condition that $0&lt;x \le n$. That is,

$\small \displaystyle \sqrt{x+\sqrt{y}+\sqrt{z}}=\sum_{i=1}^k s_i\sqrt{a_i}$

with $k$, $x$, $y$, $z$ and all $a_i$ being positive integers, all $s_i =\pm 1$ and $x\le n$.
 Furthermore $y$ and $z$  are not allowed to be perfect squares.

Nested roots with the same value are not considered different, for example $\small \sqrt{7+\sqrt{3}+\sqrt{27}}$, $\small \sqrt{7+\sqrt{12}+\sqrt{12}}$ and $\small \sqrt{7+\sqrt{27}+\sqrt{3}}$, that can all three be denested into $\small 2+\sqrt{3}$, would only be counted once.

You are given that $F(10)=17$, $F(15)=46$, $F(20)=86$, $F(30)=213$ and $F(100)=2918$ and $F(5000)=11134074$.

Find $F(5000000)$.

Give your answer modulo $99991$.",REDACTED
pe-586,"The number $209$ can be expressed as $a^2 + 3ab + b^2$ in two distinct ways:

$ \qquad 209 = 8^2 + 3\cdot 8\cdot 5 + 5^2$ 

$ \qquad 209 = 13^2 + 3\cdot13\cdot 1 + 1^2$

Let $f(n,r)$ be the number of integers $k$ not exceeding $n$ that can be expressed as $k=a^2 + 3ab + b^2$, with $a \gt b \gt 0$ integers, in exactly $r$ different ways.

You are given that $f(10^5, 4) = 237$ and $f(10^8, 6) = 59517$.

Find $f(10^{15}, 40)$.

Give your answer modulo $99991$.",REDACTED
pe-588,"The coefficients in the expansion of $(x+1)^k$ are called binomial coefficients.

Analoguously the coefficients in the expansion of $(x^4+x^3+x^2+x+1)^k$ are called quintinomial coefficients.
 (quintus= Latin for fifth).

Consider the expansion of $(x^4+x^3+x^2+x+1)^3$:

$x^{12}+3x^{11}+6x^{10}+10x^9+15x^8+18x^7+19x^6+18x^5+15x^4+10x^3+6x^2+3x+1$

As we can see $7$ out of the $13$ quintinomial coefficients for $k=3$ are odd.

Let $Q(k)$ be the number of odd coefficients in the expansion of $(x^4+x^3+x^2+x+1)^k$.

So $Q(3)=7$.

You are given $Q(10)=17$ and $Q(100)=35$.

Find $\sum_{k=1}^{18}Q(10^k)$.

Give your answer modulo $99991$.",REDACTED
pe-590,"Let $H(n)$ denote the number of sets of positive integers such that the least common multiple of the integers in the set equals $n$.

E.g.:

The integers in the following ten sets all have a least common multiple of $6$:

$\{2,3\}$, $\{1,2,3\}$, $\{6\}$, $\{1,6\}$, $\{2,6\}$, $\{1,2,6\}$, $\{3,6\}$, $\{1,3,6\}$, $\{2,3,6\}$ and $\{1,2,3,6\}$.

Thus $H(6)=10$.

Let $L(n)$ denote the least common multiple of the numbers $1$ through $n$.

E.g. $L(6)$ is the least common multiple of the numbers $1,2,3,4,5,6$ and $L(6)$ equals $60$.

Let $HL(n)$ denote $H(L(n))$.

You are given $HL(4)=H(12)=44$.

Find $HL(50000)$. Give your answer modulo $10^9$.",REDACTED
pe-591,"Given a non-square integer $d$, any real $x$ can be approximated arbitrarily close by quadratic integers $a+b\sqrt{d}$, where $a,b$ are integers. For example, the following inequalities approximate $\pi$ with precision $10^{-13}$:

$$4375636191520\sqrt{2}-6188084046055 &lt; \pi &lt; 721133315582\sqrt{2}-1019836515172 $$
 
We call $BQA_d(x,n)$ the quadratic integer closest to $x$ with the absolute values of $a,b$ not exceeding $n$.
 We also define the integral part of a quadratic integer as $I_d(a+b\sqrt{d}) = a$.

You are given that:

- $BQA_2(\pi,10) = 6 - 2\sqrt{2}$

- $BQA_5(\pi,100)=26\sqrt{5}-55$

- $BQA_7(\pi,10^6)=560323 - 211781\sqrt{7}$

- $I_2(BQA_2(\pi,10^{13}))=-6188084046055$

Find the sum of $|I_d(BQA_d(\pi,10^{13}))|$ for all  non-square positive integers less than 100.

Give your answer modulo $99991$.",REDACTED
pe-596,"Let $T(r)$ be the number of integer quadruplets $x, y, z, t$ such that $x^2 + y^2 + z^2 + t^2 \le r^2$. In other words, $T(r)$ is the number of lattice points in the four-dimensional hyperball of radius $r$.

You are given that $T(2) = 89$, $T(5) = 3121$, $T(100) = 493490641$ and $T(10^4) = 49348022079085897$.

Find $T(10^8) \bmod 1000000007$.",REDACTED
pe-598,"Consider the number $48$.

There are five pairs of integers $a$ and $b$ ($a \leq b$) such that $a \times b=48$: $(1,48)$, $(2,24)$, $(3,16)$, $(4,12)$ and $(6,8)$.

It can be seen that both $6$ and $8$ have $4$ divisors.

So of those five pairs one consists of two integers with the same number of divisors.

In general:

Let $C(n)$ be the number of pairs of positive integers $a \times b=n$, ($a \leq b$) such that $a$ and $b$ have the same number of divisors; 
so $C(48)=1$.

You are given $C(10!)=3$: $(1680, 2160)$, $(1800, 2016)$ and $(1890,1920)$.

 
Find $C(100!)$.

Give your answer modulo $99991$.",REDACTED
pe-599,"The well-known Rubik's Cube puzzle has many fascinating mathematical properties. The 2×2×2 variant has 8 cubelets with a total of 24 visible faces, each with a coloured sticker. Successively turning faces will rearrange the cubelets, although not all arrangements of cubelets are reachable without dismantling the puzzle.

Suppose that we wish to apply new stickers to a 2×2×2 Rubik's cube in a non-standard colouring. Specifically, we have $n$ different colours available (with an unlimited supply of stickers of each colour), and we place one sticker on each of the 24 faces in any arrangement that we please. We are not required to use all the colours, and if desired the same colour may appear in more than one face of a single cubelet.

We say that two such colourings $c_1,c_2$ are essentially distinct if a cube coloured according to $c_1$ cannot be made to match a cube coloured according to $c_2$ by performing mechanically possible Rubik's Cube moves.

For example, with two colours available, there are 183 essentially distinct colourings.

How many essentially distinct colourings are there with 10 different colours available?

Give your answer modulo $99991$.",REDACTED
pe-601,"For every positive number $n$ we define the function $\mathop{streak}(n)=k$ as the smallest positive integer $k$ such that $n+k$ is not divisible by $k+1$.

E.g:

$13$ is divisible by $1$

$14$ is divisible by $2$

$15$ is divisible by $3$

$16$ is divisible by $4$

$17$ is NOT divisible by $5$

So $\mathop{streak}(13) = 4$. 
 
Similarly:

$120$ is divisible by $1$

$121$ is NOT divisible by $2$

So $\mathop{streak}(120) = 1$.

Define $P(s, N)$ to be the number of integers $n$, $1 \lt n \lt N$, for which $\mathop{streak}(n) = s$.

So $P(3, 14) = 1$ and $P(6, 10^6) = 14286$.

Find the sum, as $i$ ranges from $1$ to $31$, of $P(i, 4^i)$.

Give your answer modulo $99991$.",REDACTED
pe-602,"Alice enlists the help of some friends to generate a random number, using a single unfair coin. She and her friends sit around a table and, starting with Alice, they take it in turns to toss the coin. Everyone keeps a count of how many heads they obtain individually. The process ends as soon as Alice obtains a Head. At this point, Alice multiplies all her friends' Head counts together to obtain her random number.

As an illustration, suppose Alice is assisted by Bob, Charlie, and Dawn, who are seated round the table in that order, and that they obtain the sequence of Head/Tail outcomes THHH—TTTT—THHT—H beginning and ending with Alice. Then Bob and Charlie each obtain 2 heads, and Dawn obtains 1 head. Alice's random number is therefore $2\times 2\times 1 = 4$.

Define $e(n, p)$ to be the expected value of Alice's random number, where $n$ is the number of friends helping (excluding Alice herself), and $p$ is the probability of the coin coming up Tails.

It turns out that, for any fixed $n$, $e(n, p)$ is always a polynomial in $p$. For example, $e(3, p) = p^3 + 4p^2 + p$.

Define $c(n, k)$ to be the coefficient of $p^k$ in the polynomial $e(n, p)$. So $c(3, 1) = 1$, $c(3, 2) = 4$, and $c(3, 3) = 1$.

You are given that $c(100, 40) \equiv 986699437 \text{ } (\text{mod } 10^9+7)$.

Find $c(10000000, 4000000) \mod 10^9+7$.",REDACTED
pe-603,"Let $S(n)$ be the sum of all contiguous integer-substrings that can be formed from the integer $n$. The substrings need not be distinct. 

For example, $S(2024) = 2 + 0 + 2 + 4 + 20 + 02 + 24 + 202 + 024 + 2024 = 2304$.

Let $P(n)$ be the integer formed by concatenating the first $n$ primes together. For example, $P(7) = 2357111317$.

Let $C(n, k)$ be the integer formed by concatenating $k$ copies of $P(n)$ together. For example, $C(7, 3) = 235711131723571113172357111317$.

Evaluate $S(C(10^6, 10^{12})) \bmod (10^9 + 7)$.",REDACTED
pe-605,"Consider an $n$-player game played in consecutive pairs: Round $1$ takes place between players $1$ and $2$, round $2$ takes place between players $2$ and $3$, and so on and so forth, all the way up to round $n$, which takes place between players $n$ and $1$. Then round $n+1$ takes place between players $1$ and $2$ as the entire cycle starts again.

In other words, during round $r$, player $((r-1) \bmod n) + 1$ faces off against player $(r \bmod n) + 1$.

During each round, a fair coin is tossed to decide which of the two players wins that round. If any given player wins both rounds $r$ and $r+1$, then that player wins the entire game.

Let $P_n(k)$ be the probability that player $k$ wins in an $n$-player game, in the form of a reduced fraction. For example, $P_3(1) = 12/49$ and $P_6(2) = 368/1323$.

Let $M_n(k)$ be the product of the reduced numerator and denominator of $P_n(k)$. For example, $M_3(1) = 588$ and $M_6(2) = 486864$.

Find the last $8$ digits of $M_{10^8+7}(10^4+7)$.",REDACTED
pe-606,"A gozinta chain for $n$ is a sequence $\{1,a,b,\dots,n\}$ where each element properly divides the next. 

For example, there are eight distinct gozinta chains for $12$:

$\{1,12\}$, $\{1,2,12\}$, $\{1,2,4,12\}$, $\{1,2,6,12\}$, $\{1,3,12\}$, $\{1,3,6,12\}$, $\{1,4,12\}$ and $\{1,6,12\}$.

Let $S(n)$ be the sum of all numbers, $k$, not exceeding $n$, which have $252$ distinct gozinta chains. 

You are given $S(10^6)=8462952$ and $S(10^{12})=623291998881978$.

Find $S(10^{36})$, giving the last nine digits of your answer.",REDACTED
pe-608,"Let $D(m,n)=\displaystyle\sum_{d\mid m}\sum_{k=1}^n\sigma_0(kd)$ where $d$ runs through all divisors of $m$ and $\sigma_0(n)$ is the number of divisors of $n$.

You are given $D(3!,10^2)=3398$ and $D(4!,10^6)=268882292$.

Find $D(200!,10^{12}) \bmod (10^9 + 7)$.",REDACTED
pe-609,"For every $n \ge 1$ the prime-counting function $\pi(n)$ is equal to the number of primes
not exceeding $n$.

E.g. $\pi(6)=3$ and $\pi(100)=25$.

We say that a sequence of integers $u  = (u_0,\cdots,u_m)$ is a $\pi$ sequence if 

-  $u_n \ge 1$ for every $n$

-  $u_{n+1}= \pi(u_n)$

-  $u$ has two or more elements

For $u_0=10$ there are three distinct $\pi$ sequences: $(10,4)$, $(10,4,2)$ and $(10,4,2,1)$.

Let  $c(u)$ be the number of elements of $u$ that are not prime.

Let $p(n,k)$ be the number of $\pi$ sequences $u$  for which $u_0\le n$ and $c(u)=k$.

Let $P(n)$ be the product of all $p(n,k)$ that are larger than $0$.

You are given: $P(10)=3 \times 8 \times 9 \times 3=648$ and $P(100)=31038676032$.

Find $P(10^8)$. Give your answer modulo $1000000007$.",REDACTED
pe-611,"Peter moves in a hallway with $N + 1$ doors consecutively numbered from $0$ through $N$. All doors are initially closed. Peter starts in front of door $0$, and repeatedly performs the following steps:

- First, he walks a positive square number of doors away from his position.

- Then he walks another, larger square number of doors away from his new position.

- He toggles the door he faces (opens it if closed, closes it if open).

- And finally returns to door $0$.

We call an action any sequence of those steps. Peter never performs the exact same action twice, and makes sure to perform all possible actions that don't bring him past the last door.

Let $F(N)$ be the number of doors that are open after Peter has performed all possible actions. You are given that $F(5) = 1$, $F(100) = 27$, $F(1000) = 233$ and $F(10^6) = 112168$.

Find $F(10^{12})$.

Give your answer modulo $99991$.",REDACTED
pe-612,"Let's call two numbers friend numbers if their representation in base $10$ has at least one common digit.
 E.g. $1123$ and $3981$ are friend numbers. 

Let $f(n)$ be the number of pairs $(p,q)$ with $1\le p \lt q \lt n$ such that $p$ and $q$ are friend numbers.

$f(100)=1539$.

Find $f(10^{18}) \bmod 1000267129$.",REDACTED
pe-614,"An integer partition of a number $n$ is a way of writing $n$ as a sum of positive integers. Partitions that differ only by the order of their summands are considered the same.

We call an integer partition special if 1) all its summands are distinct, and 2) all its even summands are also divisible by $4$.
For example, the special partitions of $10$ are: $$10 = 1+4+5=3+7=1+9$$
The number $10$ admits many more integer partitions (a total of $42$), but only those three are special.

Let be $P(n)$ the number of special integer partitions of $n$. You are given that $P(1) = 1$, $P(2) = 0$, $P(3) = 1$, $P(6) = 1$, $P(10)=3$, $P(100) = 37076$ and $P(1000)=3699177285485660336$.

Find $\displaystyle \sum_{i=1}^{10^7} P(i)$. Give the result modulo $10^9+7$.",REDACTED
pe-615,"Consider the natural numbers having at least $5$ prime factors, which don't have to be distinct.
 Sorting these numbers by size gives a list which starts with:

- $32=2 \cdot 2 \cdot 2 \cdot 2 \cdot 2$

- $48=2 \cdot 2 \cdot 2 \cdot 2 \cdot 3$

- $64=2 \cdot 2 \cdot 2 \cdot 2 \cdot 2 \cdot 2$

- $72=2 \cdot 2 \cdot 2 \cdot 3 \cdot 3$

- $80=2 \cdot 2 \cdot 2 \cdot 2 \cdot 5$

- $96=2 \cdot 2 \cdot 2 \cdot 2 \cdot 2 \cdot 3$

- $\cdots$

So, for example, the fifth number with at least $5$ prime factors is $80$.

Find the millionth number with at least one million prime factors.
  Give your answer modulo $123454321$.",REDACTED
pe-616,"Alice plays the following game, she starts with a list of integers $L$ and on each step she can either:

- remove two elements $a$ and $b$ from $L$ and add $a^b$ to $L$

- or conversely remove an element $c$ from $L$ that can be written as $a^b$, with $a$ and $b$ being two integers such that $a, b &gt; 1$, and add both $a$ and $b$ to $L$
 
For example starting from the list $L=\{8\}$, Alice can remove $8$ and add $2$ and $3$ resulting in $L=\{2,3\}$ in a first step. Then she can obtain $L=\{9\}$ in a second step.

Note that the same integer is allowed to appear multiple times in the list.

An integer $n&gt;1$ is said to be creative if for any integer $m \gt 1$ Alice can obtain a list that contains $m$ starting from $L=\{n\}$.

Find the sum of all creative integers less than or equal to $10^{12}$.

Give your answer modulo $99991$.",REDACTED
pe-617,"For two integers $n,e \gt 1$, we define an $(n,e)$-MPS (Mirror Power Sequence) to be an infinite sequence of integers $(a_i)_{i\ge 0}$ such that for all $i\ge 0$, $a_{i+1} = \min(a_i^e,n-a_i^e)$ and $a_i \gt 1$.
 Examples of such sequences are the two $(18,2)$-MPS sequences made of alternating $2$ and $4$.

Note that even though such a sequence is uniquely determined by $n,e$ and $a_0$, for most values such a sequence does not exist. For example, no $(n,e)$-MPS exists for $n \lt 6$.

Define $C(n)$ to be the number of $(n,e)$-MPS for some $e$, and $\displaystyle D(N) = \sum_{n=2}^N C(n)$.

You are given that $D(10) = 2$, $D(100) = 21$, $D(1000) = 69$, $D(10^6) = 1303$ and $D(10^{12}) = 1014800$.

 
Find $D(10^{18})$.

Give your answer modulo $99991$.",REDACTED
pe-618,"Consider the numbers $15$, $16$ and $18$:

$15=3\times 5$ and $3+5=8$.

$16 = 2\times 2\times 2\times 2$ and $2+2+2+2=8$.

$18 = 2\times 3\times 3$ and $2+3+3=8$.
 

$15$, $16$ and $18$ are the only numbers that have $8$ as sum of the prime factors (counted with multiplicity).

We define $S(k)$ to be the sum of all numbers $n$ where the sum of the prime factors (with multiplicity)  of $n$ is $k$.

Hence $S(8) = 15+16+18 = 49$.

Other examples: $S(1) = 0$, $S(2) = 2$, $S(3) = 3$, $S(5) = 5 + 6 = 11$.

The Fibonacci sequence is $F_1 = 1$, $F_2 = 1$, $F_3 = 2$, $F_4 = 3$, $F_5 = 5$, ....

Find the last nine digits of $\displaystyle\sum_{k=2}^{24}S(F_k)$.",REDACTED
pe-619,"For a set of positive integers $\{a, a+1, a+2, \dots , b\}$, let $C(a,b)$ be the number of non-empty subsets in which the product of all elements is a perfect square.

For example $C(5,10)=3$, since the products of all elements of $\{5, 8, 10\}$, $\{5, 8, 9, 10\}$ and $\{9\}$ are perfect squares, and no other subsets of $\{5, 6, 7, 8, 9, 10\}$ have this property.

You are given that $C(40,55) =15$, and $C(1000,1234) \bmod 1000000007=975523611$.

Find $C(1000000,1234567) \bmod 1000000007$.",REDACTED
pe-621,"Gauss famously proved that every positive integer can be expressed as the sum of three triangular numbers (including $0$ as the lowest triangular number). In fact most numbers can be expressed as a sum of three triangular numbers in several ways.

Let $G(n)$ be the number of ways of expressing $n$ as the sum of three triangular numbers, regarding different arrangements of the terms of the sum as distinct.

For example, $G(9) = 7$, as $9$ can be expressed as: $3+3+3$, $0+3+6$, $0+6+3$, $3+0+6$, $3+6+0$, $6+0+3$, $6+3+0$.
  
You are given $G(1000) = 78$ and $G(10^6) = 2106$.

Find $G(17526 \times 10^9)$.

Give your answer modulo $99991$.",REDACTED
pe-622,"A riffle shuffle is executed as follows: a deck of cards is split into two equal halves, with the top half taken in the left hand and the bottom half taken in the right hand. Next, the cards are interleaved exactly, with the top card in the right half inserted just after the top card in the left half, the 2nd card in the right half just after the 2nd card in the left half, etc. (Note that this process preserves the location of the top and bottom card of the deck)

Let $s(n)$ be the minimum number of consecutive riffle shuffles needed to restore a deck of size $n$ to its original configuration, where $n$ is a positive even number.

Amazingly, a standard deck of $52$ cards will first return to its original configuration after only $8$ perfect shuffles, so $s(52) = 8$. It can be verified that a deck of $86$ cards will also return to its original configuration after exactly $8$ shuffles, and the sum of all values of $n$ that satisfy $s(n) = 8$ is $412$.

Find the sum of all values of n that satisfy $s(n) = 60$.

Give your answer modulo $99991$.",REDACTED
pe-623,"The lambda-calculus is a universal model of computation at the core of functional programming languages. It is based on lambda-terms, a minimal programming language featuring only function definitions, function calls and variables. Lambda-terms are built according to the following rules:

- Any variable $x$ (single letter, from some infinite alphabet) is a lambda-term.

- If $M$ and $N$ are lambda-terms, then $(M N)$ is a lambda-term, called the application of $M$ to $N$.

- If $x$ is a variable and $M$ is a term, then $(\lambda x. M)$ is a lambda-term, called an abstraction. An abstraction defines an anonymous function, taking $x$ as parameter and sending back $M$.

A lambda-term $T$ is said to be closed if for all variables $x$, all occurrences of $x$ within $T$ are contained within some abstraction $(\lambda x. M)$ in $T$. The smallest such abstraction is said to bind the occurrence of the variable $x$. In other words, a lambda-term is closed if all its variables are bound to parameters of enclosing functions definitions. For example, the term $(\lambda x. x)$ is closed, while the term $(\lambda x. (x y))$ is not because $y$ is not bound.

Also, we can rename variables as long as no binding abstraction changes. This means that $(\lambda x. x)$ and $(\lambda y. y)$ should be considered equivalent since we merely renamed a parameter. Two terms equivalent modulo such renaming are called $\alpha$-equivalent. Note that $(\lambda x. (\lambda y. (x y)))$ and $(\lambda x. (\lambda x. (x x)))$ are not $\alpha$-equivalent, since the abstraction binding the first variable was the outer one and becomes the inner one. However, $(\lambda x. (\lambda y. (x y)))$ and $(\lambda y. (\lambda x. (y x)))$ are $\alpha$-equivalent.

The following table regroups the lambda-terms that can be written with at most $15$ symbols, symbols being parenthesis, $\lambda$, dot and variables.

$$\begin{array}{|c|c|c|c|}
\hline
(\lambda x.x) &amp; (\lambda x.(x x)) &amp; (\lambda x.(\lambda y.x)) &amp; (\lambda x.(\lambda y.y)) \\
\hline
(\lambda x.(x (x x))) &amp; (\lambda x.((x x) x)) &amp; (\lambda x.(\lambda y.(x x))) &amp; (\lambda x.(\lambda y.(x y))) \\
\hline
(\lambda x.(\lambda y.(y x))) &amp; (\lambda x.(\lambda y.(y y))) &amp; (\lambda x.(x (\lambda y.x))) &amp; (\lambda x.(x (\lambda y.y))) \\
\hline
(\lambda x.((\lambda y.x) x)) &amp; (\lambda x.((\lambda y.y) x)) &amp; ((\lambda x.x) (\lambda x.x)) &amp; (\lambda x.(x (x (x x)))) \\
\hline
(\lambda x.(x ((x x) x))) &amp; (\lambda x.((x x) (x x))) &amp; (\lambda x.((x (x x)) x)) &amp; (\lambda x.(((x x) x) x)) \\
\hline
\end{array}$$

Let be $\Lambda(n)$ the number of distinct closed lambda-terms that can be written using at most $n$ symbols, where terms that are $\alpha$-equivalent to one another should be counted only once. You are given that $\Lambda(6) = 1$, $\Lambda(9) = 2$, $\Lambda(15) = 20$ and $\Lambda(35) = 3166438$.

Find $\Lambda(2000)$. Give the answer modulo $1\,000\,000\,007$.",REDACTED
pe-624,"An unbiased coin is tossed repeatedly until two consecutive heads are obtained. Suppose these occur on the $(M-1)$th and $M$th toss.

Let $P(n)$ be the probability that $M$ is divisible by $n$. For example, the outcomes HH, HTHH, and THTTHH all count towards $P(2)$, but THH and HTTHH do not.

You are given that $P(2) =\frac 3 5$ and $P(3)=\frac 9  {31}$. Indeed, it can be shown that $P(n)$ is always a rational number.

For a prime $p$ and a fully reduced fraction $\frac a b$, define $Q(\frac a b,p)$ to be the smallest positive $q$ for which $a \equiv b q \pmod{p}$.

For example $Q(P(2), 109) = Q(\frac 3 5, 109) = 66$, because $5 \cdot 66 = 330 \equiv 3 \pmod{109}$ and $66$ is the smallest positive such number.

Similarly $Q(P(3),109) = 46$.

Find $Q(P(10^{18}),1\,000\,000\,009)$.",REDACTED
pe-625,"$G(N)=\sum_{j=1}^N\sum_{i=1}^j \gcd(i,j)$. 

You are given: $G(10)=122$.

Find $G(10^{11})$. Give your answer modulo $998244353$.",REDACTED
pe-626,"A binary matrix is a matrix consisting entirely of $0$s and $1$s. Consider the following transformations that can be performed on a binary matrix:

- Swap any two rows

- Swap any two columns

- Flip all elements in a single row ($1$s become $0$s, $0$s become $1$s)

- Flip all elements in a single column

Two binary matrices $A$ and $B$ will be considered equivalent if there is a sequence of such transformations that when applied to $A$ yields $B$. For example, the following two matrices are equivalent:

$A=\begin{pmatrix} 
  1 &amp; 0 &amp; 1 \\ 
  0 &amp; 0 &amp; 1 \\
  0 &amp; 0 &amp; 0 \\
\end{pmatrix} \quad B=\begin{pmatrix} 
  0 &amp; 0 &amp; 0 \\ 
  1 &amp; 0 &amp; 0 \\
  0 &amp; 0 &amp; 1 \\
\end{pmatrix}$
via the sequence of two transformations ""Flip all elements in column 3"" followed by ""Swap rows 1 and 2"".

Define $c(n)$ to be the maximum number of $n\times n$ binary matrices that can be found such that no two are equivalent. For example, $c(3)=3$. You are also given that $c(5)=39$ and $c(8)=656108$.

Find $c(20)$, and give your answer modulo $1\,001\,001\,011$.",REDACTED
pe-627,"Consider the set $S$ of all possible products of $n$ positive integers not exceeding $m$, that is
 
$S=\{ x_1x_2\cdots x_n \mid 1 \le x_1, x_2, \dots, x_n \le m \}$.

Let $F(m,n)$ be the number of the distinct elements of the set $S$.

For example, $F(9, 2) = 36$ and $F(30,2)=308$.

Find $F(30, 10001) \bmod 1\,000\,000\,007$.",REDACTED
pe-629,"Alice and Bob are playing a modified game of Nim called Scatterstone Nim, with Alice going first, alternating turns with Bob. The game begins with an arbitrary set of stone piles with a total number of stones equal to $n$.

During a player's turn, he/she must pick a pile having at least $2$ stones and perform a split operation, dividing the pile into an arbitrary set of $p$ non-empty, arbitrarily-sized piles where $2 \leq p \leq k$ for some fixed constant $k$. For example, a pile of size $4$ can be split into $\{1, 3\}$ or $\{2, 2\}$, or $\{1, 1, 2\}$ if $k = 3$ and in addition $\{1, 1, 1, 1\}$ if $k = 4$.

If no valid move is possible on a given turn, then the other player wins the game.

A winning position is defined as a set of stone piles where a player can ultimately ensure victory no matter what the other player does.

Let $f(n,k)$ be the number of winning positions for Alice on her first turn, given parameters $n$ and $k$. For example, $f(5, 2) = 3$ with winning positions $\{1, 1, 1, 2\}, \{1, 4\}, \{2, 3\}$. In contrast, $f(5, 3) = 5$ with winning positions $\{1, 1, 1, 2\}, \{1, 1, 3\}, \{1, 4\}, \{2, 3\}, \{5\}$.

Let $g(n)$ be the sum of $f(n,k)$ over all $2 \leq k \leq n$. For example, $g(7)=66$ and $g(10)=291$.

Find $g(200) \bmod (10^9 + 7)$.",REDACTED
pe-631,"Let $(p_1 p_2 \ldots p_k)$ denote the permutation of the set ${1, ..., k}$ that maps $p_i\mapsto i$. Define the length of the permutation to be $k$; note that the empty permutation $()$ has length zero.

Define an occurrence of a permutation $p=(p_1 p_2 \cdots p_k)$ in a permutation $P=(P_1 P_2 \cdots P_n)$ to be a sequence $1\leq t_1 \lt t_2 \lt \cdots \lt t_k \leq n$ such that $p_i \lt p_j$ if and only if $P_{t_i} \lt P_{t_j}$ for all $i,j \in \{1, \dots, k\}$.

For example, $(1243)$ occurs twice in the permutation $(314625)$: once as the 1st, 3rd, 4th and 6th elements $(3\,\,46\,\,5)$, and once as the 2nd, 3rd, 4th and 6th elements $(\,\,146\,\,5)$.

Let $f(n, m)$ be the number of permutations $P$ of length at most $n$ such that there is no occurrence of the permutation $1243$ in $P$ and there are at most $m$ occurrences of the permutation $21$ in $P$.

For example, $f(2,0) = 3$, with the permutations $()$, $(1)$, $(1,2)$ but not $(2,1)$.

You are also given that $f(4, 5) = 32$ and $f(10, 25) = 294\,400$.

Find $f(10^{18}, 40)$ modulo $1\,000\,000\,007$.",REDACTED
pe-632,"For an integer $n$, we define the square prime factors of $n$ to be the primes whose square divides $n$. For example, the square prime factors of $1500=2^2 \times 3 \times 5^3$ are $2$ and $5$.

Let $C_k(N)$ be the number of integers between $1$ and $N$ inclusive with exactly $k$ square prime factors. You are given some values of $C_k(N)$ in the table below.

$$\begin{array}{|c|c|c|c|c|c|c|}
\hline

&amp; k = 0 &amp; k = 1 &amp; k = 2 &amp; k = 3 &amp; k = 4 &amp; k = 5 \\
\hline
N=10 &amp; 7 &amp; 3 &amp; 0 &amp; 0 &amp; 0 &amp; 0 \\
\hline
N=10^2 &amp; 61 &amp; 36 &amp; 3 &amp; 0 &amp; 0 &amp; 0 \\
\hline
N=10^3 &amp; 608 &amp; 343 &amp; 48 &amp; 1 &amp; 0 &amp; 0 \\
\hline
N=10^4 &amp; 6083 &amp; 3363 &amp; 533 &amp; 21 &amp; 0 &amp; 0 \\
\hline
N=10^5 &amp; 60794 &amp; 33562 &amp; 5345 &amp; 297 &amp; 2 &amp; 0 \\
\hline
N=10^6 &amp; 607926 &amp; 335438 &amp; 53358 &amp; 3218 &amp; 60 &amp; 0 \\
\hline
N=10^7 &amp; 6079291 &amp; 3353956 &amp; 533140 &amp; 32777 &amp; 834 &amp; 2 \\
\hline
N=10^8 &amp; 60792694 &amp; 33539196 &amp; 5329747 &amp; 329028 &amp; 9257 &amp; 78 \\
\hline
\end{array}$$

Find the product of all non-zero $C_k(10^{16})$. Give the result reduced modulo $1\,000\,000\,007$.",REDACTED
pe-634,"Define $F(n)$ to be the number of integers $x≤n$ that can be written in the form $x=a^2b^3$, where $a$ and $b$ are integers not necessarily different and both greater than 1.

For example, $32=2^2\times 2^3$  and $72=3^2\times 2^3$ are the only two integers less than $100$ that can be written in this form. Hence, $F(100)=2$.

Further you are given $F(2\times 10^4)=130$ and $F(3\times 10^6)=2014$.

Find $F(9\times 10^{18})$.

Give your answer modulo $99991$.",REDACTED
pe-635,"Let $A_q(n)$ be the number of subsets, $B$, of the set $\{1, 2, ..., q \cdot n\}$ that satisfy two conditions:

1) $B$ has exactly $n$ elements;

2) the sum of the elements of $B$ is divisible by $n$.

E.g. $A_2(5)=52$ and $A_3(5)=603$.

Let $S_q(L)$ be $\sum A_q(p)$ where the sum is taken over all primes $p \le L$.

E.g. $S_2(10)=554$, $S_2(100)$ mod $1\,000\,000\,009=100433628$ and
 $S_3(100)$ mod $1\,000\,000\,009=855618282$.

Find $S_2(10^8)+S_3(10^8)$. Give your answer modulo $1\,000\,000\,009$.",REDACTED
pe-636,"Consider writing a natural number as product of powers of natural numbers with given exponents, additionally requiring different base numbers for each power.

For example, $256$ can be written as a product of a square and a fourth power in three ways such that the base numbers are different.

That is, $256=1^2\times 4^4=4^2\times 2^4=16^2\times 1^4$

Though $4^2$ and $2^4$ are both equal, we are concerned only about the base numbers in this problem. Note that permutations are not considered distinct, for example $16^2\times 1^4$ and $1^4 \times 16^2$ are considered to be the same.

Similarly, $10!$ can be written as a product of one natural number, two squares and three cubes in two ways ($10!=42\times5^2\times4^2\times3^3\times2^3\times1^3=21\times5^2\times2^2\times4^3\times3^3\times1^3$) whereas $20!$ can be given the same representation in $41680$ ways.

Let $F(n)$ denote the number of ways in which $n$ can be written as a product of one natural number, two squares, three cubes and four fourth powers.

You are given that $F(25!)=4933$, $F(100!) \bmod 1\,000\,000\,007=693\,952\,493$,

and $F(1\,000!) \bmod 1\,000\,000\,007=6\,364\,496$.

Find $F(1\,000\,000!) \bmod 1\,000\,000\,007$.",REDACTED
pe-637,"Given any positive integer $n$, we can construct a new integer by inserting plus signs between some of the digits of the base $B$ representation of $n$, and then carrying out the additions.

For example, from $n=123_{10}$  ($n$ in base $10$) we can construct the four base $10$ integers $123_{10}$,  $1+23=24_{10}$, $12+3=15_{10}$ and $1+2+3=6_{10}$.

Let $f(n,B)$ be the smallest number of steps needed to arrive at a single-digit number in base $B$. For example, $f(7,10)=0$ and $f(123,10)=1$.

Let $g(n,B_1,B_2)$ be the sum of the positive integers $i$ not exceeding $n$ such that $f(i,B_1)=f(i,B_2)$.

You are given $g(100,10,3)=3302$. 

Find $g(10^7,10,3)$.

Give your answer modulo $99991$.",REDACTED
pe-639,"A multiplicative function $f(x)$ is a function over positive integers satisfying $f(1)=1$ and $f(a b)=f(a) f(b)$ for any two coprime positive integers $a$ and $b$.

For integer $k$ let $f_k(n)$ be a multiplicative function additionally satisfying $f_k(p^e)=p^k$ for any prime $p$ and any integer $e&gt;0$.
 
For example, $f_1(2)=2$, $f_1(4)=2$, $f_1(18)=6$ and $f_2(18)=36$.

Let $\displaystyle S_k(n)=\sum_{i=1}^{n} f_k(i)$.
For example, $S_1(10)=41$, $S_1(100)=3512$, $S_2(100)=208090$, $S_1(10000)=35252550$ and $\displaystyle \sum_{k=1}^{3} S_k(10^{8}) \equiv 338787512 \pmod{ 1\,000\,000\,007}$.

Find $\displaystyle \sum_{k=1}^{50} S_k(10^{12}) \bmod 1\,000\,000\,007$.",REDACTED
pe-641,"Consider a row of $n$ dice all showing 1.

First turn every second die,$ (2,4,6,\ldots)$, so that the number showing is increased by 1. Then turn every third die. The sixth die will now show a 3. Then turn every fourth die and so on until every $n$th die (only the last die) is turned. If the die to be turned is showing a 6 then it is changed to show a 1.

Let $f(n)$ be the number of dice that are showing a 1 when the process finishes. You are given $f(100)=2$ and $f(10^8) = 69$.

Find $f(10^{36})$.

Give your answer modulo $99991$.",REDACTED
pe-642,"Let $f(n)$ be the largest prime factor of $n$ and $\displaystyle F(n) = \sum_{i=2}^n f(i)$.

For example $F(10)=32$, $F(100)=1915$ and $F(10000)=10118280$.

Find $F(201820182018)$. Give your answer modulus $10^9$.

Give your answer modulo $99991$.",REDACTED
pe-643,"Two positive integers $a$ and $b$ are $2$-friendly when $\gcd(a,b) = 2^t, t \gt 0$. For example, $24$ and $40$ are $2$-friendly because $\gcd(24,40) = 8 = 2^3$ while $24$ and $36$ are not because $\gcd(24,36) = 12 = 2^2\cdot 3$ is not a power of $2$.

Let $f(n)$ be the number of pairs, $(p,q)$, of positive integers with $1\le p\lt q\le n$ such that $p$ and $q$ are $2$-friendly. You are given $f(10^2) = 1031$ and $f(10^6) = 321418433$ modulo $1\,000\,000\,007$.

Find $f(10^{11})$ modulo $1\,000\,000\,007$.",REDACTED
pe-646,"Let $n$ be a natural number and  $p_1^{\alpha_1}\cdot p_2^{\alpha_2}\cdots p_k^{\alpha_k}$ its prime factorisation.

Define the Liouville function $\lambda(n)$ as $\lambda(n) = (-1)^{\sum\limits_{i=1}^{k}\alpha_i}$.

(i.e. $-1$ if the sum of the exponents $\alpha_i$ is odd and $1$ if the sum of the exponents is even. )

Let $S(n,L,H)$  be the sum $\lambda(d) \cdot d$ over all divisors $d$ of $n$ for which $L \leq d \leq H$.

You are given:

- $S(10! , 100, 1000) = 1457$

- $S(15!,  10^3, 10^5) = -107974$

- $S(30!,10^8, 10^{12}) = 9766732243224$.

Find $S(70!,10^{20}, 10^{60})$ and give your answer modulo $1\,000\,000\,007$.",REDACTED
pe-647,"It is possible to find positive integers $A$ and $B$ such that given any triangular number, $T_n$, then $AT_n +B$ is always a triangular number. We define $F_3(N)$ to be the sum of $(A+B)$ over all such possible pairs $(A,B)$ with $\max(A,B)\le N$. For example $F_3(100) = 184$.

Polygonal numbers are generalisations of triangular numbers. Polygonal numbers with parameter $k$ we call $k$-gonal numbers. The formula for the $n$th $k$-gonal number is $\frac 12n\big(n(k-2)+4-k\big)$ where $n \ge 1$. For example when $k = 3$ we get $\frac 12n(n+1)$ the formula for triangular numbers.

The statement above is true for pentagonal, heptagonal and in fact any $k$-gonal number with $k$ odd. For example when $k=5$ we get the pentagonal numbers and we can find positive integers $A$ and $B$ such that given any pentagonal number, $P_n$, then $AP_n+B$ is always a pentagonal number. We define $F_5(N)$ to be the sum of $(A+B)$ over all such possible pairs $(A,B)$ with $\max(A,B)\le N$.

Similarly we define $F_k(N)$ for odd $k$. You are given $\sum_{k} F_k(10^3) = 14993$ where the sum is over all odd $k = 3,5,7,\ldots$.

Find $\sum_{k} F_k(10^{12})$ where the sum is over all odd $k = 3,5,7,\ldots$

Give your answer modulo $99991$.",REDACTED
pe-648,"For some fixed $\rho \in [0, 1]$, we begin a sum $s$ at $0$ and repeatedly apply a process: With probability $\rho$, we add $1$ to $s$, otherwise we add $2$ to $s$.

The process ends when either $s$ is a perfect square or $s$ exceeds $10^{18}$, whichever occurs first. For example, if $s$ goes through $0, 2, 3, 5, 7, 9$, the process ends at $s=9$, and two squares $1$ and $4$ were skipped over.

Let $f(\rho)$ be the expected number of perfect squares skipped over when the process finishes.

It can be shown that the power series for $f(\rho)$ is $\sum_{k=0}^\infty a_k \rho^k$ for a suitable (unique) choice of coefficients $a_k$. Some of the first few coefficients are $a_0=1$, $a_1=0$, $a_5=-18$, $a_{10}=45176$.

Let $F(n) = \sum_{k=0}^n a_k$. You are given that $F(10) = 53964$ and $F(50) \equiv 842418857 \pmod{10^9}$.

Find $F(1000)$, and give your answer modulo $10^9$.",REDACTED
pe-649,"Alice and Bob are taking turns playing a game consisting of $c$ different coins on a chessboard of size $n$ by $n$.

The game may start with any arrangement of $c$ coins in squares on the board. It is possible at any time for more than one coin to occupy the same square on the board at the same time. The coins are distinguishable, so swapping two coins gives a different arrangement if (and only if) they are on different squares.

On a given turn, the player must choose a coin and move it either left or up $2$, $3$, $5$, or $7$ spaces in a single direction. The only restriction is that the coin cannot move off the edge of the board.

The game ends when a player is unable to make a valid move, thereby granting the other player the victory.

Assuming that Alice goes first and that both players are playing optimally, let $M(n, c)$ be the number of possible starting arrangements for which Alice can ensure her victory, given a board of size $n$ by $n$ with $c$ distinct coins.

For example, $M(3, 1) = 4$, $M(3, 2) = 40$, and $M(9, 3) = 450304$.

What are the last $9$ digits of $M(10\,000\,019, 100)$?",REDACTED
pe-650,"Let $B(n) = \displaystyle \prod_{k=0}^n {n \choose k}$, a product of binomial coefficients.

For example, $B(5) = {5 \choose 0} \times {5 \choose 1} \times {5 \choose 2}  \times {5 \choose 3} \times {5 \choose 4} \times {5 \choose 5} = 1 \times 5 \times 10 \times 10 \times 5 \times 1 = 2500$.

Let $D(n) = \displaystyle \sum_{d|B(n)} d$, the sum of the divisors of $B(n)$.

For example, the divisors of B(5) are 1, 2, 4, 5, 10, 20, 25, 50, 100, 125, 250, 500, 625, 1250 and 2500,

so D(5) = 1 + 2 + 4 + 5 + 10 + 20 + 25 + 50 + 100 + 125 + 250 + 500 + 625 + 1250 + 2500 = 5467.

Let $S(n) = \displaystyle \sum_{k=1}^n D(k)$.

You are given $S(5) = 5736$, $S(10) = 141740594713218418$ and $S(100)$ mod $1\,000\,000\,007 = 332792866$.

Find $S(20\,000)$ mod $1\,000\,000\,007$.",REDACTED
pe-651,"An infinitely long cylinder has its curved surface fully covered with different coloured but otherwise identical rectangular stickers, without overlapping. The stickers are aligned with the cylinder, so two of their edges are parallel with the cylinder's axis, with four stickers meeting at each corner.

Let $a&gt;0$ and suppose that the colouring is periodic along the cylinder, with the pattern repeating every $a$ stickers. (The period is allowed to be any divisor of $a$.) Let $b$ be the number of stickers that fit round the circumference of the cylinder.

Let $f(m, a, b)$ be the number of different such periodic patterns that use exactly $m$ distinct colours of stickers. Translations along the axis, reflections in any plane, rotations in any axis, (or combinations of such operations) applied to a pattern are to be counted as the same as the original pattern.

You are given that $f(2, 2, 3) = 11$, $f(3, 2, 3) = 56$, and $f(2, 3, 4) = 156$.
Furthermore, $f(8, 13, 21) \equiv 49718354 \pmod{1\,000\,000\,007}$,
and $f(13, 144, 233) \equiv 907081451 \pmod{1\,000\,000\,007}$.

Find $\sum_{i=4}^{40} f(i, F_{i-1}, F_i) \bmod 1\,000\,000\,007$, where $F_i$ are the Fibonacci numbers starting at $F_0=0$, $F_1=1$.",REDACTED
pe-652,"Consider the values of $\log_2(8)$, $\log_4(64)$ and $\log_3(27)$. All three are equal to $3$.

Generally, the function $f(m,n)=\log_m(n)$ over integers $m,n \ge 2$ has the property that 

$f(m_1,n_1)=f(m_2,n_2)$ if

- $\, m_1=a^e, n_1=a^f, m_2=b^e,n_2=b^f \,$ for some integers $a,b,e,f \, \,$ or 

-  $ \, m_1=a^e, n_1=b^e, m_2=a^f,n_2=b^f \,$ for some integers $a,b,e,f \,$ 

We call a function $g(m,n)$ over integers $m,n \ge 2$ proto-logarithmic  if 

- $\quad  \, \, \, \, g(m_1,n_1)=g(m_2,n_2)$ if any integers $a,b,e,f$ fulfilling 1. or 2. can be found

- and $\, g(m_1,n_1) \ne g(m_2,n_2)$ if no integers $a,b,e,f$ fulfilling 1. or 2. can be found.

Let $D(N)$ be the number of distinct values that any proto-logarithmic function $g(m,n)$ attains over $2\le m, n\le N$.

For example, $D(5)=13$, $D(10)=69$, $D(100)=9607$ and $D(10000)=99959605$.

Find $D(10^{18})$, and give the last $9$ digits as answer.

Note: According to the four exponentials conjecture the function $\log_m(n)$ is proto-logarithmic.
 While this conjecture is yet unproven in general, $\log_m(n)$ can be used to calculate $D(N)$ for small values of $N$.",REDACTED
pe-653,"Consider a horizontal frictionless tube with length $L$ millimetres, and a diameter of 20 millimetres. The east end of the tube is open, while the west end is sealed. The tube contains $N$ marbles of diameter 20 millimetres at designated starting locations, each one initially moving either westward or eastward with common speed $v$.

Since there are marbles moving in opposite directions, there are bound to be some collisions. We assume that the collisions are perfectly elastic, so both marbles involved instantly change direction and continue with speed $v$ away from the collision site. Similarly, if the west-most marble collides with the sealed end of the tube, it instantly changes direction and continues eastward at speed $v$. On the other hand, once a marble reaches the unsealed east end, it exits the tube and has no further interaction with the remaining marbles.

To obtain the starting positions and initial directions, we use the pseudo-random sequence $r_j$ defined by:

$r_1 = 6\,563\,116$

$r_{j+1} = r_j^2 \bmod 32\,745\,673$

The west-most marble is initially positioned with a gap of $(r_1 \bmod 1000) + 1$ millimetres between it and the sealed end of the tube, measured from the west-most point of the surface of the marble. Then, for $2\le j\le N$, counting from the west, the gap between the $(j-1)$th and $j$th marbles, as measured from their closest points, is given by $(r_j \bmod 1000) + 1$ millimetres.
Furthermore, the $j$th marble is initially moving eastward if $r_j \le 10\,000\,000$, and westward if $r_j &gt; 10\,000\,000$.

For example, with $N=3$, the sequence specifies gaps of 117, 432, and 173 millimetres. The marbles' centres are therefore 127, 579, and 772 millimetres from the sealed west end of the tube. The west-most marble initially moves eastward, while the other two initially move westward.

Under this setup, and with a five metre tube ($L=5000$), it turns out that the middle (second) marble travels 5519 millimetres before its centre reaches the east-most end of the tube.

Let $d(L, N, j)$ be the distance in millimetres that the $j$th marble travels before its centre reaches the eastern end of the tube. So $d(5000, 3, 2) = 5519$. You are also given that $d(10\,000, 11, 6) = 11\,780$ and $d(100\,000, 101, 51) = 114\,101$.

Find $d(1\,000\,000\,000, 1\,000\,001, 500\,001)$.",REDACTED
pe-654,"Let $T(n, m)$ be the number of $m$-tuples of positive integers such that the sum of any two neighbouring elements of the tuple is $\le n$.

For example, $T(3, 4)=8$, via the following eight $4$-tuples:

$(1, 1, 1, 1)$

$(1, 1, 1, 2)$

$(1, 1, 2, 1)$

$(1, 2, 1, 1)$

$(1, 2, 1, 2)$

$(2, 1, 1, 1)$

$(2, 1, 1, 2)$

$(2, 1, 2, 1)$

You are also given that $T(5, 5)=246$, $T(10, 10^{2}) \equiv 862820094 \pmod{1\,000\,000\,007}$ and  $T(10^2, 10) \equiv 782136797 \pmod{1\,000\,000\,007}$.

Find $T(5000, 10^{12}) \bmod 1\,000\,000\,007$.",REDACTED
pe-655,"The numbers $545$, $5\,995$ and $15\,151$ are the three smallest palindromes divisible by $109$. There are nine palindromes less than $100\,000$ which are divisible by $109$.

How many palindromes less than $10^{32}$ are divisible by $10\,000\,019\,$ ?

Give your answer modulo $99991$.",REDACTED
pe-656,"Given an irrational number $\alpha$, let $S_\alpha(n)$ be the sequence $S_\alpha(n)=\lfloor {\alpha \cdot n} \rfloor - \lfloor {\alpha \cdot (n-1)} \rfloor$ for $n \ge 1$.
 
($\lfloor \cdots \rfloor$ is the floor-function.)

It can be proven that for any irrational $\alpha$ there exist infinitely many values of $n$ such that the subsequence $ \{S_\alpha(1),S_\alpha(2)...S_\alpha(n) \} $ is palindromic.

The first $20$ values of $n$ that give a palindromic subsequence for $\alpha = \sqrt{31}$ are:
$1$, $3$, $5$, $7$, $44$, $81$, $118$, $273$, $3158$, $9201$, $15244$, $21287$, $133765$, $246243$, $358721$, $829920$, $9600319$, $27971037$, $46341755$, $64712473$.

Let $H_g(\alpha)$ be the sum of the first $g$ values of $n$  for which the corresponding subsequence is palindromic.

So $H_{20}(\sqrt{31})=150243655$.

Let $T=\{2,3,5,6,7,8,10,\dots,1000\}$ be the set of positive integers, not exceeding $1000$, excluding perfect squares.

Calculate the sum of $H_{100}(\sqrt \beta)$ for  $\beta \in T$. Give the last $15$ digits of your answer.",REDACTED
pe-657,"In the context of formal languages, any finite sequence of letters of a given alphabet $\Sigma$ is called a word over $\Sigma$. We call a word incomplete if it does not contain every letter of $\Sigma$.

For example, using the alphabet $\Sigma=\{ a, b, c\}$, '$ab$', '$abab$' and '$\,$' (the empty word) are incomplete words over $\Sigma$, while '$abac$' is a complete word over $\Sigma$.

Given an alphabet $\Sigma$ of $\alpha$ letters, we define $I(\alpha,n)$ to be the number of incomplete words over $\Sigma$ with a length not exceeding $n$. 

For example, $I(3,0)=1$, $I(3,2)=13$ and $I(3,4)=79$.

Find $I(10^7,10^{12})$. Give your answer modulo $1\,000\,000\,007$.",REDACTED
pe-658,"In the context of formal languages, any finite sequence of letters of a given alphabet $\Sigma$ is called a word over $\Sigma$. We call a word incomplete if it does not contain every letter of $\Sigma$.

For example, using the alphabet $\Sigma=\{ a, b, c\}$, '$ab$', '$abab$' and '$\,$' (the empty word) are incomplete words over $\Sigma$, while '$abac$' is a complete word over $\Sigma$.

Given an alphabet $\Sigma$ of $\alpha$ letters, we define $I(\alpha,n)$ to be the number of incomplete words over $\Sigma$ with a length not exceeding $n$. 

For example, $I(3,0)=1$, $I(3,2)=13$ and $I(3,4)=79$.

Let $\displaystyle S(k,n)=\sum_{\alpha=1}^k I(\alpha,n)$.

For example, $S(4,4)=406$, $S(8,8)=27902680$ and $S (10,100) \equiv 983602076 \bmod 1\,000\,000\,007$.

Find $S(10^7,10^{12})$. Give your answer modulo $1\,000\,000\,007$.",REDACTED
pe-659,"Consider the sequence  $n^2+3$ with $n \ge 1$. 
 
If we write down the first terms of this sequence we get:

$4, 7, 12, 19, 28, 39, 52, 67, 84, 103, 124, 147, 172, 199, 228, 259, 292, 327, 364, \dots$ .

We see that the terms for $n=6$ and $n=7$ ($39$ and $52$) are both divisible by $13$.

In fact $13$ is the largest prime dividing any two successive terms of this sequence.

Let $P(k)$ be the largest prime  that divides any two successive terms of the sequence $n^2+k^2$.

Find the last $18$ digits of $\displaystyle \sum_{k=1}^{10\,000\,000} P(k)$.",REDACTED
pe-660,"We call an integer sided triangle $n$-pandigital if it contains one angle of $120$ degrees and, when the sides of the triangle are written in base $n$, together they use all $n$ digits of that base exactly once.

For example, the triangle $(217, 248, 403)$ is $9$-pandigital because it contains one angle of $120$ degrees and the sides written in base $9$ are $261_9, 305_9, 487_9$ using each of the $9$ digits of that base once.

Find the sum of the largest sides of all $n$-pandigital triangles with $9 \le n \le 18$.

Give your answer modulo $99991$.",REDACTED
pe-663,"Let $t_k$ be the tribonacci numbers defined as: 

$\quad t_0 = t_1 = 0$;

$\quad t_2 = 1$; 

$\quad t_k = t_{k-1} + t_{k-2} + t_{k-3} \quad \text{   for   }  k \ge 3$.

For a given integer $n$, let $A_n$ be an array of length $n$ (indexed from $0$ to $n-1$), that is initially filled with zeros.

The array is changed iteratively by replacing $A_n[(t_{2 i-2} \bmod n)]$ with $A_n[(t_{2 i-2} \bmod n)]+2 (t_{2 i-1} \bmod n)-n+1$ in each step $i$.
 
After each step $i$, define $M_n(i)$ to be $\displaystyle \max\{\sum_{j=p}^q A_n[j]: 0\le p\le q \lt n\}$, the maximal sum of any contiguous subarray of $A_n$. 

The first 6 steps for $n=5$ are illustrated below:

Initial state: $\, A_5=\{0,0,0,0,0\}$

Step 1: $\quad \Rightarrow A_5=\{-4,0,0,0,0\}$, $M_5(1)=0$

Step 2: $\quad \Rightarrow A_5=\{-4, -2, 0, 0, 0\}$, $M_5(2)=0$

Step 3: $\quad \Rightarrow A_5=\{-4, -2, 4, 0, 0\}$, $M_5(3)=4$

Step 4: $\quad \Rightarrow A_5=\{-4, -2, 6, 0, 0\}$, $M_5(4)=6$

Step 5: $\quad \Rightarrow A_5=\{-4, -2, 6, 0, 4\}$, $M_5(5)=10$

Step 6: $\quad \Rightarrow A_5=\{-4, 2, 6, 0, 4\}$, $M_5(6)=12$

Let $\displaystyle S(n,l)=\sum_{i=1}^l M_n(i)$. Thus $S(5,6)=32$.

You are given $S(5,100)=2416$, $S(14,100)=3881$ and $S(107,1000)=1618572$.

Find $S(10\,000\,003,10\,200\,000)-S(10\,000\,003,10\,000\,000)$.",REDACTED
pe-665,"Two players play a game with two piles of stones, alternating turns.

On each turn, the corresponding player chooses a positive integer $n$ and does one of the following:

- removes $n$ stones from one pile;

- removes $n$ stones from both piles; or

- removes $n$ stones from one pile and $2n$ stones from the other pile.

The player who removes the last stone wins.

We denote by $(n,m)$ the position in which the piles have $n$ and $m$ stones remaining. Note that $(n,m)$ is considered to be the same position as $(m,n)$.

Then, for example, if the position is $(2,6)$, the next player may reach the following positions:

$(0,2)$, $(0,4)$, $(0,5)$, $(0,6)$, $(1,2)$, $(1,4)$, $(1,5)$, $(1,6)$, $(2,2)$, $(2,3)$, $(2,4)$, $(2,5)$

A position is a losing position if the player to move next cannot force a win. For example, $(1,3)$, $(2,6)$, $(4,5)$ are the first few losing positions.

Let $f(M)$ be the sum of $n+m$ for all losing positions $(n,m)$ with $n\le m$ and $n+m \le M$. For example, $f(10) = 21$, by considering the losing positions $(1,3)$, $(2,6)$, $(4,5)$.

You are given that $f(100) = 1164$ and $f(1000) = 117002$.

Find $f(10^7)$.

Give your answer modulo $99991$.",REDACTED
pe-668,"A positive integer is called square root smooth if all of its prime factors are strictly less than its square root.

Including the number $1$, there are $29$ square root smooth numbers not exceeding $100$.

How many square root smooth numbers are there not exceeding $10\,000\,000\,000$?

Give your answer modulo $99991$.",REDACTED
pe-672,"Consider the following process that can be applied recursively to any positive integer $n$:

- if $n = 1$ do nothing and the process stops,

- if $n$ is divisible by $7$ divide it by $7$,

- otherwise add $1$.

Define $g(n)$ to be the number of $1$'s that must be added before the process ends. For example:

$125\xrightarrow{\scriptsize{+1}} 126\xrightarrow{\scriptsize{\div 7}} 18\xrightarrow{\scriptsize{+1}} 19\xrightarrow{\scriptsize{+1}} 20\xrightarrow{\scriptsize{+1}} 21\xrightarrow{\scriptsize{\div 7}} 3\xrightarrow{\scriptsize{+1}} 4\xrightarrow{\scriptsize{+1}} 5\xrightarrow{\scriptsize{+1}} 6\xrightarrow{\scriptsize{+1}} 7\xrightarrow{\scriptsize{\div 7}} 1$.

Eight $1$'s are added so $g(125) = 8$. Similarly $g(1000) = 9$ and $g(10000) = 21$.

Define $S(N) = \sum_{n=1}^N g(n)$ and $H(K) = S\left(\frac{7^K-1}{11}\right)$. You are given $H(10) = 690409338$.

Find $H(10^9)$ modulo $1\,117\,117\,717$.",REDACTED
pe-675,"Let $\omega(n)$ denote the number of distinct prime divisors of a positive integer $n$.

So  $\omega(1) = 0$ and  $\omega(360) = \omega(2^{3} \times 3^{2} \times 5) = 3$.

Let $S(n)$ be $ \sum_{d \mid n} 2^{\omega(d)}  $.

E.g. $S(6) = 2^{\omega(1)}+2^{\omega(2)}+2^{\omega(3)}+2^{\omega(6)} = 2^0+2^1+2^1+2^2 = 9$.

Let $F(n)=\sum_{i=2}^n S(i!)$.
$F(10)=4821.$

Find $F(10\,000\,000)$. Give your answer modulo  $1\,000\,000\,087$.",REDACTED
pe-676,"Let $d(i,b)$ be the digit sum of the number $i$ in base $b$. For example $d(9,2)=2$, since $9=1001_2$.
When using different bases, the respective digit sums most of the time deviate from each other, for example $d(9,4)=3 \ne d(9,2)$.

However, for some numbers $i$ there will be a match, like $d(17,4)=d(17,2)=2$.
Let $ M(n,b_1,b_2)$ be the sum of all natural numbers $i \le n$ for which $d(i,b_1)=d(i,b_2)$.
For example, $M(10,8,2)=18$, $M(100,8,2)=292$ and $M(10^6,8,2)=19173952$.

Find $\displaystyle \sum_{k=3}^6 \sum_{l=1}^{k-2}M(10^{16},2^k,2^l)$, giving the last $16$ digits as the answer.",REDACTED
pe-677,"Let $g(n)$ be the number of undirected graphs with $n$ nodes satisfying the following properties:

- The graph is connected and has no cycles or multiple edges.

- Each node is either red, blue, or yellow.

- A red node may have no more than 4 edges connected to it.

- A blue or yellow node may have no more than 3 edges connected to it.

- An edge may not directly connect a yellow node to a yellow node.

For example, $g(2)=5$, $g(3)=15$, and $g(4) = 57$.

You are also given that $g(10) = 710249$ and $g(100) \equiv 919747298 \pmod{1\,000\,000\,007}$.

Find $g(10\,000) \bmod 1\,000\,000\,007$.",REDACTED
pe-678,"If a triple of positive integers $(a, b, c)$ satisfies $a^2+b^2=c^2$, it is called a Pythagorean triple. No triple $(a, b, c)$ satisfies $a^e+b^e=c^e$ when  $e \ge 3$ (Fermat's Last Theorem). However, if the exponents of the left-hand side and right-hand side differ, this is not true. For example, $3^3+6^3=3^5$.

Let $a, b, c, e, f$ be all positive integers, $0 \lt a \lt b$, $e \ge 2$, $f \ge 3$ and $c^f \le N$. Let $F(N)$ be the number of $(a, b, c, e, f)$ such that $a^e+b^e=c^f$. You are given $F(10^3) = 7$, $F(10^5) = 53$ and $F(10^7) = 287$.

Find $F(10^{18})$.

Give your answer modulo $99991$.",REDACTED
pe-679,"Let $S$ be the set consisting of the four letters $\{\texttt{`A'},\texttt{`E'},\texttt{`F'},\texttt{`R'}\}$.

For $n\ge 0$, let $S^*(n)$ denote the set of words of length $n$ consisting of letters belonging to $S$.

We designate the words $\texttt{FREE}, \texttt{FARE}, \texttt{AREA}, \texttt{REEF}$ as keywords.

Let $f(n)$ be the number of words in $S^*(n)$ that contains all four keywords exactly once.

This first happens for $n=9$, and indeed there is a unique 9 lettered word that contain each of the keywords once: $\texttt{FREEFAREA}$

So, $f(9)=1$.

You are also given that $f(15)=72863$.

Find $f(30)$.

Give your answer modulo $99991$.",REDACTED
pe-680,"Let $N$ and $K$ be two positive integers.

$F_n$ is the $n$-th Fibonacci number: $F_1 = F_2 = 1$, $F_n = F_{n - 1} + F_{n - 2}$ for all $n \geq 3$.

Let $s_n = F_{2n - 1} \bmod N$ and let $t_n = F_{2n} \bmod N$.

Start with an array of integers $A = (A[0], \cdots, A[N - 1])$ where initially every $A\text{[}i]$ is equal to $i$.
Now perform $K$ successive operations on $A$, where the $j$-th operation consists of reversing the order of those elements in $A$ with indices between $s_j$ and $t_j$ (both ends inclusive).

Define $R(N,K)$ to be $\sum_{i = 0}^{N - 1}i \times A\text {[}i]$ after $K$ operations.

For example, $R(5, 4) = 27$, as can be seen from the following procedure:

Initial position: $(0, 1, 2, 3, 4)$

Step 1 - Reverse $A[1]$ to $A[1]$: $(0, 1, 2, 3, 4)$

Step 2 - Reverse $A[2]$ to $A[3]$: $(0, 1, 3, 2, 4)$

Step 3 - Reverse $A[0]$ to $A[3]$: $(2, 3, 1, 0, 4)$

Step 4 - Reverse $A[3]$ to $A[1]$: $(2, 0, 1, 3, 4)$

$R(5, 4) = 0 \times 2 + 1 \times 0 + 2 \times 1 + 3 \times 3 + 4 \times 4 = 27$

Also, $R(10^2, 10^2) = 246597$ and $R(10^4, 10^4) = 249275481640$.

Find $R(10^{18}, 10^6)$ giving your answer modulo $10^9$.",REDACTED
pe-681,"Given positive integers $a \le b \le c \le d$, it may be possible to form quadrilaterals with edge lengths $a,b,c,d$ (in any order). When this is the case, let $M(a,b,c,d)$ denote the maximal area of such a quadrilateral.
 For example, $M(2,2,3,3)=6$, attained e.g. by a $2\times 3$ rectangle.

Let $SP(n)$ be the sum of $a+b+c+d$ over all choices $a \le b \le c \le d$ for which $M(a,b,c,d)$ is a positive integer not exceeding $n$.

$SP(10)=186$ and $SP(100)=23238$.

Find $SP(1\,000\,000)$.

Give your answer modulo $99991$.",REDACTED
pe-682,"$5$-smooth numbers are numbers whose largest prime factor doesn't exceed $5$.

$5$-smooth numbers are also called Hamming numbers.

Let $\Omega(a)$ be the count of prime factors of $a$ (counted with multiplicity).

Let $s(a)$ be the sum of the prime factors of $a$ (with multiplicity).

For example, $\Omega(300) = 5$ and $s(300) = 2+2+3+5+5 = 17$.

Let $f(n)$ be the number of pairs, $(p,q)$, of Hamming numbers such that $\Omega(p)=\Omega(q)$ and $s(p)+s(q)=n$.

You are given $f(10)=4$ (the pairs are $(4,9),(5,5),(6,6),(9,4)$) and $f(10^2)=3629$.

Find $f(10^7) \bmod 1\,000\,000\,007$.",REDACTED
pe-684,"Define $s(n)$ to be the smallest number that has a digit sum of $n$. For example $s(10) = 19$.

Let $\displaystyle S(k) = \sum_{n=1}^k s(n)$. You are given $S(20) = 1074$.

Further let $f_i$ be the Fibonacci sequence defined by $f_0=0, f_1=1$ and $f_i=f_{i-2}+f_{i-1}$ for all $i \ge 2$.

Find $\displaystyle \sum_{i=2}^{90} S(f_i)$. Give your answer modulo $1\,000\,000\,007$.",REDACTED
pe-685,"Writing down the numbers which have a digit sum of 10 in ascending order, we get:
$19, 28, 37, 46,55,64,73,82,91,109, 118,\dots$

Let $f(n,m)$ be the $m^{\text{th}}$ occurrence of the digit sum $n$. For example, $f(10,1)=19$, $f(10,10)=109$ and $f(10,100)=1423$.

Let $\displaystyle S(k)=\sum_{n=1}^k f(n^3,n^4)$. For example $S(3)=7128$ and $S(10)\equiv 32287064 \mod 1\,000\,000\,007$.

Find $S(10\,000)$ modulo $1\,000\,000\,007$.",REDACTED
pe-686,"$2^7=128$ is the first power of two whose leading digits are ""12"".

The next power of two whose leading digits are ""12"" is $2^{80}$.

Define $p(L, n)$ to be the $n$th-smallest value of $j$ such that the base 10 representation of $2^j$ begins with the digits of $L$.

So $p(12, 1) = 7$ and $p(12, 2) = 80$.

You are also given that $p(123, 45) = 12710$.

Find $p(123, 678910)$.

Give your answer modulo $99991$.",REDACTED
pe-688,"We stack $n$ plates into $k$ non-empty piles where each pile is a different size. Define $f(n,k)$ to be the maximum number of plates possible in the smallest pile. For example when $n = 10$ and $k = 3$ the piles $2,3,5$ is the best that can be done and so $f(10,3) = 2$. It is impossible to divide 10 into 5 non-empty differently-sized piles and hence $f(10,5) = 0$.

Define $F(n)$ to be the sum of $f(n,k)$ for all possible pile sizes $k\ge 1$. For example $F(100) = 275$.

Further define $S(N) = \displaystyle\sum_{n=1}^N F(n)$. You are given $S(100) = 12656$.

Find $S(10^{16})$ giving your answer modulo $1\,000\,000\,007$.",REDACTED
pe-691,"Given a character string $s$, we define $L(k,s)$ to be the length of the longest substring of $s$ which appears at least $k$ times in $s$, or $0$ if such a substring does not exist. For example, $L(3,\text{“bbabcabcabcacba”})=4$ because of the three occurrences of the substring $\text{“abca”}$, and $L(2,\text{“bbabcabcabcacba”})=7$ because of the repeated substring $\text{“abcabca”}$. Note that the occurrences can overlap.

Let $a_n$, $b_n$ and $c_n$ be the $0/1$ sequences defined by:

- $a_0 = 0$

- $a_{2n} = a_{n}$

- $a_{2n+1} = 1-a_{n}$

- $b_n = \lfloor\frac{n+1}{\varphi}\rfloor - \lfloor\frac{n}{\varphi}\rfloor$ (where $\varphi$ is the golden ratio)

- $c_n = a_n + b_n - 2a_nb_n$

and $S_n$ the character string $c_0\ldots c_{n-1}$. You are given that $L(2,S_{10})=5$, $L(3,S_{10})=2$, $L(2,S_{100})=14$, $L(4,S_{100})=6$, $L(2,S_{1000})=86$, $L(3,S_{1000}) = 45$, $L(5,S_{1000}) = 31$, and that the sum of non-zero $L(k,S_{1000})$ for $k\ge 1$ is $2460$.

Find the sum of non-zero $L(k,S_{5000000})$ for $k\ge 1$.

Give your answer modulo $99991$.",REDACTED
pe-692,"Siegbert and Jo take turns playing a game with a heap of $N$ pebbles:

1. Siegbert is the first to take some pebbles. He can take as many pebbles as he wants. (Between 1 and $N$ inclusive.)

2. In each of the following turns the current player must take at least one pebble and at most twice the amount of pebbles taken by the previous player.

3. The player who takes the last pebble wins.

Although Siegbert can always win by taking all the pebbles on his first turn, to make the game more interesting he chooses to take the smallest number of pebbles that guarantees he will still win (assuming both Siegbert and Jo play optimally for the rest of the game).

Let $H(N)$ be that minimal amount for a heap of $N$ pebbles.

$H(1)=1$, $H(4)=1$, $H(17)=1$, $H(8)=8$ and $H(18)=5$ .

Let $G(n)$ be $\displaystyle{\sum_{k=1}^n H(k)}$.

$G(13)=43$.

Find $G(23416728348467685)$.

Give your answer modulo $99991$.",REDACTED
pe-693,"Two positive integers $x$ and $y$ ($x &gt; y$) can generate a sequence in the following manner:

- $a_x = y$ is the first term,

- $a_{z+1} = a_z^2 \bmod z$ for $z = x, x+1,x+2,\ldots$ and

- the generation stops when a term becomes $0$ or $1$.

The number of terms in this sequence is denoted $l(x,y)$.

For example, with $x = 5$ and $y = 3$, we get $a_5 = 3$, $a_6 = 3^2 \bmod 5 = 4$, $a_7 = 4^2\bmod 6 = 4$, etc. Giving the sequence of 29 terms:

$	3,4,4,2,4,7,9,4,4,3,9,6,4,16,4,16,16,4,16,3,9,6,10,19,25,16,16,8,0		$

Hence $l(5,3) = 29$.

$g(x)$ is defined  to be the maximum value of $l(x,y)$ for $y \lt x$. For example, $g(5) = 29$.

Further, define $f(n)$ to be the maximum value of $g(x)$ for $x \le n$. For example, $f(100) = 145$ and $f(10\,000) = 8824$.

Find $f(3\,000\,000)$.",REDACTED
pe-694,"A positive integer $n$ is considered cube-full, if for every prime $p$ that divides $n$, so does $p^3$. Note that $1$ is considered cube-full.

Let $s(n)$ be the function that counts the number of cube-full divisors of $n$. For example, $1$, $8$ and $16$ are the three cube-full divisors of $16$. Therefore, $s(16)=3$.

Let $S(n)$ represent the summatory function of $s(n)$, that is $S(n)=\displaystyle\sum_{i=1}^n s(i)$.

You are given $S(16) = 19$, $S(100) = 126$ and $S(10000) = 13344$.

Find $S(10^{18})$.

Give your answer modulo $99991$.",REDACTED
pe-698,"We define 123-numbers as follows:

- 1 is the smallest 123-number.

- When written in base 10 the only digits that can be present are ""1"", ""2"" and ""3"" and if present the number of times they each occur is also a 123-number.

So 2 is a 123-number, since it consists of one  digit ""2"" and 1 is a 123-number. Therefore, 33 is a 123-number as well since it consists of two digits ""3"" and 2 is a 123-number.

On the other hand, 1111 is not a 123-number, since it contains 4 digits ""1"" and 4 is not a 123-number.

In ascending order, the first 123-numbers are:

$1, 2, 3, 11, 12, 13, 21, 22, 23, 31, 32, 33, 111, 112, 113, 121, 122, 123, 131, \ldots$

Let $F(n)$ be the $n$-th 123-number. For example $F(4)=11$, $F(10)=31$, $F(40)=1112$, $F(1000)=1223321$ and $F(6000)= 2333333333323$.

Find $F(111\,111\,111\,111\,222\,333)$. Give your answer modulo $123\,123\,123$.",REDACTED
pe-699,"Let $\sigma(n)$ be the sum of all the divisors of the positive integer $n$, for example:

$\sigma(10) = 1+2+5+10 = 18$.

Define $T(N)$ to be the sum of all numbers $n \le N$ such that when the fraction $\frac{\sigma(n)}{n}$ is written in its lowest form $\frac ab$, the denominator is a power of 3 i.e. $b = 3^k, k &gt; 0$.

You are given $T(100) = 270$ and $T(10^6) = 26089287$.

Find $T(10^{14})$.

Give your answer modulo $99991$.",REDACTED
pe-700,"Leonhard Euler was born on 15 April 1707.

Consider the sequence 1504170715041707n mod 4503599627370517.

An element of this sequence is defined to be an Eulercoin if it is strictly smaller than all previously found Eulercoins.

For example, the first term is 1504170715041707 which is the first Eulercoin.  The second term is 3008341430083414 which is greater than 1504170715041707 so is not an Eulercoin.  However, the third term is 8912517754604 which is small enough to be a new Eulercoin.

The sum of the first 2 Eulercoins is therefore 1513083232796311.

Find the sum of all Eulercoins.",REDACTED
pe-703,"Given an integer $n$, $n \geq 3$, let $B=\{\mathrm{false},\mathrm{true}\}$ and let $B^n$ be the set of sequences of $n$ values from $B$. The function $f$ from $B^n$ to $B^n$ is defined by $f(b_1 \dots b_n) = c_1 \dots c_n$ where:

- $c_i = b_{i+1}$ for $1 \leq i &lt; n$.

- $c_n = b_1 \;\mathrm{AND}\; (b_2 \;\mathrm{XOR}\; b_3)$, where $\mathrm{AND}$ and $\mathrm{XOR}$ are the logical $\mathrm{AND}$ and exclusive $\mathrm{OR}$ operations.

Let $S(n)$ be the number of functions $T$ from $B^n$ to $B$ such that for all $x$ in $B^n$, $T(x) ~\mathrm{AND}~ T(f(x)) = \mathrm{false}$.
You are given that $S(3) = 35$ and $S(4) = 2118$.

Find $S(20)$. Give your answer modulo $1\,001\,001\,011$.",REDACTED
pe-704,"Define $g(n, m)$ to be the largest integer $k$ such that $2^k$ divides $\binom{n}m$. 
For example, $\binom{12}5 = 792 = 2^3 \cdot 3^2 \cdot 11$, hence $g(12, 5) = 3$. 
Then define $F(n) = \max \{ g(n, m) : 0 \le m \le n \}$. $F(10) = 3$ and $F(100) = 6$.

Let $S(N)$ = $\displaystyle\sum_{n=1}^N{F(n)}$. You are given that $S(100) = 389$ and $S(10^7) = 203222840$.

Find $S(10^{16})$.

Give your answer modulo $99991$.",REDACTED
pe-705,"The inversion count of a sequence of digits is the smallest number of adjacent pairs that must be swapped to sort the sequence.

For example, $34214$ has inversion count of $5$:
$34214 \to 32414 \to 23414 \to 23144 \to 21344 \to12344$.

If each digit of a sequence is replaced by one of its divisors a divided sequence is obtained. 

For example, the sequence $332$ has $8$ divided sequences: $\{332,331,312,311,132,131,112,111\}$.

Define $G(N)$ to be the concatenation of all primes less than $N$, ignoring any zero digit. 

For example, $G(20) = 235711131719$.

Define $F(N)$ to be the sum of the inversion count for all possible divided sequences from the master sequence $G(N)$. 

You are given $F(20) = 3312$ and $F(50) = 338079744$.

Find $F(10^8)$. Give your answer modulo $1\,000\,000\,007$.",REDACTED
pe-706,"For a positive integer $n$, define $f(n)$ to be the number of non-empty substrings of $n$ that are divisible by $3$. For example, the string ""2573"" has $10$ non-empty substrings, three of which represent numbers that are divisible by $3$, namely $57$, $573$ and $3$. So $f(2573) = 3$.

If $f(n)$ is divisible by $3$ then we say that $n$ is $3$-like.

Define $F(d)$ to be how many $d$ digit numbers are $3$-like. For example, $F(2) = 30$ and $F(6) = 290898$.

Find $F(10^5)$. Give your answer modulo $1\,000\,000\,007$.",REDACTED
pe-708,"A positive integer, $n$, is factorised into prime factors. We define $f(n)$ to be the product when each prime factor is replaced with $2$. In addition we define $f(1)=1$.

For example, $90 = 2\times 3\times 3\times 5$, then replacing the primes, $2\times 2\times 2\times 2 = 16$, hence $f(90) = 16$.

 
 
Let $\displaystyle S(N)=\sum_{n=1}^{N} f(n)$. You are given $S(10^8)=9613563919$.

 

Find $S(10^{14})$.

Give your answer modulo $99991$.",REDACTED
pe-709,"Every day for the past $n$ days Even Stevens brings home his groceries in a plastic bag. He stores these plastic bags in a cupboard. He either puts the plastic bag into the cupboard with the rest, or else he takes an even number of the existing bags (which may either be empty or previously filled with other bags themselves) and places these into the current bag.

After 4 days there are 5 possible packings and if the bags are numbered 1 (oldest), 2, 3, 4, they are:

- Four empty bags,

- 1 and 2 inside 3, 4 empty,

- 1 and 3 inside 4, 2 empty,

- 1 and 2 inside 4, 3 empty,

- 2 and 3 inside 4, 1 empty.

Note that 1, 2, 3 inside 4 is invalid because every bag must contain an even number of bags.

Define $f(n)$ to be the number of possible packings of $n$ bags. Hence $f(4)=5$. You are also given $f(8)=1\,385$.

Find $f(24\,680)$ giving your answer modulo $1\,020\,202\,009$.",REDACTED
pe-710,"On Sunday 5 April 2020 the Project Euler membership first exceeded one million members. We would like to present this problem to celebrate that milestone. Thank you to everyone for being a part of Project Euler.

The number 6 can be written as a palindromic sum in exactly eight different ways:

$$(1, 1, 1, 1, 1, 1), (1, 1, 2, 1, 1), (1, 2, 2, 1), (1, 4, 1), (2, 1, 1, 2), (2, 2, 2), (3, 3), (6)$$

We shall define a twopal to be a palindromic tuple having at least one element with a value of 2. It should also be noted that elements are not restricted to single digits. For example, $(3, 2, 13, 6, 13, 2, 3)$ is a valid twopal.

If we let $t(n)$ be the number of twopals whose elements sum to $n$, then it can be seen that $t(6) = 4$:

$$(1, 1, 2, 1, 1), (1, 2, 2, 1), (2, 1, 1, 2), (2, 2, 2)$$

Similarly, $t(20) = 824$.

In searching for the answer to the ultimate question of life, the universe, and everything, it can be verified that $t(42) = 1999923$, which happens to be the first value of $t(n)$ that exceeds one million.

However, your challenge to the ""ultimatest"" question of life, the universe, and everything is to find the least value of $n \gt 42$ such that $t(n)$ is divisible by one million.

Give your answer modulo $99991$.",REDACTED
pe-711,"Oscar and Eric play the following game. First, they agree on a positive integer $n$, and they begin by writing its binary representation on a blackboard. They then take turns, with Oscar going first, to write a number on the blackboard in binary representation, such that the sum of all written numbers does not exceed $2n$.

The game ends when there are no valid moves left. Oscar wins if the number of $1$s on the blackboard is odd, and Eric wins if it is even.

Let $S(N)$ be the sum of all $n \le 2^N$ for which Eric can guarantee winning, assuming optimal play.

For example, the first few values of $n$ for which Eric can guarantee winning are $1,3,4,7,15,16$. Hence $S(4)=46$.

You are also given that $S(12) = 54532$ and $S(1234) \equiv 690421393 \pmod{1\,000\,000\,007}$.

Find $S(12\,345\,678)$. Give your answer modulo $1\,000\,000\,007$.",REDACTED
pe-712,"For any integer $n&gt;0$ and prime number $p,$ define $\nu_p(n)$ as the greatest integer $r$ such that $p^r$ divides $n$. 

Define $$D(n, m)  = \sum_{p \text{ prime}} \left| \nu_p(n) - \nu_p(m)\right|.$$ For example, $D(14,24) = 4$.

Furthermore, define $$S(N) = \sum_{1 \le n, m \le N} D(n, m).$$ You are given $S(10) = 210$ and $S(10^2) = 37018$.

Find $S(10^{12})$. Give your answer modulo $1\,000\,000\,007$.",REDACTED
pe-713,"Turan has the electrical water heating system outside his house in a shed. The electrical system uses two fuses in series, one in the house and one in the shed. (Nowadays old fashioned fuses are often replaced with reusable mini circuit breakers, but Turan's system still uses old fashioned fuses.)
For the heating system to work both fuses must work.

Turan has $N$ fuses. He knows that $m$ of them are working and the rest are blown. However, he doesn't know which ones are blown. So he tries different combinations until the heating system turns on.

We denote by $T(N,m)$ the smallest number of tries required to ensure the heating system turns on.

$T(3,2)=3$ and $T(8,4)=7$.

Let $L(N)$ be the sum of all $T(N, m)$ for $2 \leq m \leq N$.

$L(10^3)=3281346$.

Find $L(10^7)$.

Give your answer modulo $99991$.",REDACTED
pe-715,"Let $f(n)$ be the number of $6$-tuples $(x_1,x_2,x_3,x_4,x_5,x_6)$ such that:

- All $x_i$ are integers with $0 \leq x_i &lt; n$

- $\gcd(x_1^2+x_2^2+x_3^2+x_4^2+x_5^2+x_6^2,\ n^2)=1$

Let $\displaystyle G(n)=\displaystyle\sum_{k=1}^n \frac{f(k)}{k^2\varphi(k)}$

where $\varphi(n)$ is Euler's totient function.

For example, $G(10)=3053$ and $G(10^5) \equiv 157612967 \pmod{1\,000\,000\,007}$.

Find $G(10^{12})\bmod 1\,000\,000\,007$.",REDACTED
pe-717,"For an odd prime $p$, define $f(p) = \left\lfloor\frac{2^{(2^p)}}{p}\right\rfloor\bmod{2^p}$

For example, when $p=3$, $\lfloor 2^8/3\rfloor = 85 \equiv 5 \pmod 8$ and so $f(3) = 5$.

 

Further define $g(p) = f(p)\bmod p$. You are given $g(31) = 17$.

Now define $G(N)$ to be the summation of $g(p)$ for all odd primes less than $N$.

You are given $G(100) = 474$ and $G(10^4) = 2819236$.

Find $G(10^7)$.",REDACTED
pe-718,"Consider the equation
$17^pa+19^pb+23^pc = n$ where $a$, $b$, $c$ and $p$ are positive integers, i.e.
$a,b,c,p \gt 0$.

For a given $p$ there are some values of $n &gt; 0$ for which the equation cannot be solved. We call these unreachable values.

Define $G(p)$ to be the sum of all unreachable values of $n$ for the given value of $p$. For example $G(1) = 8253$ and $G(2)= 60258000$.

Find $G(6)$. Give your answer modulo $1\,000\,000\,007$.",REDACTED
pe-719,"We define an $S$-number to be a natural number, $n$, that is a perfect square and its square root can be obtained by splitting the decimal representation of $n$ into $2$ or more numbers then adding the numbers.

For example, $81$ is an $S$-number because $\sqrt{81} = 8+1$.

$6724$ is an $S$-number: $\sqrt{6724} = 6+72+4$. 

$8281$ is an $S$-number: $\sqrt{8281} = 8+2+81 = 82+8+1$.

$9801$ is an $S$-number: $\sqrt{9801}=98+0+1$.

Further we define $T(N)$ to be the sum of all $S$ numbers $n\le N$. You are given $T(10^4) = 41333$.

Find $T(10^{12})$.

Give your answer modulo $99991$.",REDACTED
pe-720,"Consider all permutations of $\{1, 2, \ldots N\}$, listed in lexicographic order.
For example, for $N=4$, the list starts as follows:

$$\displaylines{
(1, 2, 3, 4) \\
(1, 2, 4, 3) \\
(1, 3, 2, 4) \\
(1, 3, 4, 2) \\
(1, 4, 2, 3) \\
(1, 4, 3, 2) \\
(2, 1, 3, 4) \\
\vdots
}$$

Let us call a permutation $P$ unpredictable if there is no choice of three indices $i \lt j \lt k$ such that $P(i)$, $P(j)$ and $P(k)$ constitute an arithmetic progression.
 For example, $P=(3, 4, 2, 1)$ is not unpredictable because $P(1), P(3), P(4)$ is an arithmetic progression.

Let $S(N)$ be the position within the list of the first unpredictable permutation.

For example, given $N = 4$, the first unpredictable permutation is $(1, 3, 2, 4)$ so $S(4) = 3$.

You are also given that $S(8) = 2295$ and $S(32) \equiv 641839205 \pmod{1\,000\,000\,007}$.

Find $S(2^{25})$. Give your answer modulo $1\,000\,000\,007$.",REDACTED
pe-721,"Given is the function $f(a,n)=\lfloor (\lceil \sqrt a \rceil + \sqrt a)^n \rfloor$.

$\lfloor \cdot \rfloor$ denotes the floor function and $\lceil \cdot \rceil$ denotes the ceiling function.

$f(5,2)=27$ and $f(5,5)=3935$.

$G(n) = \displaystyle \sum_{a=1}^n f(a, a^2).$

$G(1000) \bmod 999\,999\,937=163861845. $

Find $G(5\,000\,000).$ Give your answer modulo $999\,999\,937$.",REDACTED
pe-724,"A depot uses $n$ drones to disperse packages containing essential supplies along a long straight road.

Initially all drones are stationary, loaded with a supply package.

Every second, the depot selects a drone at random and sends it this instruction:

- If you are stationary, start moving at one centimetre per second along the road.

- If you are moving, increase your speed by one centimetre per second along the road without changing direction.

The road is wide enough that drones can overtake one another without risk of collision.

Eventually, there will only be one drone left at the depot waiting to receive its first instruction. As soon as that drone has flown one centimetre along the road, all drones drop their packages and return to the depot.

Let $E(n)$ be the expected distance in centimetres from the depot that the supply packages land.

For example, $E(2) = \frac{7}{2}$, $E(5) = \frac{12019}{720}$, and $E(100) \approx 1427.193470$.

Find $E(10^8)$. Give your answer rounded to the nearest integer.

Give your answer modulo $99991$.",REDACTED
pe-725,"A number where one digit is the sum of the other digits is called a digit sum number or DS-number for short. For example, $352$, $3003$ and $32812$ are DS-numbers.

We define $S(n)$ to be the sum of all DS-numbers of $n$ digits or less.

You are given $S(3) = 63270$ and $S(7) = 85499991450$.

Find $S(2020)$. Give your answer modulo $10^{16}$.",REDACTED
pe-730,"For a non-negative integer $k$, the triple $(p,q,r)$ of positive integers is called a $k$-shifted Pythagorean triple if $$p^2 + q^2 + k = r^2$$

$(p, q, r)$ is said to be primitive if $\gcd(p, q, r)=1$.

Let $P_k(n)$ be the number of primitive $k$-shifted Pythagorean triples such that $1 \le p \le q \le r$ and $p + q + r \le n$. 
 For example, $P_0(10^4) = 703$ and $P_{20}(10^4) = 1979$. 

Define 
$$\displaystyle S(m,n)=\sum_{k=0}^{m}P_k(n).$$
You are given that $S(10,10^4) = 10956$. 

Find $S(10^2,10^8)$.

Give your answer modulo $99991$.",REDACTED
pe-731,"$$A=\sum_{i=1}^{\infty} \frac{1}{3^i 10^{3^i}}$$

Define $A(n)$ to be the $10$ decimal digits from the $n$th digit onward. 
For example, $A(100) = 4938271604$ and $A(10^8)=2584642393$.

Find $A(10^{16})$.

Give your answer modulo $99991$.",REDACTED
pe-732,"$N$ trolls are in a hole that is $D_N$ cm deep. The $n$-th troll is characterized by:

- the distance from his feet to his shoulders in cm, $h_n$

- the length of his arms in cm, $l_n$

- his IQ (Irascibility Quotient), $q_n$.

Trolls can pile up on top of each other, with each troll standing on the shoulders of the one below him. A troll can climb out of the hole and escape if his hands can reach to the surface. Once a troll escapes he cannot participate any further in the escaping effort.

The trolls execute an optimal strategy for maximizing the total IQ of the escaping trolls, defined as $Q(N)$.

Let

$r_n = \left[ \left( 5^n \bmod (10^9 + 7) \right) \bmod 101 \right] + 50$

$h_n = r_{3n}$

$l_n = r_{3n+1}$

$q_n = r_{3n+2}$

$D_N = \frac{1}{\sqrt{2}} \sum_{n=0}^{N-1} h_n$.

For example, the first troll ($n=0$) is 51cm tall to his shoulders, has 55cm long arms, and has an IQ of 75.

You are given that $Q(5) = 401$ and $Q(15)=941$.

Find $Q(1000)$.",REDACTED
pe-733,"Let $a_i$ be the sequence defined by $a_i=153^i \bmod 10\,000\,019$ for $i \ge 1$.

The first terms of $a_i$ are:
$153, 23409, 3581577, 7980255, 976697, 9434375, \dots$

Consider the subsequences consisting of $4$ terms in ascending order. For the part of the sequence shown above, these are:

$153, 23409, 3581577, 7980255$

$153, 23409, 3581577, 9434375$

$153, 23409, 7980255, 9434375$

$153, 23409, 976697, 9434375$

$153, 3581577, 7980255, 9434375$ and

$23409, 3581577, 7980255, 9434375$.

Define $S(n)$ to be the sum of the terms for all such subsequences within the first $n$ terms of $a_i$. Thus $S(6)=94513710$.

You are given that $S(100)=4465488724217$.

Find $S(10^6)$ modulo $1\,000\,000\,007$.",REDACTED
pe-734,"The logical-OR of two bits is $0$ if both bits are $0$, otherwise it is $1$.

The bitwise-OR of two positive integers performs a logical-OR operation on each pair of corresponding bits in the binary expansion of its inputs.

For example, the bitwise-OR of $10$ and $6$ is $14$ because $10 = 1010_2$, $6 = 0110_2$ and $14 = 1110_2$.

Let $T(n, k)$ be the number of $k$-tuples $(x_1, x_2,\cdots,x_k)$ such that

- every $x_i$ is a prime $\leq n$

- the bitwise-OR of the tuple is a prime $\leq n$

For example, $T(5, 2)=5$. The five $2$-tuples are $(2, 2)$, $(2, 3)$, $(3, 2)$, $(3, 3)$ and $(5, 5)$.

You are given $T(100, 3) = 3355$ and $T(1000, 10) \equiv 2071632 \pmod{1\,000\,000\,007}$.

Find $T(10^6,999983)$. Give your answer modulo $1\,000\,000\,007$.",REDACTED
pe-735,"Let $f(n)$ be the number of divisors of $2n^2$ that are no greater than n. For example, $f(15)=8$ because there are 8 such divisors: 1,2,3,5,6,9,10,15. Note that 18 is also a divisor of $2\times 15^2$ but it is not counted because it is greater than 15.

Let $\displaystyle F(N) = \sum_{n=1}^N f(n)$. You are given $F(15)=63$, and $F(1000)=15066$.

Find $F(10^{12})$.

Give your answer modulo $99991$.",REDACTED
pe-736,"Define two functions on lattice points:

$r(x,y) = (x+1,2y)$

$s(x,y) = (2x,y+1)$

A path to equality of length $n$ for a pair $(a,b)$ is a sequence $\Big((a_1,b_1),(a_2,b_2),\ldots,(a_n,b_n)\Big)$, where:

- $(a_1,b_1) = (a,b)$

- $(a_k,b_k) = r(a_{k-1},b_{k-1})$ or $(a_k,b_k) = s(a_{k-1},b_{k-1})$ for $k &gt; 1$

- $a_k \ne b_k$ for $k &lt; n$

- $a_n = b_n$

$a_n = b_n$ is called the final value.

For example,

$(45,90)\xrightarrow{r} (46,180)\xrightarrow{s}(92,181)\xrightarrow{s}(184,182)\xrightarrow{s}(368,183)\xrightarrow{s}(736,184)\xrightarrow{r}$

$(737,368)\xrightarrow{s}(1474,369)\xrightarrow{r}(1475,738)\xrightarrow{r}(1476,1476)$

This is a path to equality for $(45,90)$ and is of length 10 with final value 1476. There is no path to equality of $(45,90)$ with smaller length.

Find the unique path to equality for $(45,90)$ with smallest odd length. Enter the final value as your answer.

Give your answer modulo $99991$.",REDACTED
pe-738,"Define $d(n,k)$ to be the number of ways to write $n$ as a product of $k$ ordered integers

$$
n = x_1\times x_2\times x_3\times \ldots\times x_k\qquad 1\le x_1\le x_2\le\ldots\le x_k
$$
Further define $D(N,K)$ to be the sum of $d(n,k)$ for $1\le n\le N$ and $1\le k\le K$.

You are given that $D(10, 10) = 153$ and $D(100, 100) = 35384$.

Find $D(10^{10},10^{10})$ giving your answer modulo $1\,000\,000\,007$.",REDACTED
pe-739,"Take a sequence of length $n$. Discard the first term then make a sequence of the partial summations. Continue to do this over and over until we are left with a single term. We define this to be $f(n)$.

Consider the example where we start with a sequence of length 8:

$
\begin{array}{rrrrrrrr}
1&amp;1&amp;1&amp;1&amp;1&amp;1&amp;1&amp;1\\
 &amp;1&amp;2&amp;3&amp;4&amp;5&amp; 6 &amp;7\\
 &amp; &amp;2&amp;5&amp;9&amp;14&amp;20&amp;27\\
 &amp; &amp; &amp;5&amp;14&amp;28&amp;48&amp;75\\
 &amp; &amp; &amp; &amp;14&amp;42&amp;90&amp;165\\
 &amp; &amp; &amp; &amp; &amp; 42 &amp; 132 &amp; 297\\
 &amp; &amp; &amp; &amp; &amp; &amp; 132 &amp;429\\
 &amp; &amp; &amp; &amp; &amp; &amp; &amp;429\\
\end{array}
$

Then the final number is $429$, so $f(8) = 429$.

For this problem we start with the sequence $1,3,4,7,11,18,29,47,\ldots$

This is the Lucas sequence where two terms are added to get the next term.
 
Applying the same process as above we get $f(8) = 2663$.

You are also given $f(20) = 742296999 $ modulo $1\,000\,000\,007$

Find $f(10^8)$. Give your answer modulo $1\,000\,000\,007$.",REDACTED
pe-741,"Let $f(n)$ be the number of ways an $n\times n$ square grid can be coloured, each cell either black or white, such that each row and each column contains exactly two black cells.

For example, $f(4)=90$, $f(7) = 3110940$ and $f(8) = 187530840$.

Let $g(n)$ be the number of colourings in $f(n)$ that are unique up to rotations and reflections.

You are given $g(4)=20$, $g(7) = 390816$ and $g(8) = 23462347$ giving $g(7)+g(8) = 23853163$.

Find $g(7^7) + g(8^8)$. Give your answer modulo $1\,000\,000\,007$.",REDACTED
pe-743,"A window into a matrix is a contiguous sub matrix.

Consider a $2\times n$ matrix where every entry is either 0 or 1.

Let $A(k,n)$ be the total number of these matrices such that the sum of the entries in every $2\times k$ window is $k$.

You are given that $A(3,9) = 560$ and $A(4,20) = 1060870$.

Find $A(10^8,10^{16})$. Give your answer modulo $1\,000\,000\,007$.",REDACTED
pe-745,"For a positive integer, $n$, define $g(n)$ to be the maximum perfect square that divides $n$.

For example, $g(18) = 9$, $g(19) = 1$.

Also define
$$\displaystyle	S(N) = \sum_{n=1}^N g(n)$$

For example, $S(10) = 24$ and $S(100) = 767$.

Find $S(10^{14})$. Give your answer modulo $1\,000\,000\,007$.",REDACTED
pe-746,"$n$ families, each with four members, a father, a mother, a son and a daughter, were invited to a restaurant. They were all seated at a large circular table with $4n$ seats such that men and women alternate.

Let $M(n)$ be the number of ways the families can be seated such that none of the families were seated together. A family is considered to be seated together only when all the members of a family sit next to each other.

For example, $M(1)=0$, $M(2)=896$, $M(3)=890880$ and $M(10) \equiv 170717180 \pmod {1\,000\,000\,007}$.

Let $S(n)=\displaystyle \sum_{k=2}^nM(k)$.

For example, $S(10) \equiv 399291975 \pmod {1\,000\,000\,007}$.

Find $S(2021)$. Give your answer modulo $1\,000\,000\,007$.",REDACTED
pe-748,"Upside Down is a modification of the famous Pythagorean equation:
$$\begin{align}
\frac{1}{x^2}+\frac{1}{y^2}=\frac{13}{z^2}.
\end{align}$$

A solution $(x,y,z)$  to this equation with $x,y$ and $z$ positive integers is a primitive solution if $\gcd(x,y,z)=1$.

Let $S(N)$ be the sum of $x+y+z$ over primitive Upside Down solutions such that $1 \leq x,y,z \leq N$ and $x \le y$.

For $N=100$ the primitive solutions are $(2,3,6)$ and $(5,90,18)$, thus $S(10^2)=124$.

It can be checked that $S(10^3)=1470$ and $S(10^5)=2340084$.

Find $S(10^{16})$ and give the last $9$ digits as your answer.",REDACTED
pe-749,"A positive integer, $n$, is a near power sum if there exists a positive integer, $k$, such that the sum of the $k$th powers of the digits in its decimal representation is equal to either $n+1$ or $n-1$. For example $35$ is a near power sum number because $3^2+5^2 = 34$.

Define $S(d)$ to be the sum of all near power sum numbers of $d$ digits or less. 
Then $S(2) = 110$ and $S(6) = 2562701$.

Find $S(16)$.

Give your answer modulo $99991$.",REDACTED
pe-752,"When $(1+\sqrt 7)$ is raised to an integral power, $n$, we always get a number of the form $(a+b\sqrt 7)$.

We write $(1+\sqrt 7)^n = \alpha(n) + \beta(n)\sqrt 7$.

For a given number $x$ we  define $g(x)$ to be the smallest positive integer $n$ such that:
$$\begin{align}
\alpha(n) &amp;\equiv 1 \pmod x\qquad \text{and }\\
\beta(n) &amp;\equiv 0 \pmod x\end{align}
$$
and $g(x) = 0$ if there is no such value of $n$. For example, $g(3) = 0$, $g(5) = 12$.

Further define
$$ G(N) = \sum_{x=2}^N g(x)$$
You are given $G(10^2) = 28891$ and $G(10^3)  = 13131583$.

Find $G(10^6)$.",REDACTED
pe-753,"Fermat's Last Theorem states that no three positive integers $a$, $b$, $c$ satisfy the equation 
$$a^n+b^n=c^n$$
for any integer value of $n$ greater than 2.

For this problem we are only considering the case $n=3$. For certain values of $p$, it is possible to solve the congruence equation:
$$a^3+b^3 \equiv c^3 \pmod{p}$$

For a prime $p$, we define $F(p)$ as the number of integer solutions to this equation for $1 \le a,b,c &lt; p$.

You are given $F(5) = 12$ and $F(7) = 0$.

Find the sum of $F(p)$ over all primes $p$ less than $6\,000\,000$.",REDACTED
pe-754,"The Gauss Factorial of a number $n$ is defined as the product of all positive numbers $\leq n$ that are relatively prime to $n$. For example $g(10)=1\times 3\times 7\times 9 = 189$. 

Also we define
$$\displaystyle G(n) = \prod_{i=1}^{n}g(i)$$

You are given $G(10) = 23044331520000$.

Find $G(10^8)$. Give your answer modulo $1\,000\,000\,007$.",REDACTED
pe-755,"Consider the Fibonacci sequence $\{1,2,3,5,8,13,21,\ldots\}$.

We let $f(n)$ be the number of ways of representing an integer $n\ge 0$ as the sum of different Fibonacci numbers.

For example, $16 = 3+13 = 1+2+13 = 3+5+8 = 1+2+5+8$ and hence $f(16) = 4$. 
By convention $f(0) = 1$.

Further we define
$$S(n) = \sum_{k=0}^n f(k).$$
You are given $S(100) = 415$ and $S(10^4) = 312807$.

Find $\displaystyle S(10^{13})$.

Give your answer modulo $99991$.",REDACTED
pe-757,"A positive integer $N$ is stealthy, if there exist positive integers $a$, $b$, $c$, $d$ such that $ab = cd = N$ and $a+b = c+d+1$.

For example, $36 = 4\times 9 = 6\times 6$ is stealthy.

You are also given that there are 2851 stealthy numbers not exceeding $10^6$.

How many stealthy numbers  are there that don't exceed $10^{14}$?

Give your answer modulo $99991$.",REDACTED
pe-758,"There are 3 buckets labelled $S$ (small) of 3 litres, $M$ (medium) of 5 litres and $L$ (large) of 8 litres.

Initially $S$ and $M$ are full of water and $L$ is empty.
By pouring water between the buckets exactly one litre of water can be measured.

Since there is no other way to measure, once a pouring starts it cannot stop until either the source bucket is empty or the destination bucket is full.

At least four pourings are needed to get one litre:

$(3,5,0)\xrightarrow{M\to L} (3,0,5) \xrightarrow{S\to M} (0,3,5) \xrightarrow{L\to S}(3,3,2)
\xrightarrow{S\to M}(1,5,2)$

After these operations, there is exactly one litre in bucket $S$.

In general the sizes of the buckets $S, M, L$ are $a$, $b$, $a + b$ litres, respectively. Initially $S$ and $M$ are full and $L$ is empty. If the above rule of pouring still applies and $a$ and $b$ are two coprime positive integers with $a\leq b$ then it is always possible to measure one litre in finitely many steps.

Let $P(a,b)$ be the minimal number of pourings needed to get one litre. Thus $P(3,5)=4$.

Also, $P(7, 31)=20$ and $P(1234, 4321)=2780$.

Find the sum of $P(2^{p^5}-1, 2^{q^5}-1)$ for all pairs of prime numbers $p,q$ such that $p &lt; q &lt; 1000$.

Give your answer modulo $1\,000\,000\,007$.",REDACTED
pe-759,"The function $f$ is defined for all positive integers as follows:

$$\begin{align*}
f(1) &amp;=  1\\
f(2n) &amp;= 2f(n)\\
f(2n+1) &amp;= 2n+1 + 2f(n)+\tfrac 1n f(n)
\end{align*}$$
It can be proven that $f(n)$ is integer for all values of $n$.

The function $S(n)$ is defined as $S(n) = \displaystyle \sum_{i=1}^n f(i) ^2$.

For example, $S(10)=1530$ and $S(10^2)=4798445$.

Find $S(10^{16})$. Give your answer modulo $1\,000\,000\,007$.",REDACTED
pe-760,"Define
$$\displaystyle g(m,n) = (m\oplus n)+(m\vee n)+(m\wedge n)$$
where $\oplus, \vee, \wedge$ are the bitwise XOR, OR and AND operator respectively.

Also set
$$\displaystyle G(N) = \sum_{n=0}^N\sum_{k=0}^n g(k,n-k)$$

For example, $G(10) = 754$ and $G(10^2) = 583766$.

Find $G(10^{18})$. Give your answer modulo $1\,000\,000\,007$.",REDACTED
pe-763,"Consider a three dimensional grid of cubes. An amoeba in cube $(x, y, z)$ can divide itself into three amoebas to occupy the cubes $(x + 1, y, z)$, $(x, y + 1, z)$ and $(x, y, z + 1)$, provided these cubes are empty.

Originally there is only one amoeba in the cube $(0, 0, 0)$. After $N$ divisions there will be $2N+1$ amoebas arranged in the grid. An arrangement may be reached in several different ways but it is only counted once. Let $D(N)$ be the number of different possible arrangements after $N$ divisions.

For example, $D(2) = 3$, $D(10) = 44499$, $D(20)=9204559704$ and the last nine digits of $D(100)$ are $780166455$.

Find $D(10\,000)$, enter the last nine digits as your answer.",REDACTED
pe-764,"Consider the following Diophantine equation:
$$16x^2+y^4=z^2$$
where $x$, $y$ and $z$ are positive integers.

Let $S(N) = \displaystyle{\sum(x+y+z)}$ where the sum is over all solutions $(x,y,z)$ such that $1 \leq x,y,z \leq N$ and $\gcd(x,y,z)=1$. 

For $N=100$, there are only two such solutions: $(3,4,20)$ and $(10,3,41)$. So $S(10^2)=81$.

You are also given that $S(10^4)=112851$ (with $26$ solutions), and $S(10^7)\equiv 248876211 \pmod{10^9}$.

Find $S(10^{16})$. Give your answer modulo $10^9$.",REDACTED
pe-767,"A window into a matrix is a contiguous sub matrix.

Consider a $16\times n$ matrix where every entry is either $0$ or $1$.
Let $B(k,n)$ be the total number of these matrices such that the sum of the entries in every $2\times k$ window is $k$.

You are given that $B(2,4) = 65550$ and $B(3,9) \equiv 87273560 \pmod{1\,000\,000\,007}$.

Find $B(10^5,10^{16})$. Give your answer modulo $1\,000\,000\,007$.",REDACTED
pe-768,"A certain type of chandelier contains a circular ring of $n$ evenly spaced candleholders.

If only one candle is fitted, then the chandelier will be imbalanced. However, if a second identical candle is placed in the opposite candleholder (assuming $n$ is even) then perfect balance will be achieved and the chandelier will hang level.

Let $f(n,m)$ be the number of ways of arranging $m$ identical candles in distinct sockets of a chandelier with $n$ candleholders such that the chandelier is perfectly balanced.

For example, $f(4, 2) = 2$: assuming the chandelier's four candleholders are aligned with the compass points, the two valid arrangements are ""North &amp; South"" and ""East &amp; West"". Note that these are considered to be different arrangements even though they are related by rotation.

You are given that $f(12,4) = 15$ and $f(36, 6) = 876$.

Find $f(360, 20)$.

Give your answer modulo $99991$.",REDACTED
pe-769,"Consider the following binary quadratic form:

$$
\begin{align}
f(x,y)=x^2+5xy+3y^2
\end{align}
$$
A positive integer $q$ has a primitive representation if there exist positive integers $x$ and $y$ such that $q = f(x,y)$ and $\gcd(x,y)=1$.

We are interested in primitive representations of perfect squares. For example:

$17^2=f(1,9)$

$87^2=f(13,40) = f(46,19)$

Define $C(N)$ as the total number of primitive representations of $z^2$ for $0 &lt; z \leq N$.
 
Multiple representations are counted separately, so for example $z=87$ is counted twice.

You are given $C(10^3)=142$ and $C(10^{6})=142463$.

Find $C(10^{14})$.

Give your answer modulo $99991$.",REDACTED
pe-770,"A and B play a game. A has originally $1$ gram of gold and B has an unlimited amount.
Each round goes as follows:

- 
A chooses and displays, $x$, a nonnegative real number no larger than the amount of gold that A has.

- 
Either B chooses to TAKE. Then A gives B $x$ grams of gold.

- 
Or B chooses to GIVE. Then B gives A $x$ grams of gold.

B TAKEs $n$ times and GIVEs $n$ times after which the game finishes.

Define $g(X)$ to be the smallest value of $n$ so that A can guarantee to have at least $X$ grams of gold at the end of the game. You are given $g(1.7) = 10$.

Find $g(1.9999)$.

Give your answer modulo $99991$.",REDACTED
pe-771,"We define a pseudo-geometric sequence to be a finite sequence $a_0, a_1, \dotsc, a_n$ of positive integers, satisfying the following conditions:

- $n \geq 4$, i.e. the sequence has at least $5$ terms.

- $0 \lt a_0 \lt a_1 \lt \cdots \lt a_n$, i.e. the sequence is strictly increasing.

- $| a_i^2 - a_{i - 1}a_{i + 1} | \le 2$ for $1 \le i \le n-1$.

Let $G(N)$ be the number of different pseudo-geometric sequences whose terms do not exceed $N$.

For example, $G(6) = 4$, as the following $4$ sequences give a complete list:

$1, 2, 3, 4, 5 \qquad 1, 2, 3, 4, 6 \qquad 2, 3, 4, 5, 6 \qquad 1, 2, 3, 4, 5, 6$ 

Also, $G(10) = 26$, $G(100) = 4710$ and $G(1000) = 496805$.

Find $G(10^{18})$. Give your answer modulo $1\,000\,000\,007$.",REDACTED
pe-772,"A $k$-bounded partition of a positive integer $N$ is a way of writing $N$ as a sum of positive integers not exceeding $k$.

A balanceable partition is a partition that can be further divided into two parts of equal sums.

For example, $3 + 2 + 2 + 2 + 2 + 1$ is a balanceable $3$-bounded partition of $12$ since $3 + 2 + 1 = 2 + 2 + 2$. Conversely, $3 + 3 + 3 + 1$ is a $3$-bounded partition of $10$ which is not balanceable.

Let $f(k)$ be the smallest positive integer $N$ all of whose $k$-bounded partitions are balanceable. For example, $f(3) = 12$ and $f(30) \equiv 179092994 \pmod {1\,000\,000\,007}$.

Find $f(10^8)$. Give your answer modulo $1\,000\,000\,007$.",REDACTED
pe-773,"Let $S_k$ be the set containing $2$ and $5$ and the first $k$ primes that end in $7$. For example, $S_3 = \{2,5,7,17,37\}$.

Define a $k$-Ruff number to be one that is not divisible by any element in $S_k$.

If $N_k$ is the product of the numbers in $S_k$ then define $F(k)$ to be the sum of all $k$-Ruff numbers less than $N_k$ that have last digit $7$. You are given $F(3) = 76101452$.

Find $F(97)$, give your answer modulo $1\,000\,000\,007$.",REDACTED
pe-774,"Let '$\&amp;$' denote the bitwise AND operation.

For example, $10\,\&amp;\, 12 = 1010_2\,\&amp;\, 1100_2 = 1000_2 = 8$.

We shall call a finite sequence of non-negative integers $(a_1, a_2, \ldots, a_n)$ conjunctive if $a_i\,\&amp;\, a_{i+1} \neq 0$ for all $i=1\ldots n-1$.

Define $c(n,b)$ to be the number of conjunctive sequences of length $n$ in which all terms are $\le b$.

You are given that $c(3,4)=18$, $c(10,6)=2496120$, and $c(100,200) \equiv 268159379 \pmod {998244353}$.

Find $c(123,123456789)$. Give your answer modulo $998244353$.",REDACTED
pe-778,"If $a,b$ are two nonnegative integers with decimal representations $a=(\dots a_2a_1a_0)$ and $b=(\dots b_2b_1b_0)$ respectively, then the freshman's product of $a$ and $b$, denoted $a\boxtimes b$, is the integer $c$ with decimal representation $c=(\dots c_2c_1c_0)$ such that $c_i$ is the last digit of $a_i\cdot b_i$.

For example, $234 \boxtimes 765 = 480$.

Let $F(R,M)$ be the sum of $x_1 \boxtimes \dots \boxtimes x_R$ for all sequences of integers $(x_1,\dots,x_R)$ with $0\leq x_i \leq M$.

For example, $F(2, 7) = 204$, and $F(23, 76) \equiv 5870548 \pmod{ 1\,000\,000\,009}$.

Find $F(234567,765432)$. Give your answer modulo $1\,000\,000\,009$.",REDACTED
pe-782,"The complexity of an $n\times n$ binary matrix is the number of distinct rows and columns.

For example, consider the $3\times 3$ matrices
$$		\mathbf{A} = \begin{pmatrix} 1&amp;0&amp;1\\0&amp;0&amp;0\\1&amp;0&amp;1\end{pmatrix}	\quad
		\mathbf{B} = \begin{pmatrix} 0&amp;0&amp;0\\0&amp;0&amp;0\\1&amp;1&amp;1\end{pmatrix}	$$
$\mathbf{A}$ has complexity $2$ because the set of rows and columns is $\{000,101\}$.
$\mathbf{B}$ has complexity $3$ because the set of rows and columns is $\{000,001,111\}$.

For $0 \le k \le n^2$, let $c(n, k)$ be the minimum complexity of an $n\times n$ binary matrix with exactly $k$ ones.

Let
$$C(n) = \sum_{k=0}^{n^2} c(n, k)$$
For example, $C(2) = c(2, 0) + c(2, 1) + c(2, 2) + c(2, 3) + c(2, 4) = 1 + 2 + 2 + 2 + 1 = 8$.

You are given $C(5) = 64$, $C(10) = 274$ and $C(20) = 1150$.

Find $C(10^4)$.

Give your answer modulo $99991$.",REDACTED
pe-783,"Given $n$ and $k$ two positive integers we begin with an urn that contains $kn$ white balls. We then proceed through $n$ turns where on each turn $k$ black balls are added to the urn and then $2k$ random balls are removed from the urn.

We let $B_t(n,k)$ be the number of black balls that are removed on turn $t$.

Further define $E(n,k)$ as the expectation of $\displaystyle \sum_{t=1}^n B_t(n,k)^2$.

You are given $E(2,2) = 9.6$.

Find $E(10^6,10)$. Round your answer to the nearest whole number.

Give your answer modulo $99991$.",REDACTED
pe-784,"Let's call a pair of positive integers $p$, $q$ ($p \lt q$) reciprocal, if there is a positive integer $r\lt p$ such that $r$ equals both the inverse of $p$ modulo $q$ and the inverse of $q$ modulo $p$.

For example, $(3,5)$ is one reciprocal pair for $r=2$.

Let $F(N)$ be the total sum of $p+q$ for all reciprocal pairs $(p,q)$ where $p \le N$.

$F(5)=59$ due to these four reciprocal pairs $(3,5)$, $(4,11)$, $(5,7)$ and $(5,19)$.

You are also given $F(10^2) = 697317$.

Find $F(2\cdot 10^6)$.",REDACTED
pe-785,"Consider the following Diophantine equation:
$$15  (x^2 + y^2 + z^2) = 34  (xy + yz + zx)$$
where $x$, $y$ and $z$ are positive integers.

Let $S(N)$ be the sum of all solutions, $(x,y,z)$, of this equation such that, $1 \le x \le y \le z \le N$ and $\gcd(x, y, z) = 1$.

For $N = 10^2$, there are three such solutions - $(1, 7, 16), (8, 9, 39), (11, 21, 72)$. So $S(10^2) = 184$.

Find $S(10^9)$.

Give your answer modulo $99991$.",REDACTED
pe-787,"Two players play a game with two piles of stones. They take alternating turns. If there are currently $a$ stones in the first pile and $b$ stones in the second, a turn consists of removing $c\geq 0$ stones from the first pile and $d\geq 0$ from the second in such a way that $ad-bc=\pm1$. The winner is the player who first empties one of the piles.

Note that the game is only playable if the sizes of the two piles are coprime.

A game state $(a, b)$ is a winning position if the next player can guarantee a win with optimal play. Define $H(N)$ to be the number of winning positions $(a, b)$ with $\gcd(a,b)=1$, $a &gt; 0$, $b &gt; 0$ and $a+b \leq N$. Note the order matters, so for example $(2,1)$ and $(1,2)$ are distinct positions.

You are given $H(4)=5$ and $H(100)=2043$.

Find $H(10^9)$.

Give your answer modulo $99991$.",REDACTED
pe-788,"A dominating number is a positive integer that has more than half of its digits equal.

For example, $2022$ is a dominating number because three of its four digits are equal to $2$. But $2021$ is not a dominating number.

Let $D(N)$ be how many dominating numbers are less than $10^N$.
For example, $D(4) = 603$ and $D(10) = 21893256$.

Find $D(2022)$. Give your answer modulo $1\,000\,000\,007$.",REDACTED
pe-789,"Given an odd prime $p$, put the numbers $1,...,p-1$ into $\frac{p-1}{2}$ pairs such that each number appears exactly once. Each pair $(a,b)$ has a cost of $ab \bmod p$. For example, if $p=5$ the pair $(3,4)$ has a cost of $12 \bmod 5 = 2$.

The total cost of a pairing is the sum of the costs of its pairs. We say that such pairing is optimal if its total cost is minimal for that $p$.

For example, if $p = 5$, then there is a unique optimal pairing: $(1, 2), (3, 4)$, with total cost of $2 + 2 = 4$.

The cost product of a pairing is the product of the costs of its pairs. For example, the cost product of the optimal pairing for $p = 5$ is $2 \cdot 2 = 4$.

It turns out that all optimal pairings for $p = 2\,000\,000\,011$ have the same cost product.

Find the value of this product.",REDACTED
pe-790,"There is a grid of length and width $50515093$ points. A clock is placed on each grid point. The clocks are all analogue showing a single hour hand initially pointing at $12$.

  

A sequence $S_t$ is created where:
$$
\begin{align}
S_0 &amp;= 290797\\
S_t &amp;= S_{t-1}^2 \bmod 50515093 &amp;t&gt;0
\end{align}
$$
The four numbers $N_t = (S_{4t-4}, S_{4t-3}, S_{4t-2}, S_{4t-1})$ represent a range within the grid, with the first pair of numbers representing the x-bounds and the second pair representing the y-bounds. For example, if $N_t = (3,9,47,20)$, the range would be $3\le x\le 9$ and $20\le y\le47$, and would include $196$ clocks.

For each $t$ $(t&gt;0)$, the clocks within the range represented by $N_t$ are moved to the next hour $12\rightarrow 1\rightarrow 2\rightarrow \cdots $.

We define $C(t)$ to be the sum of the hours that the clock hands are pointing to after timestep $t$.

You are given $C(0) = 30621295449583788$, $C(1) =  30613048345941659$, $C(10) = 21808930308198471$ and $C(100) = 16190667393984172$.

Find $C(10^5)$.",REDACTED
pe-791,"Denote the average of $k$ numbers $x_1, ..., x_k$ by $\bar{x} = \frac{1}{k} \sum_i x_i$. Their variance is defined as $\frac{1}{k} \sum_i \left( x_i - \bar{x} \right) ^ 2$.

Let $S(n)$ be the sum of all quadruples of integers $(a,b,c,d)$ satisfying $1 \leq a \leq b \leq c \leq d \leq n$ such that their average is exactly twice their variance.

For $n=5$, there are $5$ such quadruples, namely: $(1, 1, 1, 3), (1, 1, 3, 3), (1, 2, 3, 4), (1, 3, 4, 4), (2, 2, 3, 5)$.

Hence $S(5)=48$. You are also given $S(10^3)=37048340$.

Find $S(10^8)$. Give your answer modulo $433494437$.",REDACTED
pe-792,"We define $\nu_2(n)$ to be the largest integer $r$ such that $2^r$ divides $n$. For example, $\nu_2(24) = 3$.

Define $\displaystyle S(n)  = \sum_{k = 1}^n (-2)^k\binom{2k}k$ and $u(n) = \nu_2\Big(3S(n)+4\Big)$.

For example, when $n = 4$ then $S(4) = 980$ and $3S(4) + 4 = 2944 = 2^7 \cdot 23$, hence $u(4) = 7$.

You are also given $u(20) = 24$.

Also define $\displaystyle U(N) = \sum_{n = 1}^N u(n^3)$. You are given $U(5) = 241$.

Find $U(10^4)$.

Give your answer modulo $99991$.",REDACTED
pe-793,"Let $S_i$ be an integer sequence produced with the following pseudo-random number generator:

- $S_0 = 290797$

-  $S_{i+1} = S_i ^2 \bmod 50515093$

Let $M(n)$ be the median of the pairwise products $ S_i S_j $ for $0 \le i \lt j \lt n$.

You are given $M(3) = 3878983057768$ and $M(103) = 492700616748525$.

Find $M(1\,000\,003)$.",REDACTED
pe-795,"For a positive integer $n$, the function $g(n)$ is defined as

$$\displaystyle g(n)=\sum_{i=1}^{n} (-1)^i \gcd \left(n,i^2\right).$$

For example, $g(4) = -\gcd \left(4,1^2\right) + \gcd \left(4,2^2\right) - \gcd \left(4,3^2\right) + \gcd \left(4,4^2\right) = -1+4-1+4=6$.

You are also given $g(1234)=1233$.

Let $\displaystyle G(N) = \sum_{n=1}^N g(n)$. You are given $G(1234) = 2194708$.

Find $G(12345678)$.

Give your answer modulo $99991$.",REDACTED
pe-797,"A monic polynomial is a single-variable polynomial in which the coefficient of highest degree is equal to $1$.

Define $\mathcal{F}$ to be the set of all monic polynomials with integer coefficients (including the constant polynomial $p(x)=1$). A polynomial $p(x)\in\mathcal{F}$ is cyclogenic if there exists $q(x)\in\mathcal{F}$ and a positive integer $n$ such that $p(x)q(x)=x^n-1$. If $n$ is the smallest such positive integer then $p(x)$ is $n$-cyclogenic.

Define $P_n(x)$ to be the sum of all $n$-cyclogenic polynomials. For example, there exist ten 6-cyclogenic polynomials (which divide $x^6-1$ and no smaller $x^k-1$):

$$\begin{align*}
&amp;x^6-1&amp;&amp;x^4+x^3-x-1&amp;&amp;x^3+2x^2+2x+1&amp;&amp;x^2-x+1\\
&amp;x^5+x^4+x^3+x^2+x+1&amp;&amp;x^4-x^3+x-1&amp;&amp;x^3-2x^2+2x-1\\
&amp;x^5-x^4+x^3-x^2+x-1&amp;&amp;x^4+x^2+1&amp;&amp;x^3+1\end{align*}$$
giving

$$P_6(x)=x^6+2x^5+3x^4+5x^3+2x^2+5x.$$
Also define

$$Q_N(x)=\sum_{n=1}^N P_n(x).$$
It's given that
$Q_{10}(x)=x^{10}+3x^9+3x^8+7x^7+8x^6+14x^5+11x^4+18x^3+12x^2+23x$ and $Q_{10}(2) = 5598$.

Find $Q_{10^7}(2)$. Give your answer modulo $1\,000\,000\,007$.",REDACTED
pe-798,"Two players play a game with a deck of cards which contains $s$ suits with each suit containing $n$ cards numbered from $1$ to $n$.

Before the game starts, a set of cards (which may be empty) is picked from the deck and placed face-up on the table, with no overlap. These are called the visible cards.

The players then make moves in turn.

A move consists of choosing a card X from the rest of the deck and placing it face-up on top of a visible card Y, subject to the following restrictions:

- X and Y must be the same suit;

- the value of X must be larger than the value of Y.

The card X then covers the card Y and replaces Y as a visible card.

The player unable to make a valid move loses and play stops.

Let $C(n, s)$ be the number of different initial sets of cards for which the first player will lose given best play for both players.

For example, $C(3, 2) = 26$ and $C(13, 4) \equiv 540318329 \pmod {1\,000\,000\,007}$.

Find $C(10^7, 10^7)$. Give your answer modulo $1\,000\,000\,007$.",REDACTED
pe-799,"Pentagonal numbers are generated by the formula: $P_n = \tfrac 12n(3n-1)$ giving the sequence:

$$1,5,12,22,35, 51,70,92,\ldots $$

Some pentagonal numbers can be expressed as the sum of two other pentagonal numbers.

For example:

$$P_8 = 92 = 22 + 70 = P_4 + P_7$$

$3577$ is the smallest pentagonal number that can be expressed as the sum of two pentagonal numbers in two different ways

$$
\begin{align}
P_{49} = 3577 &amp; = 3432 + 145 = P_{48} + P_{10} \\
 &amp; = 3290 + 287 = P_{47}+P_{14}
\end{align}
$$

$107602$ is the smallest pentagonal number that can be expressed as the sum of two pentagonal numbers in three different ways.

Find the smallest pentagonal number that can be expressed as the sum of two pentagonal numbers in over $100$ different ways.

Give your answer modulo $99991$.",REDACTED
pe-800,"An integer of the form $p^q q^p$ with prime numbers $p \neq q$ is called a hybrid-integer.

For example, $800 = 2^5 5^2$ is a hybrid-integer.

We define $C(n)$ to be the number of hybrid-integers less than or equal to $n$.

You are given $C(800) = 2$ and $C(800^{800}) = 10790$.

Find $C(800800^{800800})$.

Give your answer modulo $99991$.",REDACTED
pe-801,"The positive integral solutions of the equation $x^y=y^x$ are $(2,4)$, $(4,2)$ and $(k,k)$ for all $k &gt; 0$.

For a given positive integer $n$, let $f(n)$ be the number of integral values $0 &lt; x,y \leq n^2-n$ such that
$$x^y\equiv y^x \pmod n.$$
For example, $f(5)=104$ and $f(97)=1614336$.

Let $S(M,N)=\sum f(p)$ where the sum is taken over all primes $p$ satisfying $M\le p\le N$.

You are given $S(1,10^2)=7381000$ and $S(1,10^5) \equiv 701331986 \pmod{993353399}$.

Find $S(10^{16}, 10^{16}+10^6)$. Give your answer modulo $993353399$.",REDACTED
pe-802,"Let $\Bbb R^2$ be the set of pairs of real numbers $(x, y)$. Let $\pi = 3.14159\cdots\ $.

Consider the function $f$ from $\Bbb R^2$ to $\Bbb R^2$ defined by $f(x, y) = (x^2 - x - y^2, 2xy - y + \pi)$, and its $n$-th iterated composition $f^{(n)}(x, y) = f(f(\cdots f(x, y)\cdots))$. For example $f^{(3)}(x, y) = f(f(f(x, y)))$. A pair $(x, y)$ is said to have period $n$ if $n$ is the smallest positive integer such that $f^{(n)}(x, y) = (x, y)$.

Let $P(n)$ denote the sum of $x$-coordinates of all points having period not exceeding $n$.
Interestingly, $P(n)$ is always an integer. For example, $P(1) = 2$, $P(2) = 2$, $P(3) = 4$.

Find $P(10^7)$ and give your answer modulo $1\,020\,340\,567$.",REDACTED
pe-803,"Rand48 is a pseudorandom number generator used by some programming languages. It generates a sequence from any given integer $0 \le a_0 &lt; 2^{48}$ using the rule $a_n = (25214903917 \cdot a_{n - 1} + 11) \bmod 2^{48}$.

Let $b_n = \lfloor a_n / 2^{16} \rfloor \bmod 52$.
The sequence $b_0, b_1, \dots$ is translated to an infinite string $c = c_0c_1\dots$ via the rule:

$0 \rightarrow$ a, $1\rightarrow$ b, $\dots$, $25 \rightarrow$ z, $26 \rightarrow$ A, $27 \rightarrow$ B, $\dots$, $51 \rightarrow$ Z.

For example, if we choose $a_0 = 123456$, then the string $c$ starts with: ""bQYicNGCY$\dots$"".

Moreover, starting from index $100$, we encounter the substring ""RxqLBfWzv"" for the first time.

Alternatively, if $c$ starts with ""EULERcats$\dots$"", then $a_0$ must be $78580612777175$.

Now suppose that the string $c$ starts with ""PuzzleOne$\dots$"".

Find the starting index of the first occurrence of the substring ""LuckyText"" in $c$.",REDACTED
pe-804,"Let $g(n)$ denote the number of ways a positive integer $n$ can be represented in the form: $$x^2+xy+41y^2$$ where $x$ and $y$ are integers. For example, $g(53)=4$ due to $(x,y) \in \{(-4,1),(-3,-1),(3,1),(4,-1)\}$.

Define $\displaystyle T(N)=\sum_{n=1}^{N}g(n)$. You are given $T(10^3)=474$ and $T(10^6)=492128$.

Find $T(10^{16})$.

Give your answer modulo $99991$.",REDACTED
pe-805,"For a positive integer $n$, let $s(n)$ be the integer obtained by shifting the leftmost digit of the decimal representation of $n$ to the rightmost position.

For example, $s(142857)=428571$ and $s(10)=1$.

For a positive rational number $r$, we define $N(r)$ as the smallest positive integer $n$ such that $s(n)=r\cdot n$.

If no such integer exists, then $N(r)$ is defined as zero.

For example, $N(3)=142857$, $N(\tfrac 1{10})=10$ and $N(2) = 0$.

Let $T(M)$ be the sum of $N(u^3/v^3)$ where $(u,v)$ ranges over all ordered pairs of coprime positive integers not exceeding $M$.

For example, $T(3)\equiv 262429173 \pmod {1\,000\,000\,007}$.

Find $T(200)$. Give your answer modulo $1\,000\,000\,007$.",REDACTED
pe-808,"Both $169$ and $961$ are the square of a prime. $169$ is the reverse of $961$.

We call a number a reversible prime square if:

- It is not a palindrome, and

- It is the square of a prime, and

- Its reverse is also the square of a prime.

$169$ and $961$ are not palindromes, so both are reversible prime squares.

Find the sum of the first $50$ reversible prime squares.

Give your answer modulo $99991$.",REDACTED
pe-809,"The following is a function defined for all positive rational values of $x$.

$$	f(x)=\begin{cases} x  &amp;x\text{ is integral}\\
					f(\frac 1{1-x})	&amp;x \lt 1\\
					f\Big(\frac 1{\lceil x\rceil -x}-1+f(x-1)\Big)	&amp;\text{otherwise}\end{cases}	$$

For example, $f(3/2)=3$, $f(1/6) = 65533$ and $f(13/10) = 7625597484985$.

Find $f(22/7)$. Give your answer modulo $10^{15}$.",REDACTED
pe-810,"We use $x\oplus y$ for the bitwise XOR of $x$ and $y$.

Define the XOR-product of $x$ and $y$, denoted by $x \otimes y$, similar to a long multiplication in base $2$, except that the intermediate results are XORed instead of the usual integer addition.

For example, $7 \otimes 3 = 9$, or in base $2$, $111_2 \otimes 11_2 = 1001_2$:

$$
\begin{align*}
\phantom{\otimes 111} 111_2 \\
\otimes \phantom{1111} 11_2 \\
\hline
\phantom{\otimes 111} 111_2 \\
\oplus \phantom{11} 111_2  \phantom{9} \\
\hline
\phantom{\otimes 11} 1001_2 \\
\end{align*}
$$

An XOR-prime is an integer $n$ greater than $1$ that is not an XOR-product of two integers greater than $1$. The above example shows that $9$ is not an XOR-prime. Similarly, $5 = 3 \otimes 3$ is not an XOR-prime. The first few XOR-primes are $2, 3, 7, 11, 13, ...$ and the 10th XOR-prime is $41$.

Find the $5\,000\,000$th XOR-prime.

Give your answer modulo $99991$.",REDACTED
pe-811,"Let $b(n)$ be the largest power of 2 that divides $n$. For example $b(24) = 8$.

Define the recursive function:
$$\begin{align*}
\begin{split}
A(0) &amp;= 1\\
A(2n) &amp;= 3A(n) + 5A\big(2n - b(n)\big)  \qquad n \gt 0\\
A(2n+1) &amp;= A(n)
\end{split}
\end{align*}$$
and let $H(t,r) = A\big((2^t+1)^r\big)$.

You are given $H(3,2) = A(81) = 636056$.

Find $H(10^{14}+31,62)$. Give your answer modulo $1\,000\,062\,031$.",REDACTED
pe-812,"A dynamical polynomial is a monicleading coefficient is $1$ polynomial $f(x)$ with integer coefficients such that $f(x)$ divides $f(x^2-2)$.

For example, $f(x) = x^2 - x - 2$ is a dynamical polynomial because $f(x^2-2) = x^4-5x^2+4 = (x^2 + x -2)f(x)$.

Let $S(n)$ be the number of dynamical polynomials of degree $n$.

For example, $S(2)=6$, as there are six dynamical polynomials of degree $2$:

$$ x^2-4x+4 \quad,\quad x^2-x-2 \quad,\quad x^2-4 \quad,\quad x^2-1 \quad,\quad x^2+x-1 \quad,\quad x^2+2x+1 $$
Also, $S(5)=58$ and $S(20)=122087$.

Find $S(10\,000)$. Give your answer modulo $998244353$.",REDACTED
pe-813,"We use $x\oplus y$ to be the bitwise XOR of $x$ and $y$.

Define the XOR-product of $x$ and $y$, denoted by $x \otimes y$, similar to a long multiplication in base $2$, except that the intermediate results are XORed instead of the usual integer addition.

For example, $11 \otimes 11 = 69$, or in base $2$, $1011_2 \otimes 1011_2 = 1000101_2$:

$$
\begin{align*}
\phantom{\otimes 1111} 1011_2 \\
\otimes \phantom{1111} 1011_2 \\
\hline
\phantom{\otimes 1111} 1011_2 \\
\phantom{\otimes 111} 1011_2 \phantom{9} \\
\oplus \phantom{1} 1011_2  \phantom{999} \\
\hline
\phantom{\otimes 11} 1000101_2 \\
\end{align*}
$$
Further we define $P(n) = 11^{\otimes n} = \overbrace{11\otimes 11\otimes \ldots \otimes 11}^n$. For example $P(2)=69$.

Find $P(8^{12}\cdot 12^8)$. Give your answer modulo $10^9+7$.",REDACTED
pe-814,"$4n$ people stand in a circle with their heads down. When the bell rings they all raise their heads and either look at the person immediately to their left, the person immediately to their right or the person diametrically opposite. If two people find themselves looking at each other they both scream.

Define $S(n)$ to be the number of ways that exactly half of the people scream. You are given $S(1) =  48$ and $S(10) \equiv 420121075 \mod{998244353}$.

Find $S(10^3)$. Enter your answer modulo $998244353$.",REDACTED
pe-817,"Define $m = M(n, d)$ to be the smallest positive integer such that when $m^2$ is written in base $n$ it includes the base $n$ digit $d$. For example, $M(10,7) = 24$ because if all the squares are written out in base 10 the first time the digit 7 occurs is in $24^2 = 576$. $M(11,10) = 19$ as $19^2 = 361=2A9_{11}$.

Find $\displaystyle \sum_{d = 1}^{10^5}M(p, p - d)$ where $p = 10^9 + 7$.

Give your answer modulo $99991$.",REDACTED
pe-818,"The SET® card game is played with a pack of $81$ distinct cards. Each card has four features (Shape, Color, Number, Shading). Each feature has three different variants (e.g. Color can be red, purple, green).

A SET consists of three different cards such that each feature is either the same on each card or different on each card.

For a collection $C_n$ of $n$ cards, let $S(C_n)$ denote the number of SETs in $C_n$. Then define $F(n) = \sum\limits_{C_n} S(C_n)^4$ where $C_n$ ranges through all collections of $n$ cards (among the $81$ cards).
You are given $F(3) = 1080$ and $F(6) = 159690960$.

Find $F(12)$.

$\scriptsize{\text{SET is a registered trademark of Cannei, LLC.  All rights reserved.  
Used with permission from PlayMonster, LLC.}}$

Give your answer modulo $99991$.",REDACTED
pe-820,"Let $d_n(x)$ be the $n$th decimal digit of the fractional part of $x$, or $0$ if the fractional part has fewer than $n$ digits.

For example:

- $d_7 \mathopen{}\left( 1 \right)\mathclose{} = d_7 \mathopen{}\left( \frac 1 2 \right)\mathclose{} = d_7 \mathopen{}\left( \frac 1 4 \right)\mathclose{} = d_7 \mathopen{}\left( \frac 1 5 \right)\mathclose{} = 0$

- $d_7 \mathopen{}\left( \frac 1 3 \right)\mathclose{} = 3$ since $\frac 1 3 =$ 0.3333333333...

- $d_7 \mathopen{}\left( \frac 1 6 \right)\mathclose{} = 6$ since $\frac 1 6 =$ 0.1666666666...

- $d_7 \mathopen{}\left( \frac 1 7 \right)\mathclose{} = 1$ since $\frac 1 7 =$ 0.1428571428...

Let $\displaystyle  S(n) = \sum_{k=1}^n d_n \mathopen{}\left( \frac 1 k \right)\mathclose{}$.

You are given:

- $S(7) = 0 + 0 + 3 + 0 + 0 + 6 + 1 = 10$

- $S(100) = 418$

Find $S(10^7)$.

Give your answer modulo $99991$.",REDACTED
pe-821,"A set, $S$, of integers is called 123-separable if $S$, $2S$ and $3S$ are disjoint. Here $2S$ and $3S$ are obtained by multiplying all the elements in $S$ by $2$ and $3$ respectively.

Define $F(n)$ to be the maximum number of elements of
$$(S\cup 2S \cup 3S)\cap \{1,2,3,\ldots,n\}$$
where $S$ ranges over all 123-separable sets.

For example, $F(6) = 5$ can be achieved with either $S = \{1,4,5\}$ or $S = \{1,5,6\}$.

You are also given $F(20) = 19$.

Find $F(10^{16})$.

Give your answer modulo $99991$.",REDACTED
pe-822,"A list initially contains the numbers $2, 3, \dots, n$.

At each round, the smallest number in the list is replaced by its square. If there is more than one such number, then only one of them is replaced.

For example, below are the first three rounds for $n = 5$:
$$[2, 3, 4, 5] \xrightarrow{(1)} [4, 3, 4, 5] \xrightarrow{(2)} [4, 9, 4, 5] \xrightarrow{(3)} [16, 9, 4, 5].$$

Let $S(n, m)$ be the sum of all numbers in the list after $m$ rounds.

For example, $S(5, 3) = 16 + 9 + 4 + 5 = 34$. Also $S(10, 100) \equiv 845339386 \pmod{1234567891}$.

Find $S(10^4, 10^{16})$. Give your answer modulo $1234567891$.",REDACTED
pe-823,"A list initially contains the numbers $2, 3, \dots, n$.

At each round, every number in the list is divided by its smallest prime factor. Then the product of these smallest prime factors is added to the list as a new number. Finally, all numbers that become $1$ are removed from the list.

For example, below are the first three rounds for $n = 5$:
$$[2, 3, 4, 5] \xrightarrow{(1)} [2, 60] \xrightarrow{(2)} [30, 4] \xrightarrow{(3)} [15, 2, 4].$$
Let $S(n, m)$ be the sum of all numbers in the list after $m$ rounds.

For example, $S(5, 3) = 15 + 2 + 4 = 21$. Also $S(10, 100) = 257$.

Find $S(10^4, 10^{16})$. Give your answer modulo $1234567891$.",REDACTED
pe-824,"A Slider is a chess piece that can move one square left or right.

This problem uses a cylindrical chess board where the left hand edge of the board is connected to the right hand edge. This means that a Slider that is on the left hand edge of the chess board can move to the right hand edge of the same row and vice versa.

Let $L(N,K)$ be the number of ways $K$ non-attacking Sliders can be placed on an $N \times N$ cylindrical chess-board.

For example, $L(2,2)=4$ and $L(6,12)=4204761$.

Find $L(10^9,10^{15}) \bmod \left(10^7+19\right)^2$.",REDACTED
pe-827,"Define $Q(n)$ to be the smallest number that occurs in exactly $n$ Pythagorean triples $(a,b,c)$ where $a \lt b \lt c$.

For example, $15$ is the smallest number occurring in exactly $5$ Pythagorean triples:
$$(9,12,\mathbf{15})\quad (8,\mathbf{15},17)\quad (\mathbf{15},20,25)\quad (\mathbf{15},36,39)\quad (\mathbf{15},112,113)$$
and so $Q(5) = 15$.

You are also given $Q(10)=48$ and $Q(10^3)=8064000$.

Find $\displaystyle \sum_{k=1}^{18} Q(10^k)$. Give your answer modulo $409120391$.",REDACTED
pe-830,"Let $\displaystyle S(n)=\sum\limits_{k=0}^{n}\binom{n}{k}k^n$.

You are given, $S(10)=142469423360$.

Find $S(10^{18})$. Submit your answer modulo $83^3 89^3 97^3$.",REDACTED
pe-831,"Let $g(m)$ be the integer defined by the following double sum of products of binomial coefficients:

$$\sum_{j=0}^m\sum_{i = 0}^j (-1)^{j-i}\binom mj \binom ji \binom{j+5+6i}{j+5}.$$

You are given that $g(10) = 127278262644918$.
 Its first (most significant) five digits are $12727$.

Find the first ten digits of $g(142857)$ when written in base $7$.",REDACTED
pe-832,"In this problem $\oplus$ is used to represent the bitwise exclusive or of two numbers.

Starting with blank paper repeatedly do the following:

- Write down the smallest positive integer $a$ which is currently not on the paper;

- Find the smallest positive integer $b$ such that neither $b$ nor $(a \oplus b)$ is currently on the paper. Then write down both $b$ and $(a \oplus b)$.

After the first round $\{1,2,3\}$ will be written on the paper. In the second round $a=4$ and because $(4 \oplus 5)$, $(4 \oplus 6)$ and $(4 \oplus 7)$ are all already written $b$ must be $8$.

After $n$ rounds there will be $3n$ numbers on the paper. Their sum is denoted by $M(n)$.

For example, $M(10) = 642$ and $M(1000) = 5432148$.

Find $M(10^{18})$. Give your answer modulo $1\,000\,000\,007$.",REDACTED
pe-833,"Triangle numbers $T_k$ are integers of the form $\frac{k(k+1)} 2$.

A few triangle numbers happen to be perfect squares like $T_1=1$ and $T_8=36$, but more can be found when considering the product of two triangle numbers. For example, $T_2 \cdot T_{24}=3 \cdot 300=30^2$.

Let $S(n)$ be the sum of $c$ for all integers triples $(a, b, c)$ with $0&lt;c \le n$, $c^2=T_a \cdot T_b$ and $0&lt;a&lt;b$.
For example, $S(100)= \sqrt{T_1 T_8}+\sqrt{T_2 T_{24}}+\sqrt{T_1 T_{49}}+\sqrt{T_3 T_{48}}=6+30+35+84=155$.

You are given $S(10^5)=1479802$ and $S(10^9)=241614948794$.

Find $S(10^{35})$. Give your answer modulo $136101521$.",REDACTED
pe-834,"A sequence is created by starting with a positive integer $n$ and incrementing by $(n+m)$ at the $m^{th}$ step. 
If $n=10$, the resulting sequence will be $21,33,46,60,75,91,108,126,\ldots$.

Let $S(n)$ be the set of indices $m$, for which the $m^{th}$ term in the sequence is divisible by $(n+m)$.
 
For example, $S(10)=\{5,8,20,35,80\}$.

Define $T(n)$ to be the sum of the indices in $S(n)$. For example, $T(10) = 148$ and $T(10^2)=21828$.

Let $\displaystyle U(N)=\sum_{n=3}^{N}T(n)$. You are given, $U(10^2)=612572$.

Find $U(1234567)$.

Give your answer modulo $99991$.",REDACTED
pe-835,"A Pythagorean triangle is called supernatural if two of its three sides are consecutive 
 integers.

Let $S(N)$ be the sum of the perimeters of all distinct supernatural triangles with perimeters less than or equal  to $N$.

For example, $S(100) = 258$ and  $S(10000) = 172004$.

Find $S(10^{10^{10}})$. Give your answer modulo $1234567891$.",REDACTED
pe-839,"The sequence $S_n$ is defined by $S_0 = 290797$ and $S_n = S_{n - 1}^2 \bmod 50515093$ for $n &gt; 0$.

There are $N$ bowls indexed $0,1,\dots ,N-1$. Initially there are $S_n$ beans in bowl $n$.

At each step, the smallest index $n$ is found such that bowl $n$ has strictly more beans than bowl $n+1$. Then one bean is moved from bowl $n$ to bowl $n+1$.

Let $B(N)$ be the number of steps needed to sort the bowls into non-descending order.

For example, $B(5) = 0$, $B(6) = 14263289$ and $B(100)=3284417556$.

Find $B(10^7)$.",REDACTED
pe-840,"A partition of $n$ is a set of positive integers for which the sum equals $n$.

The partitions of 5 are:

$\{5\},\{1,4\},\{2,3\},\{1,1,3\},\{1,2,2\},\{1,1,1,2\}$ and $\{1,1,1,1,1\}$.

Further we define the function $D(p)$ as:

$$
\begin{align}
\begin{split}
D(1) &amp;= 1 \\
D(p) &amp;= 1, \text{ for any prime } p \\
D(pq) &amp;= D(p)q + pD(q), \text{ for any positive integers } p,q \gt 1.
\end{split}
\end{align}
$$

Now let $\{a_1, a_2,\ldots,a_k\}$ be a partition of $n$.

We assign to this particular partition the value:
 $$P=\prod_{j=1}^{k}D(a_j). $$

$G(n)$ is the sum of $P$ for all partitions of $n$.

We can verify that $G(10) = 164$.

We also define:
$$S(N)=\sum_{n=1}^{N}G(n).$$
You are given $S(10)=396$.

Find $S(5\times 10^4) \mod 999676999$.",REDACTED
pe-843,"This problem involves an iterative procedure that begins with a circle of $n\ge 3$ integers. At each step every number is simultaneously replaced with the absolute difference of its two neighbours.

For any initial values, the procedure eventually becomes periodic.

Let $S(N)$ be the sum of all possible periods for $3\le n \leq N$. For example, $S(6) = 6$, because the possible periods for $3\le n \leq 6$ are $1, 2, 3$. Specifically, $n=3$ and $n=4$ can each have period $1$ only, while $n=5$ can have period $1$ or $3$, and $n=6$ can have period $1$ or $2$.

You are also given $S(30) = 20381$.

Find $S(100)$.

Give your answer modulo $99991$.",REDACTED
pe-844,"Consider positive integer solutions to

$a^2+b^2+c^2 = 3abc$

For example, $(1,5,13)$ is a solution. We define a 3-Markov number to be any part of a solution, so $1$, $5$ and $13$ are all 3-Markov numbers. Adding distinct 3-Markov numbers $\le 10^3$ would give $2797$.

Now we define a $k$-Markov number to be a positive integer that is part of a solution to:

$\displaystyle \sum_{i=1}^{k}x_i^2=k\prod_{i=1}^{k}x_i,\quad x_i\text{ are positive integers}$

Let $M_k(N)$ be the sum of $k$-Markov numbers $\le N$. Hence $M_3(10^{3})=2797$, also $M_8(10^8) = 131493335$.

Define $\displaystyle S(K,N)=\sum_{k=3}^{K}M_k(N)$. You are given $S(4, 10^2)=229$ and $S(10, 10^8)=2383369980$.

Find $S(10^{18}, 10^{18})$. Give your answer modulo $1\,405\,695\,061$.",REDACTED
pe-845,"Let $D(n)$ be the $n$-th positive integer that has the sum of its digits a prime.

For example, $D(61) = 157$ and $D(10^8) = 403539364$.

Find $D(10^{16})$.

Give your answer modulo $99991$.",REDACTED
pe-847,"Jack has three plates in front of him. The giant has $N$ beans that he distributes to the three plates. All the beans look the same, but one of them is a magic bean. Jack doesn't know which one it is, but the giant knows.

Jack can ask the giant questions of the form: ""Does this subset of the beans contain the magic bean?"" In each question Jack may choose any subset of beans from a single plate, and the giant will respond truthfully.

If the three plates contain $a$, $b$ and $c$ beans respectively, we let $h(a, b, c)$ be the minimal number of questions Jack needs to ask in order to guarantee he locates the magic bean. For example, $h(1, 2, 3) = 3$ and $h(2, 3, 3) = 4$.

Let $H(N)$ be the sum of $h(a, b, c)$ over all triples of non-negative integers $a$, $b$, $c$ with $1 \leq a + b + c \leq N$.

You are given: $H(6) = 203$ and $H(20) = 7718$.

A repunit, $R_n$, is a number made up with $n$ digits all '1'. For example, $R_3 = 111$ and $H(R_3) = 1634144$.

Find $H(R_{19})$. Give your answer modulo  $1\,000\,000\,007$.",REDACTED
pe-849,"In a tournament there are $n$ teams and each team plays each other team twice. A team gets two points for a win, one point for a draw and no points for a loss.

With two teams there are three possible outcomes for the total points. $(4,0)$ where a team wins twice, $(3,1)$ where a team wins and draws, and $(2,2)$ where either there are two draws or a team wins one game and loses the other. Here we do not distinguish the teams and so $(3,1)$ and $(1,3)$ are considered identical.

Let $F(n)$ be the total number of possible final outcomes with $n$ teams, so that $F(2) = 3$.

You are also given $F(7) = 32923$.

Find $F(100)$. Give your answer modulo $10^9+7$.",REDACTED
pe-850,"Any positive real number $x$ can be decomposed into integer and fractional parts $\lfloor x \rfloor + \{x\}$, where $\lfloor x \rfloor$ (the floor function) is an integer, and $0\le \{x\} &lt; 1$.

For positive integers $k$ and $n$, define the function
$$\begin{align}
f_k(n) = \sum_{i=1}^{n}\left\{ \frac{i^k}{n} \right\}
\end{align}$$
For example, $f_5(10)=4.5$ and $f_7(1234)=616.5$.

Let
$$\begin{align}
S(N) = \sum_{\substack{k=1 \\ k\text{ odd}}}^{N} \sum_{n=1}^{N}  f_k(n)
\end{align}$$
You are given that $S(10)=100.5$ and $S(10^3)=123687804$.

Find $\lfloor S(33557799775533) \rfloor$. Give your answer modulo 977676779.",REDACTED
pe-851,"Let $n$ be a positive integer and let $E_n$ be the set of $n$-tuples of strictly positive integers.

For $u = (u_1, \cdots, u_n)$ and $v = (v_1, \cdots, v_n)$ two elements of $E_n$, we define:

- the Sum Of Products of $u$ and $v$, denoted by $\langle u, v\rangle$, as the sum $\displaystyle\sum_{i = 1}^n u_i v_i$;

- the Product Of Sums of $u$ and $v$, denoted by $u \star v$, as the product $\displaystyle\prod_{i = 1}^n (u_i + v_i)$.

Let $R_n(M)$ be the sum of $u \star v$ over all ordered pairs $(u, v)$ in $E_n$ such that $\langle u, v\rangle = M$.

For example: $R_1(10) = 36$, $R_2(100) = 1873044$, $R_2(100!) \equiv 446575636 \bmod 10^9 + 7$.

Find $R_6(10000!)$. Give your answer modulo $10^9+7$.",REDACTED
pe-853,"For every positive integer $n$ the Fibonacci sequence modulo 
$n$ is periodic. The period depends on the value of $n$.
This period is called the Pisano period for $n$, often shortened to $\pi(n)$.

There are three values of $n$ for which 
$\pi(n)$ equals $18$: $19$, $38$ and $76$. The sum of those smaller than $50$ is $57$.

Find the sum of the values of $n$ smaller than $1\,000\,000\,000$ for which $\pi(n)$ equals $120$.",REDACTED
pe-854,"For every positive integer $n$ the Fibonacci sequence modulo $n$ is periodic. The period depends on the value of $n$.
This period is called the Pisano period for $n$, often shortened to $\pi(n)$.

Define $M(p)$ as the largest integer $n$ such that $\pi(n) = p$, and define $M(p) = 1$ if there is no such $n$.

For example, there are three values of $n$ for which $\pi(n)$ equals $18$: $19, 38, 76$. Therefore $M(18) = 76$.

Let the product function $P(n)$ be: $$P(n)=\prod_{p = 1}^{n}M(p).$$
You are given: $P(10)=264$.

Find $P(1\,000\,000)\bmod 1\,234\,567\,891$.",REDACTED
pe-858,"Define $G(N) = \sum_S \operatorname{lcm}(S)$ where $S$ ranges through all subsets of $\{1, \dots, N\}$ and $\operatorname{lcm}$ denotes the lowest common multiple. Note that the $\operatorname{lcm}$ of the empty set is $1$.

You are given $G(5) = 528$ and $G(20) = 8463108648960$.

Find $G(800)$. Give your answer modulo $10^9 + 7$.",REDACTED
pe-859,"Odd and Even are playing a game with $N$ cookies.

The game begins with the $N$ cookies divided into one or more piles, not necessarily of the same size. They then make moves in turn, starting with Odd.

Odd's turn: Odd may choose any pile with an odd number of cookies, eat one and divide the remaining (if any) into two equal piles.

Even's turn: Even may choose any pile with an even number of cookies, eat two of them and divide the remaining (if any) into two equal piles.

The player that does not have a valid move loses the game.

Let $C(N)$ be the number of ways that $N$ cookies can be divided so that Even has a winning strategy.

For example, $C(5) = 2$ because there are two winning configurations for Even: a single pile containing all five cookies; three piles containing one, two and two cookies.

You are also given $C(16) = 64$.

Find $C(300)$.

Give your answer modulo $99991$.",REDACTED
pe-861,"A unitary divisor of a positive integer $n$ is a divisor $d$ of $n$ such that $\gcd\left(d,\frac{n}{d}\right)=1$.

A bi-unitary divisor of $n$ is a divisor $d$ for which $1$ is the only unitary divisor of $d$ that is also a unitary divisor of $\frac{n}{d}$.

For example, $2$ is a bi-unitary divisor of $8$, because the unitary divisors of $2$ are $\{1,2\}$, and the unitary divisors of $8/2$ are $\{1,4\}$, with $1$ being the only unitary divisor in common.

The bi-unitary divisors of $240$ are $\{1,2,3,5,6,8,10,15,16,24,30,40,48,80,120,240\}$.

Let $P(n)$ be the product of all bi-unitary divisors of $n$. Define $Q_k(N)$ as the number of positive integers $1 \lt n \leq N$ such that $P(n)=n^k$. For example, $Q_2\left(10^2\right)=51$ and $Q_6\left(10^6\right)=6189$.

Find $\sum_{k=2}^{10}Q_k\left(10^{12}\right)$.

Give your answer modulo $99991$.",REDACTED
pe-862,"For a positive integer $n$ define $T(n)$ to be the number of strictly larger integers which can be formed by permuting the digits of $n$.

Leading zeros are not allowed and so for $n = 2302$ the total list of permutations would be:

$2023,2032,2203,2230,\mathbf{2302},2320,3022,32 02,3220$

giving $T(2302)=4$.

Further define $S(k)$ to be the sum of $T(n)$ for all $k$-digit numbers $n$. You are given $S(3) = 1701$.

Find $S(12)$.

Give your answer modulo $99991$.",REDACTED
pe-864,"Let $C(n)$ be the number of squarefree integers of the form $x^2 + 1$ such that $1 \le x \le n$.

For example, $C(10) = 9$ and $C(1000) = 895$.

Find $C(123567101113)$.

Give your answer modulo $99991$.",REDACTED
pe-865,"A triplicate number is a positive integer such that, after repeatedly removing three consecutive identical digits from it, all its digits can be removed.

For example, the integer $122555211$ is a triplicate number:
$$122{\color{red}555}211 \rightarrow 1{\color{red}222}11\rightarrow{\color{red}111}\rightarrow.$$
On the other hand, neither $663633$ nor $9990$ are triplicate numbers.

Let $T(n)$ be how many triplicate numbers are less than $10^n$.

For example, $T(6) = 261$ and $T(30) = 5576195181577716$.

Find $T(10^4)$. Give your answer modulo $998244353$.",REDACTED
pe-866,"A small child has a “number caterpillar” consisting of $N$ jigsaw pieces, each with one number on it, which, when connected together in a line, reveal the numbers $1$ to $N$ in order.

Every night, the child's father has to pick up the pieces of the caterpillar that have been scattered across the play room. He picks up the pieces at random and places them in the correct order.

As the caterpillar is built up in this way, it forms distinct segments that gradually merge together.

Any time the father places a new piece in its correct position, a segment of length $k$ is formed and he writes down the $k$th hexagonal number $k\cdot(2k-1)$. Once all pieces have been placed and the full caterpillar constructed he calculates the product of all the numbers written down. Interestingly, the expected value of this product is always an integer. For example if $N=4$ then the expected value is $994$.

Find the expected value of the product for a caterpillar of $N=100$ pieces.
Give your answer modulo $987654319$.",REDACTED
pe-868,"There is a method that is used by Bell ringers to generate all variations of the order that bells are rung.

The same method can be used to create all permutations of a set of letters. Consider the letters to be permuted initially in order from smallest to largest. At each step swap the largest letter with the letter on its left or right whichever generates a permutation that has not yet been seen. If neither gives a new permutation then try the next largest letter and so on. This procedure continues until all permutations have been generated.

For example, $3$ swaps are required to reach the permutation CBA when starting with ABC.

The swaps are ABC $\to$ ACB $\to$ CAB $\to$ CBA.

Also $59$ swaps are required to reach BELFRY when starting with these letters in alphabetical order.

Find the number of swaps that are required to reach NOWPICKBELFRYMATHS when starting with these letters in alphabetical order.

Give your answer modulo $99991$.",REDACTED
pe-871,"Let $f$ be a function from a finite set $S$ to itself. A drifting subset for $f$ is a subset $A$ of $S$ such that the number of elements in the union $A \cup f(A)$ is equal to twice the number of elements of $A$.

We write $D(f)$ for the maximal number of elements among all drifting subsets for $f$.

For a positive integer $n$, define $f_n$ as the function from $\{0, 1, \dots, n - 1\}$ to itself sending $x$ to $x^3 + x + 1 \bmod n$.

You are given $D(f_5) = 1$ and $D(f_{10}) = 3$.

Find $\displaystyle\sum_{i = 1}^{100} D(f_{10^5 + i})$.",REDACTED
pe-873,"Let $W(p,q,r)$ be the number of words that can be formed using the letter A $p$ times, the letter B $q$ times and the letter C $r$ times with the condition that every A is separated from every B by at least two Cs. For example, CACACCBB is a valid word for $W(2,2,4)$ but ACBCACBC is not.

You are given $W(2,2,4)=32$ and $W(4,4,44)=13908607644$.

Find $W(10^6,10^7,10^8)$. Give your answer modulo $1\,000\,000\,007$.",REDACTED
pe-874,"Let $p(t)$ denote the $(t+1)$th prime number. So that $p(0) = 2$, $p(1) = 3$, etc.

We define the prime score of a list of nonnegative integers $[a_1, \dots, a_n]$ as the sum $\sum_{i = 1}^n p(a_i)$.

Let $M(k, n)$ be the maximal prime score among all lists $[a_1, \dots, a_n]$ such that:

-  $0 \leq a_i &lt; k$ for each $i$;

-  the sum $\sum_{i = 1}^n a_i$ is a multiple of $k$.

For example, $M(2, 5) = 14$ as $[0, 1, 1, 1, 1]$ attains a maximal prime score of $14$.

Find $M(7000, p(7000))$.

Give your answer modulo $99991$.",REDACTED
pe-875,"For a positive integer $n$ we define $q(n)$ to be the number of solutions to:

$$a_1^2+a_2^2+a_3^2+a_4^2 \equiv b_1^2+b_2^2+b_3^2+b_4^2 \pmod n$$
where $0 \leq a_i, b_i \lt n$. For example, $q(4)= 18432$.

Define $\displaystyle Q(n)=\sum_{i=1}^{n}q(i)$. You are given $Q(10)=18573381$.

Find $Q(12345678)$. Give your answer modulo $1001961001$.",REDACTED
pe-876,"Starting with three numbers $a, b, c$, at each step do one of the three operations:

- change $a$ to $2(b + c) - a$;

- change $b$ to $2(c + a) - b$;

- change $c$ to $2(a + b) - c$;

Define $f(a, b, c)$ to be the minimum number of steps required for one number to become zero. If this is not possible then $f(a, b, c)=0$.

For example, $f(6,10,35)=3$:
$$(6,10,35) \to (6,10,-3) \to (8,10,-3) \to (8,0,-3).$$
However, $f(6,10,36)=0$ as no series of operations leads to a zero number.

Also define $F(a, b)=\sum_{c=1}^\infty f(a,b,c)$.
You are given $F(6,10)=17$ and $F(36,100)=179$.

Find $\displaystyle\sum_{k=1}^{18}F(6^k,10^k)$.

Give your answer modulo $99991$.",REDACTED
pe-877,"We use $x\oplus y$ for the bitwise XOR of $x$ and $y$.

Define the XOR-product of $x$ and $y$, denoted by $x \otimes y$, similar to a long multiplication in base $2$, except that the intermediate results are XORed instead of the usual integer addition.

For example, $7 \otimes 3 = 9$, or in base $2$, $111_2 \otimes 11_2 = 1001_2$:

$$\begin{align*}
\phantom{\otimes 111} 111_2 \\
\otimes \phantom{1111} 11_2 \\
\hline
\phantom{\otimes 111} 111_2 \\
\oplus \phantom{11} 111_2  \phantom{9} \\
\hline
\phantom{\otimes 11} 1001_2 \\
\end{align*}$$

We consider the equation:

$$\begin{align}
(a \otimes a) \oplus (2 \otimes a \otimes b) \oplus (b \otimes b) = 5
\end{align}$$

For example, $(a, b) = (3, 6)$ is a solution.

Let $X(N)$ be the XOR of the $b$ values for all solutions to this equation satisfying $0 \le a \le b \le N$.
 You are given $X(10)=5$.

Find $X(10^{18})$.

Give your answer modulo $99991$.",REDACTED
pe-878,"We use $x\oplus y$ for the bitwise XOR of $x$ and $y$.

Define the XOR-product of $x$ and $y$, denoted by $x \otimes y$, similar to a long multiplication in base $2$, except that the intermediate results are XORed instead of the usual integer addition.

For example, $7 \otimes 3 = 9$, or in base $2$, $111_2 \otimes 11_2 = 1001_2$:

$$\begin{align*}
\phantom{\otimes 111} 111_2 \\
\otimes \phantom{1111} 11_2 \\
\hline
\phantom{\otimes 111} 111_2 \\
\oplus \phantom{11} 111_2  \phantom{9} \\
\hline
\phantom{\otimes 11} 1001_2 \\
\end{align*}$$

We consider the equation:

$$\begin{align}
(a \otimes a) \oplus (2 \otimes a \otimes b) \oplus (b \otimes b) = k.
\end{align}$$

For example, $(a, b) = (3, 6)$ is a solution to this equation for $k=5$.

Let $G(N,m)$ be the number of solutions to those equations with $k \le m$ and $0 \le a \le b \le N$.

You are given $G(1000,100)=398$.

Find $G(10^{17},1\,000\,000).$

Give your answer modulo $99991$.",REDACTED
pe-880,"$(x,y)$ is called a nested radical pair if $x$ and $y$ are non-zero integers such that $\dfrac{x}{y}$ is not a cube of a rational number, and there exist integers $a$, $b$ and $c$ such that:

$$\sqrt{\sqrt[3]{x}+\sqrt[3]{y}}=\sqrt[3]{a}+\sqrt[3]{b}+\sqrt[3]{c}$$
For example, both $(-4,125)$ and $(5,5324)$ are nested radical pairs:

$$
\begin{align*}
\begin{split}
\sqrt{\sqrt[3]{-4}+\sqrt[3]{125}}	&amp;= \sqrt[3]{-1}+\sqrt[3]{2}+\sqrt[3]{4}\\
\sqrt{\sqrt[3]{5}+\sqrt[3]{5324}}	&amp;= \sqrt[3]{-2}+\sqrt[3]{20}+\sqrt[3]{25}\\
\end{split}
\end{align*}
$$

Let $H(N)$ be the sum of $|x|+|y|$ for all the nested radical pairs $(x, y)$ where $|x| \leq |y|\leq N$.
 
For example, $H(10^3)=2535$.

Find $H(10^{15})$. Give your answer modulo $1031^3+2$.",REDACTED
pe-882,"Dr. One and Dr. Zero are playing the following partisan game.

The game begins with one $1$, two $2$'s, three $3$'s, ..., $n$ $n$'s. Starting with Dr. One, they make moves in turn.

Dr. One chooses a number and changes it by removing a $1$ from its binary expansion.

Dr. Zero chooses a number and changes it by removing a $0$ from its binary expansion.

The player that is unable to move loses.

Note that leading zeros are not allowed in any binary expansion; in particular nobody can make a move on the number $0$.

They soon realize that Dr. Zero can never win the game. In order to make it more interesting, Dr. Zero is allowed to ""skip the turn"" several times, i.e. passing the turn back to Dr. One without making a move.

For example, when $n = 2$, Dr. Zero can win the game if allowed to skip $2$ turns. A sample game:
$$
[1, 2, 2]\xrightarrow{\textrm{Dr. One}}[1, 0, 2]\xrightarrow{\textrm{Dr. Zero}}[1, 0, 1]\xrightarrow{\textrm{Dr. One}}[1, 0, 0]\xrightarrow[\textrm{skip}]{\textrm{Dr. Zero}}
[1, 0, 0]\xrightarrow{\textrm{Dr. One}}[0, 0, 0]\xrightarrow[\textrm{skip}]{\textrm{Dr. Zero}}[0, 0, 0].
$$
Let $S(n)$ be the minimal number of skips needed so that Dr. Zero has a winning strategy.

For example, $S(2) = 2$, $S(5) = 17$, $S(10) = 64$.

Find $S(10^5)$.

Give your answer modulo $99991$.",REDACTED
pe-884,"Starting from a positive integer $n$, at each step we subtract from $n$ the largest perfect cube not exceeding $n$, until $n$ becomes $0$.

For example, with $n = 100$ the procedure ends in $4$ steps:
$$100 \xrightarrow{-4^3} 36 \xrightarrow{-3^3} 9 \xrightarrow{-2^3} 1 \xrightarrow{-1^3} 0.$$
Let $D(n)$ denote the number of steps of the procedure. Thus $D(100) = 4$.

Let $S(N)$ denote the sum of $D(n)$ for all positive integers $n$ strictly less than $N$.

For example, $S(100) = 512$.

Find $S(10^{17})$.

Give your answer modulo $99991$.",REDACTED
pe-885,"For a positive integer $d$, let $f(d)$ be the number created by sorting the digits of $d$ in ascending order, removing any zeros. For example, $f(3403) = 334$.

Let $S(n)$ be the sum of $f(d)$ for all positive integers $d$ of $n$ digits or less. You are given $S(1) = 45$ and $S(5) = 1543545675$.

Find $S(18)$. Give your answer modulo $1123455689$.",REDACTED
pe-886,"A permutation of $\{2,3,\ldots,n\}$ is a rearrangement of these numbers. A coprime permutation is a rearrangement such that all pairs of adjacent numbers are coprime.

Let $P(n)$ be the number of coprime permutations of $\{2,3,\ldots,n\}$.

For example, $P(4)=2$ as there are two coprime permutations, $(2,3,4)$ and $(4,3,2)$. You are also given $P(10)=576$.

Find $P(34)$ and give your answer modulo $83\,456\,729$.",REDACTED
pe-887,"Consider the problem of determining a secret number from a set $\{1, ..., N\}$ by repeatedly choosing a number $y$ and asking ""Is the secret number greater than $y$?"".

If $N=1$ then no questions need to be asked. If $N=2$ then only one question needs to be asked. If $N=64$ then six questions need to be asked. However, in the latter case if the secret number is $1$ then six questions still need to be asked. We want to restrict the number of questions asked for small values.

Let $Q(N, d)$ be the least number of questions needed for a strategy that can find any secret number from the set $\{1, ..., N\}$ where no more than $x + d$ questions are needed to find the secret value $x$.

It can be proved that $Q(N, 0) = N - 1$. You are also given $Q(7, 1) = 3$ and $Q(777, 2) = 10$.

Find $\displaystyle \sum_{d=0}^7 \sum_{N=1}^{7^{10}} Q(N, d)$.

Give your answer modulo $99991$.",REDACTED
pe-888,"Two players play a game with a number of piles of stones, alternating turns. Each turn a player can choose to remove 1, 2, 4, or 9 stones from a single pile; or alternatively they can choose to split a pile containing two or more stones into two non-empty piles. The winner is the player who removes the last stone.

A collection of piles is called a losing position if the player to move cannot force a win with optimal play. Define $S(N, m)$ to be the number of distinct losing positions arising from $m$ piles of stones where each pile contains from $1$ to $N$ stones. Two positions are considered equivalent if they consist of the same pile sizes. That is, the order of the piles does not matter.

You are given $S(12,4)=204$ and $S(124,9)=2259208528408$.

Find $S(12491249,1249)$. Give your answer modulo $912491249$.",REDACTED
pe-890,"Let $p(n)$ be the number of ways to write $n$ as the sum of powers of two, ignoring order.

For example, $p(7) = 6$, the partitions being
$$
\begin{align}
7 &amp;= 1+1+1+1+1+1+1 \\
&amp;=1+1+1+1+1+2 \\
&amp;=1+1+1+2+2 \\
&amp;=1+1+1+4 \\
&amp;=1+2+2+2 \\
&amp;=1+2+4
\end{align}
$$
You are also given $p(7^7) \equiv 144548435 \pmod {10^9+7}$.

Find $p(7^{777})$. Give your answer modulo $10^9 + 7$.",REDACTED
pe-896,"A contiguous range of positive integers is called a divisible range if all the integers in the range can be arranged in a row such that the $n$-th term is a multiple of $n$.

For example, the range $[6..9]$ is a divisible range because we can arrange the numbers as $7,6,9,8$.

In fact, it is the $4$th divisible range of length $4$, the first three being $[1..4], [2..5], [3..6]$.

Find the $36$th divisible range of length $36$.

Give as answer the smallest number in the range.

Give your answer modulo $99991$.",REDACTED
pe-899,"Two players play a game with two piles of stones. The players alternately take stones from one or both piles, subject to:

- the total number of stones taken is equal to the size of the smallest pile before the move;

- the move cannot take all the stones from a pile.

The player that is unable to move loses.

For example, if the piles are of sizes 3 and 5 then there are three possible moves.
$$(3,5) \xrightarrow{(2,1)} (1,4)\qquad\qquad (3,5) \xrightarrow{(1,2)} (2,3)\qquad\qquad (3,5) \xrightarrow{(0,3)} (3,2)$$

Let $L(n)$ be the number of ordered pairs $(a,b)$ with $1 \leq a,b \leq n$ such that the initial game position with piles of sizes $a$ and $b$ is losing for the first player assuming optimal play.

You are given $L(7) = 21$ and $L(7^2) = 221$.

Find $L(7^{17})$.

Give your answer modulo $99991$.",REDACTED
pe-900,"Two players play a game with at least two piles of stones. The players alternately take stones from one or more piles, subject to:

- the total number of stones taken is equal to the size of the smallest pile before the move;

- the move cannot take all the stones from a pile.

The player that is unable to move loses.

For example, if the piles are of sizes 2, 2 and 4 then there are four possible moves.
$$ (2,2,4)\xrightarrow{(1,1,0)}(1,1,4)\quad (2,2,4)\xrightarrow{(1,0,1)}(1,2,3)\quad
(2,2,4)\xrightarrow{(0,1,1)}(2,1,3)\quad (2,2,4)\xrightarrow{(0,0,2)}(2,2,2)$$

Let $t(n)$ be the smallest nonnegative integer $k$ such that the position with $n$ piles of $n$ stones and a single pile of $n+k$ stones is losing for the first player assuming optimal play.  For example, $t(1) = t(2) = 0$ and $t(3) = 2$.

Define $\displaystyle S(N) = \sum_{n=1}^{2^N} t(n)$.  You are given $S(10) = 361522$.

Find $S(10^4)$. Give your answer modulo $900497239$.",REDACTED
pe-902,"A permutation $\pi$ of $\{1, \dots, n\}$ can be represented in one-line notation as $\pi(1),\ldots,\pi(n) $. If all $n!$ permutations are written in lexicographic order then $\textrm{rank}(\pi)$ is the position of $\pi$ in this 1-based list.

For example, $\text{rank}(2,1,3) = 3$ because the six permutations of $\{1, 2, 3\}$ in lexicographic order are:
$$1, 2, 3\quad 1, 3, 2 \quad 2, 1, 3 \quad 2, 3, 1 \quad 3, 1, 2 \quad 3, 2, 1$$

For a positive integer $m$, we define the following permutation of $\{1, \dots, n\}$ with $n = \frac{m(m+1)}2$:
$$
\begin{align}
\sigma(i) &amp;= \begin{cases} \frac{k(k-1)}2 + 1 &amp; \textrm{if } i = \frac{k(k + 1)}2\textrm{ for }k\in\{1, \dots, m\};\\i + 1 &amp; \textrm{otherwise};\end{cases}\\
\tau(i) &amp;= ((10^9 + 7)i \bmod n) + 1\\
\pi(i) &amp;= \tau^{-1}(\sigma(\tau(i)))
\end{align}
$$
where $\tau^{-1}$ is the inverse permutation of $\tau$.

Define $\displaystyle P(m) = \sum_{k=1}^{m!} \text{rank}(\pi^k)$, where $\pi^k$ is the permutation arising from applying $\pi$ $k$ times.

For example, $P(2) = 4$, $P(3) = 780$ and $P(4) = 38810300$.

Find $P(100)$. Give your answer modulo  $(10^9 + 7)$.",REDACTED
pe-903,"A permutation $\pi$ of $\{1, \dots, n\}$ can be represented in one-line notation as $\pi(1),\ldots,\pi(n) $. If all $n!$ permutations are written in lexicographic order then $\textrm{rank}(\pi)$ is the position of $\pi$ in this 1-based list.

For example, $\text{rank}(2,1,3) = 3$ because the six permutations of $\{1, 2, 3\}$ in lexicographic order are:
$$1, 2, 3\quad 1, 3, 2 \quad 2, 1, 3 \quad 2, 3, 1 \quad 3, 1, 2 \quad 3, 2, 1$$

Let $Q(n)$ be the sum $\sum_{\pi}\sum_{i = 1}^{n!} \text{rank}(\pi^i)$, where $\pi$ ranges over all permutations of $\{1, \dots, n\}$, and $\pi^i$ is the permutation arising from applying $\pi$ $i$ times.

For example, $Q(2) = 5$, $Q(3) = 88$, $Q(6) = 133103808$ and $Q(10) \equiv 468421536 \pmod {10^9 + 7}$.

Find $Q(10^6)$. Give your answer modulo  $(10^9 + 7)$.",REDACTED
pe-905,"Three epistemologists, known as A, B, and C, are in a room, each wearing a hat with a number on it. They have been informed beforehand that all three numbers are positive and that one of the numbers is the sum of the other two.

Once in the room, they can see the numbers on each other's hats but not on their own. Starting with A and proceeding cyclically, each epistemologist must either honestly state ""I don't know my number"" or announce ""Now I know my number!"" which terminates the game.

For instance, if their numbers are $A=2, B=1, C=1$ then A declares ""Now I know"" at the first turn. If their numbers are $A=2, B=7, C=5$ then ""I don't know"" is heard four times before B finally declares ""Now I know"" at the fifth turn.

Let $F(A,B,C)$ be the number of turns it takes until an epistemologist declares ""Now I know"", including the turn this declaration is made. So $F(2,1,1)=1$ and $F(2,7,5)=5$.

Find $\displaystyle \sum_{a=1}^7 \sum_{b=1}^{19} F(a^b, b^a, a^b + b^a)$.

Give your answer modulo $99991$.",REDACTED
pe-908,"A clock sequence is a periodic sequence of positive integers that can be broken into contiguous segments such that the sum of the $n$-th segment is equal to $n$.

For example, the sequence $$1\ 2\ 3\ 4\ 3\ 2\ 1\ 2\ 3\ 4\ 3\ 2\ 1\ 2\ 3\ 4\ 3\ 2\ 1\ \cdots$$ is a clock sequence with period $6$, as it can be broken into $$1\Big |2\Big |3\Big |4\Big |3\ 2\Big |1\ 2\ 3\Big |4\ 3\Big |2\ 1\ 2\ 3\Big |4\ 3\ 2\Big |1\ 2\ 3\ 4\Big |3\ 2\ 1\ 2\ 3\Big |\cdots$$
Let $C(N)$ be the number of different clock sequences with period at most $N$.
For example, $C(3) = 3$, $C(4) = 7$ and $C(10) = 561$.

Find $C(10^4) \bmod 1111211113$.",REDACTED
pe-909,"An L-expression is defined as any one of the following:

- a natural number;

- the symbol $A$;

- the symbol $Z$;

- the symbol $S$;

- a pair of L-expressions $u, v$, which is written as $u(v)$.

An L-expression can be transformed according to the following rules:

- $A(x) \to x + 1$ for any natural number $x$;

- $Z(u)(v) \to v$ for any L-expressions $u, v$;

- $S(u)(v)(w) \to v(u(v)(w))$ for any L-expressions $u, v, w$.

For example, after applying all possible rules, the L-expression $S(Z)(A)(0)$ is transformed to the number $1$:
$$S(Z)(A)(0) \to A(Z(A)(0)) \to A(0) \to 1.$$
Similarly, the L-expression $S(S)(S(S))(S(Z))(A)(0)$ is transformed to the number $6$ after applying all possible rules.

Find the result of the L-expression $S(S)(S(S))(S(S))(S(Z))(A)(0)$ after applying all possible rules. Give the last nine digits as your answer.

Note: it can be proved that the L-expression in question can only be transformed a finite number of times, and the final result does not depend on the order of the transformations.",REDACTED
pe-910,"An L-expression is defined as any one of the following:

- a natural number;

- the symbol $A$;

- the symbol $Z$;

- the symbol $S$;

- a pair of L-expressions $u, v$, which is written as $u(v)$.

An L-expression can be transformed according to the following rules:

- $A(x) \to x + 1$ for any natural number $x$;

- $Z(u)(v) \to v$ for any L-expressions $u, v$;

- $S(u)(v)(w) \to v(u(v)(w))$ for any L-expressions $u, v, w$.

For example, after applying all possible rules, the L-expression $S(Z)(A)(0)$ is transformed to the number $1$:
$$S(Z)(A)(0) \to A(Z(A)(0)) \to A(0) \to 1.$$
Similarly, the L-expression $S(S)(S(S))(S(Z))(A)(0)$ is transformed to the number $6$ after applying all possible rules.

Define the following L-expressions:

- $C_0 = Z$;

- $C_i = S(C_{i - 1})$ for $i \ge 1$;

- $D_i = C_i(S)(S)$.

For natural numbers $a, b, c, d, e$, let $F(a, b, c, d, e)$ denote the result of the L-expression $D_a(D_b)(D_c)(C_d)(A)(e)$ after applying all possible rules.

Find the last nine digits of $F(12, 345678, 9012345, 678, 90)$.

Note: it can be proved that the L-expression in question can only be transformed a finite number of times, and the final result does not depend on the order of the transformations.",REDACTED
pe-912,"Let $s_n$ be the $n$-th positive integer that does not contain three consecutive ones in its binary representation.

For example, $s_1 = 1$ and $s_7 = 8$.

Define $F(N)$ to be the sum of $n^2$ for all $n\leq N$ where $s_n$ is odd. You are given $F(10)=199$.

Find $F(10^{16})$ giving your answer modulo $10^9+7$.",REDACTED
pe-913,"The numbers from $1$ to $12$ can be arranged into a $3 \times 4$ matrix in either row-major or column-major order:
$$R=\begin{pmatrix}
1 &amp; 2 &amp; 3 &amp; 4\\
5 &amp; 6 &amp; 7 &amp; 8\\
9 &amp; 10 &amp; 11 &amp; 12\end{pmatrix}, C=\begin{pmatrix}
1 &amp; 4 &amp; 7 &amp; 10\\
2 &amp; 5 &amp; 8 &amp; 11\\
3 &amp; 6 &amp; 9 &amp; 12\end{pmatrix}$$
By swapping two entries at a time, at least $8$ swaps are needed to transform $R$ to $C$.

Let $S(n, m)$ be the minimal number of swaps needed to transform an $n\times m$ matrix of $1$ to $nm$ from row-major order to column-major order. Thus $S(3, 4) = 8$.

You are given that the sum of $S(n, m)$ for $2 \leq n \leq m \leq 100$ is $12578833$.

Find the sum of $S(n^4, m^4)$ for $2 \leq n \leq m \leq 100$.

Give your answer modulo $99991$.",REDACTED
pe-914,"For a given integer $R$ consider all primitive Pythagorean triangles that can fit inside, without touching, a circle with radius $R$. Define $F(R)$ to be the largest inradius of those triangles. You are given $F(100) = 36$.

Find $F(10^{18})$.

Give your answer modulo $99991$.",REDACTED
pe-915,"The function $s(n)$ is defined recursively for positive integers by 
$s(1) = 1$ and $s(n+1) = \big(s(n) - 1\big)^3 +2$ for $n\geq 1$.
 
The sequence begins: $s(1) = 1, s(2) = 2, s(3) = 3, s(4) = 10, \ldots$.

For positive integers $N$, define $$T(N) = \sum_{a=1}^N \sum_{b=1}^N \gcd\Big(s\big(s(a)\big), s\big(s(b)\big)\Big).$$  You are given $T(3) = 12$, $T(4) \equiv 24881925$ and $T(100)\equiv 14416749$ both modulo $123456789$.

Find $T(10^8)$. Give your answer modulo $123456789$.",REDACTED
pe-916,"Let $P(n)$ be the number of permutations of $\{1,2,3,\ldots,2n\}$ such that:

1. There is no ascending subsequence with more than $n+1$ elements, and

2. There is no descending subsequence with more than two elements.

Note that subsequences need not be contiguous. For example, the permutation $(4,1,3,2)$ is not counted because it has a descending subsequence of three elements: $(4,3,2)$. You are given $P(2)=13$ and $P(10) \equiv 45265702 \pmod{10^9 + 7}$.

Find $P(10^8)$ and give your answer modulo $10^9 + 7$.",REDACTED
pe-917,"The sequence $s_n$ is defined by $s_1 = 102022661$ and $s_n = s_{n-1}^2 \bmod {998388889}$ for $n &gt; 1$.

Let $a_n = s_{2n - 1}$ and $b_n = s_{2n}$ for $n=1,2,...$

Define an $N \times N$ matrix whose values are $M_{i,j} = a_i + b_j$.

Let $A(N)$ be the minimal path sum from $M_{1,1}$ (top left) to $M_{N,N}$ (bottom right), where each step is either right or down.

You are given $A(1) = 966774091$, $A(2) = 2388327490$ and $A(10) = 13389278727$.

Find $A(10^7)$.",REDACTED
pe-918,"The sequence $a_n$ is defined by $a_1=1$, and then recursively for $n\geq1$:
$$\begin{align*}
a_{2n}  &amp;=2a_n\\
a_{2n+1} &amp;=a_n-3a_{n+1}
\end{align*}$$
The first ten terms are $1, 2, -5, 4, 17, -10, -17, 8, -47, 34$.

Define $\displaystyle S(N) = \sum_{n=1}^N a_n$. You are given $S(10) = -13$.

Find $S(10^{12})$.

Give your answer modulo $99991$.",REDACTED
pe-920,"For a positive integer $n$ we define $\tau(n)$ to be the count of the divisors of $n$. For example, the divisors of $12$ are $\{1,2,3,4,6,12\}$ and so $\tau(12) = 6$.

A positive integer $n$ is a tau number if it is divisible by $\tau(n)$. For example $\tau(12)=6$ and $6$ divides $12$ so $12$ is a tau number.

Let $m(k)$ be the smallest tau number $x$ such that $\tau(x) = k$. For example, $m(8) = 24$, $m(12)=60$ and $m(16)=384$.

Further define $M(n)$ to be the sum of all $m(k)$ whose values do not exceed $10^n$. You are given $M(3) = 3189$.

Find $M(16)$.

Give your answer modulo $99991$.",REDACTED
pe-921,"Consider the following recurrence relation:
$$\begin{align}
a_0 &amp;= \frac{\sqrt 5 + 1}2\\
a_{n+1} &amp;= \dfrac{a_n(a_n^4 + 10a_n^2 + 5)}{5a_n^4 + 10a_n^2 + 1}
\end{align}$$

Note that $a_0$ is the golden ratio.

$a_n$ can always be written in the form $\dfrac{p_n\sqrt{5}+1}{q_n}$, where $p_n$ and $q_n$ are positive integers.

Let $s(n)=p_n^5+q_n^5$. So, $s(0)=1^5+2^5=33$.

The Fibonacci sequence is defined as: $F_1=1$, $F_2=1$, $F_n=F_{n-1}+F_{n-2}$ for $n &gt; 2$.

Define $\displaystyle S(m)=\sum_{i=2}^{m}s(F_i)$.

Find $S(1618034)$. Submit your answer modulo $398874989$.",REDACTED
pe-924,"Let $B(n)$ be the smallest number larger than $n$ that can be formed by rearranging digits of $n$, or $0$ if no such number exists. For example, $B(245) = 254$ and $B(542) = 0$.

Define $a_0 = 0$ and $a_n = a_{n - 1}^2 + 2$ for $n&gt;0$.
Let $\displaystyle U(N) = \sum_{n = 1}^N B(a_n)$. You are given $U(10) \equiv 543870437 \pmod{10^9+7}$.

Find $U(10^{16})$. Give your answer modulo $10^9 + 7$.",REDACTED
pe-925,"Let $B(n)$ be the smallest number larger than $n$ that can be formed by rearranging digits of $n$, or $0$ if no such number exists. For example, $B(245) = 254$ and $B(542) = 0$.

Define $\displaystyle T(N) = \sum_{n=1}^N B(n^2)$. You are given $T(10)=270$ and $T(100)=335316$.

Find $T(10^{16})$. Give your answer modulo $10^9 + 7$.",REDACTED
pe-926,"A round number is a number that ends with one or more zeros in a given base.

Let us define the roundness of a number $n$ in base $b$ as the number of zeros at the end of the base $b$ representation of $n$.

For example, $20$ has roundness $2$ in base $2$, because the base $2$ representation of $20$ is $10100$, which ends with $2$ zeros.

Also define $R(n)$, the total roundness of a number $n$, as the sum of the roundness of $n$ in base $b$ for all $b &gt; 1$.

For example, $20$ has roundness $2$ in base $2$ and roundness $1$ in base $4$, $5$, $10$, $20$, hence we get $R(20)=6$.

You are also given $R(10!) = 312$.

Find $R(10\,000\,000!)$. Give your answer modulo $10^9 + 7$.",REDACTED
pe-929,"A composition of $n$ is a sequence of positive integers which sum to $n$. Such a sequence can be split into runs, where a run is a maximal contiguous subsequence of equal terms.

For example, $2,2,1,1,1,3,2,2$ is a composition of $14$ consisting of four runs:

$2, 2\quad 1, 1, 1\quad 3 \quad 2, 2$

Let $F(n)$ be the number of compositions of $n$ where every run has odd length.

For example, $F(5)=10$:

$$\begin{align*}
&amp; 5 &amp;&amp;4,1  &amp;&amp; 3,2 &amp;&amp;2,3 &amp;&amp;2,1,2\\
&amp;2,1,1,1 &amp;&amp;1,4 &amp;&amp;1,3,1 &amp;&amp;1,1,1,2 &amp;&amp;1,1,1,1,1
\end{align*}$$
Find $F(10^5)$. Give your answer modulo $1111124111$.",REDACTED
pe-932,"For the year $2025$

$$2025 = (20 + 25)^2$$
Given positive integers $a$ and $b$, the concatenation $ab$ we call a $2025$-number if $ab = (a+b)^2$.

Other examples are $3025$ and $81$.

Note $9801$ is not a $2025$-number because the concatenation of $98$ and $1$ is $981$.

Let $T(n)$ be the sum of all $2025$-numbers with $n$ digits or less. You are given $T(4) = 5131$.

Find $T(16)$.

Give your answer modulo $99991$.",REDACTED
pe-934,"We define the unlucky prime of a number $n$, denoted $u(n)$, as the smallest prime number $p$ such that the remainder of $n$ divided by $p$ (i.e. $n \bmod p$) is not a multiple of seven.

For example, $u(14) = 3$, $u(147) = 2$ and $u(1470) = 13$.

Let $U(N)$ be the sum $\sum_{n = 1}^N u(n)$.

You are given $U(1470) = 4293$.

Find $U(10^{17})$.",REDACTED
pe-937,"Let $\theta=\sqrt{-2}$.

Define $T$ to be the set of numbers of the form $a+b\theta$, where $a$ and $b$ are integers and either $a\gt 0$, or $a=0$ and $b\gt 0$. For a set $S \subseteq T$ and element $z \in T$, define $p(S,z)$ to be the number of ways of choosing two distinct elements from $S$ with product either $z$ or $-z$.

For example if $S=\{1,2,4\}$ and $z=4$, there is only one valid pair of elements with product $\pm4$, namely $1$ and $4$. Thus, in this case $p(S,z)=1$.

For another example, if $S=\{1,\theta,1+\theta,2-\theta\}$ and $z=2-\theta$, we have $1\cdot(2-\theta)=z$ and $\theta\cdot(1+\theta)=-z$, giving $p(S,z)=2$.

Let $A$ and $B$ be two sets satisfying the following conditions:

- $1 \in A$

- $A \cap B = \emptyset$

- $A \cup B = T$

- $p(A,z) = p(B,z)$ for all $z\in T$

Remarkably, these four conditions uniquely determine the sets $A$ and $B$.

Let $F_n$ be the set of the first $n$ factorials: $F_n=\{1!,2!,\dots,n!\}$, and define $G(n)$ to be the sum of all elements of $F_n\cap A$.

You are given $G(4) = 25$, $G(7) = 745$, and $G(100) \equiv 709772949 \pmod{10^9+7}$.

Find $G(10^8)$ and give your answer modulo $10^9+7$.",REDACTED
pe-939,"Two players A and B are playing a variant of Nim.

At the beginning, there are several piles of stones. Each pile is either at the side of A or at the side of B. The piles are unordered.

They make moves in turn. At a player's turn, the player can

- either choose a pile on the opponent's side and remove one stone from that pile;

- or choose a pile on their own side and remove the whole pile.

The winner is the player who removes the last stone.

Let $E(N)$ be the number of initial settings with at most $N$ stones such that, whoever plays first, A always has a winning strategy.

For example $E(4) = 9$; the settings are:

<table class=""grid center""><tr><th>Nr.</th>
  <th>Piles at the side of A</th>
  <th>Piles at the side of B</th>
</tr><tr><td>1</td>
  <td>$4$</td>
  <td>none</td>
</tr><tr><td>2</td>
  <td>$1, 3$</td>
  <td>none</td>
</tr><tr><td>3</td>
  <td>$2, 2$</td>
  <td>none</td>
</tr><tr><td>4</td>
  <td>$1, 1, 2$</td>
  <td>none</td>
</tr><tr><td>5</td>
  <td>$3$</td>
  <td>$1$</td>
</tr><tr><td>6</td>
  <td>$1, 2$</td>
  <td>$1$</td>
</tr><tr><td>7</td>
  <td>$2$</td>
  <td>$1, 1$</td>
</tr><tr><td>8</td>
  <td>$3$</td>
  <td>none</td>
</tr><tr><td>9</td>
  <td>$2$</td>
  <td>none</td>
</tr></table>

Find $E(5000) \bmod 1234567891$.",REDACTED
pe-940,"The Fibonacci sequence $(f_i)$ is the unique sequence such that

- $f_0=0$

- $f_1=1$

- $f_{i+1}=f_i+f_{i-1}$

Similarly, there is a unique function $A(m,n)$ such that

- $A(0,0)=0$

- $A(0,1)=1$

- $A(m+1,n)=A(m,n+1)+A(m,n)$

- $A(m+1,n+1)=2A(m+1,n)+A(m,n)$

Define $S(k)=\displaystyle\sum_{i=2}^k\sum_{j=2}^k A(f_i,f_j)$. For example
$$
\begin{align}
S(3)&amp;=A(1,1)+A(1,2)+A(2,1)+A(2,2)\\
&amp;=2+5+7+16\\
&amp;=30
\end{align}
$$You are also given $S(5)=10396$.

Find $S(50)$, giving your answer modulo $1123581313$.",REDACTED
pe-941,"de Bruijn has a digital combination lock with $k$ buttons numbered $0$ to $k-1$ where $k \le 10$.

The lock opens when the last $n$ buttons pressed match the preset combination.

Unfortunately he has forgotten the combination. He creates a sequence of these digits which contains every possible combination of length $n$. Then by pressing the buttons in this order he is sure to open the lock.

Consider all sequences of shortest possible length that contains every possible combination of the digits.

Denote by $C(k, n)$ the lexicographically smallest of these.

For example, $C(3, 2) = $ 0010211220.

Define the sequence $a_n$ by $a_0=0$ and

$$a_n=(920461 a_{n-1}+800217387569)\bmod 10^{12} \text{ for }\  n &gt; 0$$
Interpret each $a_n$ as a $12$-digit combination, adding leading zeros for any $a_n$ with less than $12$ digits.

Given a positive integer $N$, we are interested in the order the combinations $a_1,\dots,a_N$ appear in $C(10,12)$.

 Denote by $p_n$ the place, numbered $1,\dots,N$, in which $a_n$ appears out of $a_1,\dots,a_N$. Define $\displaystyle F(N)=\sum_{n=1}^Np_na_n$.

For example, the combination $a_1=800217387569$ is entered before $a_2=696996536878$. Therefore:
$$F(2)=1\cdot800217387569 + 2\cdot696996536878 = 2194210461325$$
You are also given $F(10)=32698850376317$.

Find $F(10^7)$. Give your answer modulo $1234567891$.",REDACTED
pe-942,"Given a natural number $q$, let $p = 2^q - 1$ be the $q$-th Mersenne number.

Let $R(q)$ be the minimal square root of $q$ modulo $p$, if one exists. In other words, $R(q)$ is the smallest positive integer $x$ such that $x^2 - q$ is divisible by $p$.

For example, $R(5)=6$ and $R(17)=47569$.

Find $R(74\,207\,281)$. Give your answer modulo $10^9 + 7$.

Note: $2^{74207281}-1$ is prime.",REDACTED
pe-943,"Given two unequal positive integers $a$ and $b$, we define a self-describing sequence consisting of alternating runs of $a$s and $b$s. The first element is $a$ and the sequence of run lengths is the original sequence.

For $a=2, b=3$, the sequence is: 
$$2, 2, 3, 3, 2, 2, 2, 3, 3, 3, 2, 2, 3, 3, 2, 2, 3, 3, 3, 2, 2, 2, 3, 3, 3,...$$
The sequence begins with two $2$s and two $3$s, then three $2$s and three $3$s, so the run lengths $2, 2, 3, 3, ...$ are given by the original sequence.

Let $T(a, b, N)$ be the sum of the first $N$ elements of the sequence. You are given $T(2,3,10) = 25$, $T(4,2,10^4) = 30004$, $T(5,8,10^6) = 6499871$.

Find $\sum T(a, b, 22332223332233)$ for $2 \le a \le 223$, $2 \le b \le 223$ and $a \neq b$. Give your answer modulo $2233222333$.",REDACTED
pe-944,"Given a set $E$ of positive integers, an element $x$ of $E$ is called an element divisor (elevisor) of $E$ if $x$ divides another element of $E$.

The sum of all elevisors of $E$ is denoted $\operatorname{sev}(E)$.

For example, $\operatorname{sev}(\{1, 2, 5, 6\}) = 1 + 2 = 3$.

Let $S(n)$ be the sum of $\operatorname{sev}(E)$ for all subsets $E$ of $\{1, 2, \dots, n\}$.

You are given $S(10) = 4927$.

Find $S(10^{14}) \bmod 1234567891$.",REDACTED
pe-945,"We use $x\oplus y$ for the bitwise XOR of $x$ and $y$.

Define the XOR-product of $x$ and $y$, denoted by $x \otimes y$, similar to a long multiplication in base $2$, except that the intermediate results are XORed instead of the usual integer addition.

For example, $7 \otimes 3 = 9$, or in base $2$, $111_2 \otimes 11_2 = 1001_2$:

$$\begin{align*}
\phantom{\otimes 111} 111_2 \\
\otimes \phantom{1111} 11_2 \\
\hline
\phantom{\otimes 111} 111_2 \\
\oplus \phantom{11} 111_2  \phantom{9} \\
\hline
\phantom{\otimes 11} 1001_2 \\
\end{align*}$$

We consider the equation:

$$\begin{align}
(a \otimes a) \oplus (2 \otimes a \otimes b) \oplus (b \otimes b) = c \otimes c
\end{align}$$

For example, $(a, b, c) = (1, 2, 1)$ is a solution to this equation, and so is $(1, 8, 13)$.

Let $F(N)$ be the number of solutions to this equation satisfying $0 \le a \le b \le N$. You are given $F(10)=21$.

Find $F(10^7)$.

Give your answer modulo $99991$.",REDACTED
pe-946,"Given the representation of a continued fraction
$$ a_0+ \cfrac 1{a_1+ \cfrac 1{a_2+\cfrac 1{a_3+\ddots }}}= [a_0;a_1,a_2,a_3,\ldots] $$

$\alpha$ is a real number with continued fraction representation:
$\alpha = [2;1,1,2,1,1,1,2,1,1,1,1,1,2,1,1,1,1,1,1,1,2,1,1,1,1,1,1,1,1,1,1,1,2,\ldots]$
 where the number of $1$'s between each of the $2$'s are consecutive prime numbers.

$\beta$ is another real number defined as
$$	\beta = \frac{2\alpha+3}{3\alpha+2} $$

The first ten coefficients of the continued fraction of $\beta$ are $[0;1,5,6,16,9,1,10,16,11]$ with sum $75$.

Find the sum of the first $10^8$ coefficients of the continued fraction of $\beta$.

Give your answer modulo $99991$.",REDACTED
pe-947,"The $(a,b,m)$-sequence, where $0 \leq a,b \lt m$, is defined as

$\begin{align*}
g(0)&amp;=a\\
g(1)&amp;=b\\
g(n)&amp;= \big(g(n-1) + g(n-2)\big) \bmod m
\end{align*}$

All $(a,b,m)$-sequences are periodic with period denoted by $p(a,b,m)$.
 
The first few terms of the $(0,1,8)$-sequence are $(0,1,1,2,3,5,0,5,5,2,7,1,0,1,1,2,\ldots )$ and so $p(0,1,8)=12$.

Let $\displaystyle s(m)=\sum_{a=0}^{m-1}\sum_{b=0}^{m-1} p(a,b,m)^2$. For example, $s(3)=513$ and $s(10)=225820$.

Define $\displaystyle S(M)=\sum_{m=1}^{M}s(m)$. You are given, $S(3)=542$ and $S(10)=310897$.

Find $S(10^6)$. Give your answer modulo $999\,999\,893$.",REDACTED
pe-948,"Left and Right play a game with a word consisting of L's and R's, alternating turns. On Left's turn, Left can remove any positive number of letters, but not all the letters, from the left side of the word. Right does the same on Right's turn except that Right removes letters from the right side. The game continues until only one letter remains: if it is an 'L' then Left wins; if it is an 'R' then Right wins.

Let $F(n)$ be the number of words of length $n$ where the player moving first, whether it's Left or Right, will win the game if both play optimally.

You are given $F(3)=4$ and $F(8)=181$.

Find $F(60)$.

Give your answer modulo $99991$.",REDACTED
pe-950,"A band of pirates has come into a hoard of treasure, and must decide how to distribute it amongst themselves. The treasure consists of identical, indivisible gold coins.

According to pirate law, the distribution of treasure must proceed as follows:

- The most senior pirate proposes a distribution of the coins.

- All pirates, including the most senior, vote on whether to accept the distribution.

- If at least half of the pirates vote to accept, the distribution stands.

- Otherwise, the most senior pirate must walk the plank, and the process resumes from step 1 with the next most senior pirate proposing another distribution.

The happiness of a pirate is equal to $-\infty$ if he doesn't survive; otherwise, it is equal to $c + p\cdot w$, where $c$ is the number of coins that pirate receives in the distribution, $w$ is the total number of pirates who were made to walk the plank, and $p$ is the bloodthirstiness of the pirate.

The pirates have a number of characteristics:

- Greed: to maximise their happiness.

- Ruthlessness: incapable of cooperation, making promises or maintaining any kind of reputation.

- Shrewdness: perfectly rational and logical.

Consider the happiness $c(n,C,p) + p\cdot w(n,C,p)$ of the most senior surviving pirate in the situation where $n$ pirates, all with equal bloodthirstiness $p$, have found $C$ coins. For example, $c(5,5,\frac{1}{10}) = 3$ and $w(5,5,\frac{1}{10})=0$ because it can be shown that if the most senior pirate proposes a distribution of $3,0,1,0,1$ coins to the pirates (in decreasing order of seniority), the three pirates receiving coins will all vote to accept. On the other hand, $c(5,1,\frac{1}{10}) = 0$ and $w(5,1,\frac{1}{10}) = 1$: the most senior pirate cannot survive with any proposal, and then the second most senior pirate must give the only coin to another pirate in order to survive.

Define $\displaystyle T(N,C,p) = \sum_{n=1}^N \left ( c(n,C,p) + w(n,C,p) \right )$. You are given that $T(30,3,\frac{1}{\sqrt{3}}) = 190$, $T(50,3,\frac{1}{\sqrt{31}}) = 385$, and $T(10^3, 101, \frac{1}{\sqrt{101}}) = 142427$.

Find $\displaystyle \sum_{k=1}^6 T(10^{16},10^k+1,\tfrac{1}{\sqrt{10^k+1}})$.  Give the last 9 digits as your answer.",REDACTED
pe-951,"Two players play a game using a deck of $2n$ cards: $n$ red and $n$ black. Initially the deck is shuffled into one of the $\binom{2n}{n}$ possible starting configurations. Play then proceeds, alternating turns, where a player follows two steps on each turn:

- 
Remove the top card from the deck, taking note of its colour.

- 
If there is a next card and it is the same colour as the previous card they toss a fair coin. If the coin lands on heads they remove that card as well; otherwise leave it on top of the deck.

The player who removes the final card from the deck wins the game.

Some starting configurations give an advantage to one of the players; while some starting configurations are fair, in which both players have exactly $50\%$ chance to win the game. For example, if $n=2$ there are four starting configurations which are fair: RRBB, BBRR, RBBR, BRRB. The remaining two, RBRB and BRBR, result in a guaranteed win for the second player.

Define $F(n)$ to be the number of starting configurations which are fair. Therefore $F(2)=4$. You are also given $F(8)=11892$.

Find $F(26)$.

Give your answer modulo $99991$.",REDACTED
pe-952,"Given a prime $p$ and a positive integer $n \lt p$, let $R(p, n)$ be the multiplicative order of $p$ modulo $n!$.

In other words, $R(p, n)$ is the minimal positive integer $r$ such that

$$p^r \equiv 1 \pmod{n!}$$

For example, $R(7, 4) = 2$ and $R(10^9 + 7, 12) = 17280$.

Find $R(10^9 + 7, 10^7)$. Give your answer modulo $10^9 + 7$.",REDACTED
pe-953,"In the classical game of Nim two players take turns removing stones from piles. A player may remove any positive number of stones from a single pile. If there are no remaining stones, the next player to move loses.

In Factorisation Nim the initial position of the game is chosen according to the prime factorisation of a given natural number $n$ by setting a pile for each prime factor, including multiplicity. For example, if $n=12=2 \times 2 \times 3$ the game starts with three piles: two piles with two stones and one pile with three stones.

It can be verified that the first player to move loses for $n=1$ and for $n=70$, assuming both players play optimally.

Let $S(N)$ be the sum of $n$ for $1 \le n \le N$ such that the first player to move loses, assuming both players play optimally. You are given $S(10) = 14$ and $S(100) = 455$.

Find $S(10^{14})$. Give your answer modulo $10^9 + 7$.",REDACTED
pe-954,"A positive integer is called heptaphobic if it is not divisible by seven and no number divisible by seven can be produced by swapping two of its digits. Note that leading zeros are not allowed before or after the swap.

For example, $17$ and $1305$ are heptaphobic, but $14$ and $132$ are not because $14$ and $231$ are divisible by seven.

Let $C(N)$ count heptaphobic numbers smaller than $N$. You are given $C(100) = 74$ and $C(10^4) = 3737$.

Find $C(10^{13})$.

Give your answer modulo $99991$.",REDACTED
pe-955,"A sequence $(a_n)_{n \ge 0}$ starts with $a_0 = 3$ and for each $n \ge 0$,

- if $a_n$ is a triangle numberA triangle number is a number of the form $m(m + 1)/2$ for some integer $m$., then $a_{n + 1} = a_n + 1$;

- otherwise, $a_{n + 1} = 2a_n - a_{n - 1} + 1$.

The sequence begins:
$${\color{red}3}, 4, {\color{red}6}, 7, 9, 12, 16, {\color{red}21}, 22, 24, 27, 31, {\color{red}36}, 37, 39, 42, \dots$$
where triangle numbers are marked red.

The $10$th triangle number in the sequence is $a_{2964} = 1439056$.

Find the index $n$ such that $a_n$ is the $70$th triangle number in the sequence.

Give your answer modulo $99991$.",REDACTED
pe-956,"The total number of prime factors of $n$, counted with multiplicity, is denoted $\Omega(n)$.

For example, $\Omega(12)=3$, counting the factor $2$ twice, and the factor $3$ once.

Define $D(n, m)$ to be the sum of all divisors $d$ of $n$ where $\Omega(d)$ is divisible by $m$. 

For example, $D(24, 3)=1+8+12=21$.

The superfactorial of $n$, often written as $n\$$, is defined as the product of the first $n$ factorials:
$$n\$=1!\times 2! \times\cdots\times n!$$
The superduperfactorial of $n$, we write as $n\bigstar$, is defined as the product of the first $n$ superfactorials:
$$n\bigstar=1\$ \times 2\$ \times\cdots\times n\$ $$

You are given $D(6\bigstar, 6)=6368195719791280$.

Find $D(1\,000\bigstar, 1\,000)$. 
Give your answer modulo $999\,999\,001$.",REDACTED
pe-957,"There is a plane on which all points are initially white, except three red points and two blue points.

On each day, every line passing through a red point and a blue point is constructed. Then every white point, where two different such lines meet, turns blue.

Let $g(n)$ be the maximal possible number of blue points after $n$ days.

For example, $g(1)=8$ and $g(2)=28$.

Find $g(16)$.

Give your answer modulo $99991$.",REDACTED
pe-958,"The Euclidean algorithm can be used to find the greatest common divisor of two positive integers. At each step of the algorithm the smaller number is subtracted from the larger one. The algorithm terminates when the numbers are equal, which is then the greatest common divisor of the original numbers.

For two numbers $n$ and $m$, let $d(n, m)$ be the number of subtraction steps used by the Euclidean algorithm for computing the greatest common divisor of $n$ and $m$.

For a number $n$, let $f(n)$ be the positive number $m$ coprime to $n$ that minimizes $d(n, m)$. If more than one number attains the minimum, the minimal $m$ is chosen.

For example, at least four steps are needed for computing the GCD of $7$ and any positive number $m$ coprime to $7$. This number of steps is obtained by $m=2,3,4,5$, yielding $f(7)=2$. You are also given $f(89)=34$ and $f(8191) = 1856$.

Find $f(10^{12}+39)$.

Give your answer modulo $99991$.",REDACTED
pe-960,"There are $n$ distinct piles of stones, each of size $n-1$. Starting with an initial score of $0$, the following procedure is repeated:

- Choose any two piles and remove exactly $n$ stones in total from the two piles.

- If the number of stones removed from the two piles were $a$ and $b$, add $\min(a,b)$ to the score.

If all piles are eventually emptied, the current score is confirmed as final. However, if one gets ""stuck"" and cannot empty all piles, the current score is discarded, resulting in a final score of $0$.

Three example sequences of turns are illustrated below for $n=4$, with each tuple representing pile sizes as one proceeds, and with additions to the score indicated above the arrows.
$$
\begin{align}
&amp;(3,3,3,3)\xrightarrow{+1}(0,3,2,3)\xrightarrow{+1}(0,3,1,0)\xrightarrow{+1}(0,0,0,0)&amp;:\quad\text{final score }=3\\
&amp;(3,3,3,3)\xrightarrow{+1}(3,0,3,2)\xrightarrow{+2}(1,0,3,0)\xrightarrow{+1}(0,0,0,0)&amp;:\quad\text{final score }=4\\
&amp;(3,3,3,3)\xrightarrow{+2}(1,3,1,3)\xrightarrow{+1}(1,2,1,0)\rightarrow\text{stuck!}&amp;:\quad\text{final score }=0
\end{align}
$$

Define $F(n)$ to be the sum of the final scores achieved for every sequence of turns which successfully empty all piles.

You are given $F(3)=12$, $F(4)=360$, and $F(8)=16785941760$.

Find $F(100)$. Give your answer modulo $10^9+7$.",REDACTED
pe-961,"This game starts with a positive integer. Two players take turns to remove a single digit from that integer. After the digit is removed any resulting leading zeros are removed.

For example, removing a digit from $105$ results in either $5$, $10$ or $15$.

The winner is the person who removes the last nonzero digit.

Define $W(N)$ to be how many positive integers less than $N$ for which the first player can guarantee a win given optimal play. You are given $W(100) = 18$ and $W(10^4) = 1656$.

Find $W(10^{18})$.",REDACTED
pe-967,"A positive integer $n$ is considered $B$-trivisible if the sum of all different prime factors of $n$ which are not larger than $B$ is divisible by $3$.

For example, $175 = 5^2 \cdot 7$ is $10$-trivisible because $5 + 7 = 12$ which is divisible by $3$. Similarly, $175$ is $4$-trivisible because all primes dividing $175$ are larger than $4$, and the empty summation $0$ is divisible by $3$.

On the other hand, $175$ is not $6$-trivisible because the sum of relevant primes is $5$ which is not divisible by $3$.

Let $F(N, B)$ be the number of $B$-trivisible integers not larger than $N$.

For example, $F(10, 4) = 5$, the $4$-trivisible numbers being $1,3,5,7,9$.

You are also given $F(10, 10) = 3$ and $F(100, 10) = 41$.

Find $F(10^{18}, 120)$.

Give your answer modulo $99991$.",REDACTED
pe-968,"Define
$$P(X_{a,b},X_{a,c},X_{a,d},X_{a,e},X_{b,c},X_{b,d},X_{b,e},X_{c,d},X_{c,e},X_{d,e})$$
as the sum of $2^a3^b5^c7^d11^e$ over all quintuples of non-negative integers $(a, b, c, d, e)$ such that the sum of each two of the five variables is restricted by a given value. In other words, $a+b \le X_{a,b}$, $a+d \le X_{a,d}$, $b+e \le X_{b,e}$ etc.

For example, $P(2,2,2,2,2,2,2,2,2,2)=7120$ and $P(1, 2, 3, 4, 5, 6, 7, 8, 9, 10) \equiv 799809376 \pmod{10^9 + 7}$.

Define a sequence $A$ as follows:

- $A_0 = 1$, $A_1 = 7$;

- $A_n =(7A_{n−1}+A_{n-2}^2) \bmod(10^9+7)$ for $n \ge 2$.

Also define $Q(n) = P(A_{10n}, A_{10n+1}, A_{10n+2}, \dots , A_{10n+9})$.

Find $\displaystyle\sum_{0 \le n \lt 100}Q(n)$. Give your answer modulo $10^9+7$.",REDACTED
pe-969,"Starting at zero, a kangaroo hops along the real number line in the positive direction. Each successive hop takes the kangaroo forward a uniformly random distance between $0$ and $1$. Let $H(n)$ be the expected number of hops needed for the kangaroo to pass $n$ on the real line.

If we write $\alpha = H(1)$, then for all positive integers $n$, $H(n)$ can be expressed as a polynomial function of $\alpha$ with rational coefficients. For example $H(3)=\alpha^3-2\alpha^2+\frac{1}{2}\alpha$. Define $S(n)$ to be the sum of all integer coefficients in this polynomial form of $H(n)$. Therefore $S(1)=1$ and $S(3)=1+(-2)=-1$.

You are also given $\displaystyle \sum_{n=1}^{10} S(n)=43$.

Find $\displaystyle\sum_{n=1}^{10^{18}} S(n)$. Give your answer modulo $10^9+7$.",REDACTED
pe-970,"Starting at zero, a kangaroo hops along the real number line in the positive direction. Each successive hop takes the kangaroo forward a uniformly random distance between $0$ and $1$. Let $H(n)$ be the expected number of hops needed for the kangaroo to pass $n$ on the real line.

For example, $H(2) \approx 4.67077427047$. The first eight digits after the decimal point that are different from six are $70774270$.

Similarly, $H(3) \approx 6.6665656395558899$. Here the first eight digits after the decimal point that are different from six are $55395558$.

Find $H(10^6)$ and give as your answer the first eight digits after the decimal point that are different from six.

Give your answer modulo $99991$.",REDACTED
pe-971,"Let $p$ be a prime of the form $5k-4$ and define $f_p(x) = \left(x^k+x\right) \bmod p$.

Let $C(p)$ be the number of values $0 \le x \lt p$ such that $f_p^{(m)}(x) = x$ for some positive integer $m$, that is, $x$ can be obtained by iteratively applying $f_p$ on itself starting at $x$.

For example, $C(11) = 7$, due to $x = 0, 1, 2, 3, 8, 9, 10$.

Let $S(N)$ be the sum of $C(p)$ for all primes of the form $5k-4$ not exceeding $N$. For example $S(100) = 127$.

Find $S(10^8)$.",REDACTED
pe-973,"A game is played with $n$ cards.
At the start the cards are dealt out onto a table to get $n$ piles of size one.

Each round proceeds as follows:

- Select a pile at random and pick it up.

- Randomly choose a pile from the table and add the top card of the picked-up pile to it.

- Redistribute any remaining cards from the picked-up pile by dealing them into new single-card piles.

The game ends when all cards are in a single pile.

At the end of each round a score is obtained by bitwise-XORing the size of each pile. The score is summed across the rounds. Let $X(n)$ be the expected total score at the end of the game.

You are given $X(2) = 2$, $X(4) = 14$ and $X(10) = 1418$.

Find $X(10^4)$. Give your answer modulo $10^9+7$.",REDACTED
pe-974,"A very odd number is a number which contains only odd digits and is divisible by $105$.
Further each odd digit occurs an odd number of times.

Define $\Theta (n)$ be the $n$th very odd number, then $\Theta (1) = 1117935$ and $\Theta(10^3) = 11137955115$.

Find $\Theta(10^{16})$.

Give your answer modulo $99991$.",REDACTED
aimo3-15245,p = 2 * 3^30 + 1 is prime. A positive integer is called Norwegian if it has three distinct positive divisors whose sum is equal to 6p. Let N be the smallest Norwegian positive integer. What is the remainder when N is divided by 99991?,15245
aimo3-q10-g0-g10162574,Let $n \geq 6$ be a positive integer. We call a positive integer $n$-Norwegian if it has three distinct positive divisors whose sum is equal to $n$. Let $f(n)$ denote the smallest $n$-Norwegian positive integer. Let $M=3^{2025!}$ and for a non-negative integer $c$ define \begin{equation*} g(c)=\frac{1}{2025!}\left\lfloor \frac{2025! f(M+c)}{M}\right\rfloor. \end{equation*} We can write \begin{equation*} g(0) + g(10162574)=\frac{p}{q} \end{equation*} where $p$ and $q$ are coprime positive integers. What is the remainder when $p+q$ is divided by $99991$?,325
aimo3-q10-g0-g1848374,Let $n \geq 6$ be a positive integer. We call a positive integer $n$-Norwegian if it has three distinct positive divisors whose sum is equal to $n$. Let $f(n)$ denote the smallest $n$-Norwegian positive integer. Let $M=3^{2025!}$ and for a non-negative integer $c$ define \begin{equation*} g(c)=\frac{1}{2025!}\left\lfloor \frac{2025! f(M+c)}{M}\right\rfloor. \end{equation*} We can write \begin{equation*} g(0) + g(1848374)=\frac{p}{q} \end{equation*} where $p$ and $q$ are coprime positive integers. What is the remainder when $p+q$ is divided by $99991$?,173
aimo3-q10-g0-g265710644,Let $n \geq 6$ be a positive integer. We call a positive integer $n$-Norwegian if it has three distinct positive divisors whose sum is equal to $n$. Let $f(n)$ denote the smallest $n$-Norwegian positive integer. Let $M=3^{2025!}$ and for a non-negative integer $c$ define \begin{equation*} g(c)=\frac{1}{2025!}\left\lfloor \frac{2025! f(M+c)}{M}\right\rfloor. \end{equation*} We can write \begin{equation*} g(0) + g(265710644)=\frac{p}{q} \end{equation*} where $p$ and $q$ are coprime positive integers. What is the remainder when $p+q$ is divided by $99991$?,677
aimo3-q10-g0-g44636594,Let $n \geq 6$ be a positive integer. We call a positive integer $n$-Norwegian if it has three distinct positive divisors whose sum is equal to $n$. Let $f(n)$ denote the smallest $n$-Norwegian positive integer. Let $M=3^{2025!}$ and for a non-negative integer $c$ define \begin{equation*} g(c)=\frac{1}{2025!}\left\lfloor \frac{2025! f(M+c)}{M}\right\rfloor. \end{equation*} We can write \begin{equation*} g(0) + g(44636594)=\frac{p}{q} \end{equation*} where $p$ and $q$ are coprime positive integers. What is the remainder when $p+q$ is divided by $99991$?,1165
aimo3-q10-g0-g4M-g10162574,Let $n \geq 6$ be a positive integer. We call a positive integer $n$-Norwegian if it has three distinct positive divisors whose sum is equal to $n$. Let $f(n)$ denote the smallest $n$-Norwegian positive integer. Let $M=3^{2025!}$ and for a non-negative integer $c$ define \begin{equation*} g(c)=\frac{1}{2025!}\left\lfloor \frac{2025! f(M+c)}{M}\right\rfloor. \end{equation*} We can write \begin{equation*} g(0) + g(4M) + g(10162574)=\frac{p}{q} \end{equation*} where $p$ and $q$ are coprime positive integers. What is the remainder when $p+q$ is divided by $99991$?,265
aimo3-q10-g0-g4M-g1848374,Let $n \geq 6$ be a positive integer. We call a positive integer $n$-Norwegian if it has three distinct positive divisors whose sum is equal to $n$. Let $f(n)$ denote the smallest $n$-Norwegian positive integer. Let $M=3^{2025!}$ and for a non-negative integer $c$ define \begin{equation*} g(c)=\frac{1}{2025!}\left\lfloor \frac{2025! f(M+c)}{M}\right\rfloor. \end{equation*} We can write \begin{equation*} g(0) + g(4M) + g(1848374)=\frac{p}{q} \end{equation*} where $p$ and $q$ are coprime positive integers. What is the remainder when $p+q$ is divided by $99991$?,141
aimo3-q10-g0-g4M-g265710644,Let $n \geq 6$ be a positive integer. We call a positive integer $n$-Norwegian if it has three distinct positive divisors whose sum is equal to $n$. Let $f(n)$ denote the smallest $n$-Norwegian positive integer. Let $M=3^{2025!}$ and for a non-negative integer $c$ define \begin{equation*} g(c)=\frac{1}{2025!}\left\lfloor \frac{2025! f(M+c)}{M}\right\rfloor. \end{equation*} We can write \begin{equation*} g(0) + g(4M) + g(265710644)=\frac{p}{q} \end{equation*} where $p$ and $q$ are coprime positive integers. What is the remainder when $p+q$ is divided by $99991$?,549
aimo3-q10-g0-g4M-g44636594,Let $n \geq 6$ be a positive integer. We call a positive integer $n$-Norwegian if it has three distinct positive divisors whose sum is equal to $n$. Let $f(n)$ denote the smallest $n$-Norwegian positive integer. Let $M=3^{2025!}$ and for a non-negative integer $c$ define \begin{equation*} g(c)=\frac{1}{2025!}\left\lfloor \frac{2025! f(M+c)}{M}\right\rfloor. \end{equation*} We can write \begin{equation*} g(0) + g(4M) + g(44636594)=\frac{p}{q} \end{equation*} where $p$ and $q$ are coprime positive integers. What is the remainder when $p+q$ is divided by $99991$?,945
aimo3-q10-g0-g4M,Let $n \geq 6$ be a positive integer. We call a positive integer $n$-Norwegian if it has three distinct positive divisors whose sum is equal to $n$. Let $f(n)$ denote the smallest $n$-Norwegian positive integer. Let $M=3^{2025!}$ and for a non-negative integer $c$ define \begin{equation*} g(c)=\frac{1}{2025!}\left\lfloor \frac{2025! f(M+c)}{M}\right\rfloor. \end{equation*} We can write \begin{equation*} g(0) + g(4M)=\frac{p}{q} \end{equation*} where $p$ and $q$ are coprime positive integers. What is the remainder when $p+q$ is divided by $99991$?,5
aimo3-q10-g0,Let $n \geq 6$ be a positive integer. We call a positive integer $n$-Norwegian if it has three distinct positive divisors whose sum is equal to $n$. Let $f(n)$ denote the smallest $n$-Norwegian positive integer. Let $M=3^{2025!}$ and for a non-negative integer $c$ define \begin{equation*} g(c)=\frac{1}{2025!}\left\lfloor \frac{2025! f(M+c)}{M}\right\rfloor. \end{equation*} We can write \begin{equation*} g(0)=\frac{p}{q} \end{equation*} where $p$ and $q$ are coprime positive integers. What is the remainder when $p+q$ is divided by $99991$?,5
aimo3-q10-g10162574-g265710644,Let $n \geq 6$ be a positive integer. We call a positive integer $n$-Norwegian if it has three distinct positive divisors whose sum is equal to $n$. Let $f(n)$ denote the smallest $n$-Norwegian positive integer. Let $M=3^{2025!}$ and for a non-negative integer $c$ define \begin{equation*} g(c)=\frac{1}{2025!}\left\lfloor \frac{2025! f(M+c)}{M}\right\rfloor. \end{equation*} We can write \begin{equation*} g(10162574) + g(265710644)=\frac{p}{q} \end{equation*} where $p$ and $q$ are coprime positive integers. What is the remainder when $p+q$ is divided by $99991$?,10477
aimo3-q10-g10162574-g44636594,Let $n \geq 6$ be a positive integer. We call a positive integer $n$-Norwegian if it has three distinct positive divisors whose sum is equal to $n$. Let $f(n)$ denote the smallest $n$-Norwegian positive integer. Let $M=3^{2025!}$ and for a non-negative integer $c$ define \begin{equation*} g(c)=\frac{1}{2025!}\left\lfloor \frac{2025! f(M+c)}{M}\right\rfloor. \end{equation*} We can write \begin{equation*} g(10162574) + g(44636594)=\frac{p}{q} \end{equation*} where $p$ and $q$ are coprime positive integers. What is the remainder when $p+q$ is divided by $99991$?,18029
aimo3-q10-g10162574,Let $n \geq 6$ be a positive integer. We call a positive integer $n$-Norwegian if it has three distinct positive divisors whose sum is equal to $n$. Let $f(n)$ denote the smallest $n$-Norwegian positive integer. Let $M=3^{2025!}$ and for a non-negative integer $c$ define \begin{equation*} g(c)=\frac{1}{2025!}\left\lfloor \frac{2025! f(M+c)}{M}\right\rfloor. \end{equation*} We can write \begin{equation*} g(10162574)=\frac{p}{q} \end{equation*} where $p$ and $q$ are coprime positive integers. What is the remainder when $p+q$ is divided by $99991$?,77
aimo3-q10-g1848374-g10162574,Let $n \geq 6$ be a positive integer. We call a positive integer $n$-Norwegian if it has three distinct positive divisors whose sum is equal to $n$. Let $f(n)$ denote the smallest $n$-Norwegian positive integer. Let $M=3^{2025!}$ and for a non-negative integer $c$ define \begin{equation*} g(c)=\frac{1}{2025!}\left\lfloor \frac{2025! f(M+c)}{M}\right\rfloor. \end{equation*} We can write \begin{equation*} g(1848374) + g(10162574)=\frac{p}{q} \end{equation*} where $p$ and $q$ are coprime positive integers. What is the remainder when $p+q$ is divided by $99991$?,2677
aimo3-q10-g1848374-g265710644,Let $n \geq 6$ be a positive integer. We call a positive integer $n$-Norwegian if it has three distinct positive divisors whose sum is equal to $n$. Let $f(n)$ denote the smallest $n$-Norwegian positive integer. Let $M=3^{2025!}$ and for a non-negative integer $c$ define \begin{equation*} g(c)=\frac{1}{2025!}\left\lfloor \frac{2025! f(M+c)}{M}\right\rfloor. \end{equation*} We can write \begin{equation*} g(1848374) + g(265710644)=\frac{p}{q} \end{equation*} where $p$ and $q$ are coprime positive integers. What is the remainder when $p+q$ is divided by $99991$?,5577
aimo3-q10-g1848374-g44636594,Let $n \geq 6$ be a positive integer. We call a positive integer $n$-Norwegian if it has three distinct positive divisors whose sum is equal to $n$. Let $f(n)$ denote the smallest $n$-Norwegian positive integer. Let $M=3^{2025!}$ and for a non-negative integer $c$ define \begin{equation*} g(c)=\frac{1}{2025!}\left\lfloor \frac{2025! f(M+c)}{M}\right\rfloor. \end{equation*} We can write \begin{equation*} g(1848374) + g(44636594)=\frac{p}{q} \end{equation*} where $p$ and $q$ are coprime positive integers. What is the remainder when $p+q$ is divided by $99991$?,9597
aimo3-q10-g1848374,Let $n \geq 6$ be a positive integer. We call a positive integer $n$-Norwegian if it has three distinct positive divisors whose sum is equal to $n$. Let $f(n)$ denote the smallest $n$-Norwegian positive integer. Let $M=3^{2025!}$ and for a non-negative integer $c$ define \begin{equation*} g(c)=\frac{1}{2025!}\left\lfloor \frac{2025! f(M+c)}{M}\right\rfloor. \end{equation*} We can write \begin{equation*} g(1848374)=\frac{p}{q} \end{equation*} where $p$ and $q$ are coprime positive integers. What is the remainder when $p+q$ is divided by $99991$?,41
aimo3-q10-g265710644-g44636594,Let $n \geq 6$ be a positive integer. We call a positive integer $n$-Norwegian if it has three distinct positive divisors whose sum is equal to $n$. Let $f(n)$ denote the smallest $n$-Norwegian positive integer. Let $M=3^{2025!}$ and for a non-negative integer $c$ define \begin{equation*} g(c)=\frac{1}{2025!}\left\lfloor \frac{2025! f(M+c)}{M}\right\rfloor. \end{equation*} We can write \begin{equation*} g(265710644) + g(44636594)=\frac{p}{q} \end{equation*} where $p$ and $q$ are coprime positive integers. What is the remainder when $p+q$ is divided by $99991$?,37557
aimo3-q10-g265710644,Let $n \geq 6$ be a positive integer. We call a positive integer $n$-Norwegian if it has three distinct positive divisors whose sum is equal to $n$. Let $f(n)$ denote the smallest $n$-Norwegian positive integer. Let $M=3^{2025!}$ and for a non-negative integer $c$ define \begin{equation*} g(c)=\frac{1}{2025!}\left\lfloor \frac{2025! f(M+c)}{M}\right\rfloor. \end{equation*} We can write \begin{equation*} g(265710644)=\frac{p}{q} \end{equation*} where $p$ and $q$ are coprime positive integers. What is the remainder when $p+q$ is divided by $99991$?,161
aimo3-q10-g44636594,Let $n \geq 6$ be a positive integer. We call a positive integer $n$-Norwegian if it has three distinct positive divisors whose sum is equal to $n$. Let $f(n)$ denote the smallest $n$-Norwegian positive integer. Let $M=3^{2025!}$ and for a non-negative integer $c$ define \begin{equation*} g(c)=\frac{1}{2025!}\left\lfloor \frac{2025! f(M+c)}{M}\right\rfloor. \end{equation*} We can write \begin{equation*} g(44636594)=\frac{p}{q} \end{equation*} where $p$ and $q$ are coprime positive integers. What is the remainder when $p+q$ is divided by $99991$?,277
aimo3-q10-g4M-g10162574,Let $n \geq 6$ be a positive integer. We call a positive integer $n$-Norwegian if it has three distinct positive divisors whose sum is equal to $n$. Let $f(n)$ denote the smallest $n$-Norwegian positive integer. Let $M=3^{2025!}$ and for a non-negative integer $c$ define \begin{equation*} g(c)=\frac{1}{2025!}\left\lfloor \frac{2025! f(M+c)}{M}\right\rfloor. \end{equation*} We can write \begin{equation*} g(4M) + g(10162574)=\frac{p}{q} \end{equation*} where $p$ and $q$ are coprime positive integers. What is the remainder when $p+q$ is divided by $99991$?,701
aimo3-q10-g4M-g1848374,Let $n \geq 6$ be a positive integer. We call a positive integer $n$-Norwegian if it has three distinct positive divisors whose sum is equal to $n$. Let $f(n)$ denote the smallest $n$-Norwegian positive integer. Let $M=3^{2025!}$ and for a non-negative integer $c$ define \begin{equation*} g(c)=\frac{1}{2025!}\left\lfloor \frac{2025! f(M+c)}{M}\right\rfloor. \end{equation*} We can write \begin{equation*} g(4M) + g(1848374)=\frac{p}{q} \end{equation*} where $p$ and $q$ are coprime positive integers. What is the remainder when $p+q$ is divided by $99991$?,373
aimo3-q10-g4M-g265710644,Let $n \geq 6$ be a positive integer. We call a positive integer $n$-Norwegian if it has three distinct positive divisors whose sum is equal to $n$. Let $f(n)$ denote the smallest $n$-Norwegian positive integer. Let $M=3^{2025!}$ and for a non-negative integer $c$ define \begin{equation*} g(c)=\frac{1}{2025!}\left\lfloor \frac{2025! f(M+c)}{M}\right\rfloor. \end{equation*} We can write \begin{equation*} g(4M) + g(265710644)=\frac{p}{q} \end{equation*} where $p$ and $q$ are coprime positive integers. What is the remainder when $p+q$ is divided by $99991$?,1453
aimo3-q10-g4M-g44636594,Let $n \geq 6$ be a positive integer. We call a positive integer $n$-Norwegian if it has three distinct positive divisors whose sum is equal to $n$. Let $f(n)$ denote the smallest $n$-Norwegian positive integer. Let $M=3^{2025!}$ and for a non-negative integer $c$ define \begin{equation*} g(c)=\frac{1}{2025!}\left\lfloor \frac{2025! f(M+c)}{M}\right\rfloor. \end{equation*} We can write \begin{equation*} g(4M) + g(44636594)=\frac{p}{q} \end{equation*} where $p$ and $q$ are coprime positive integers. What is the remainder when $p+q$ is divided by $99991$?,2501
aimo3-q10-g4M,Let $n \geq 6$ be a positive integer. We call a positive integer $n$-Norwegian if it has three distinct positive divisors whose sum is equal to $n$. Let $f(n)$ denote the smallest $n$-Norwegian positive integer. Let $M=3^{2025!}$ and for a non-negative integer $c$ define \begin{equation*} g(c)=\frac{1}{2025!}\left\lfloor \frac{2025! f(M+c)}{M}\right\rfloor. \end{equation*} We can write \begin{equation*} g(4M)=\frac{p}{q} \end{equation*} where $p$ and $q$ are coprime positive integers. What is the remainder when $p+q$ is divided by $99991$?,13
aimo3-q9-m0,"Let $\mathcal{F}$ be the set of functions $\alpha \colon \mathbb{Z}\to \mathbb{Z}$ for which there are only finitely many $n \in \mathbb{Z}$ such that $\alpha(n) \neq 0$. For two functions $\alpha$ and $\beta$ in $\mathcal{F}$, define their product $\alpha\star\beta$ to be $\sum\limits_{n\in\mathbb{Z}} \alpha(n)\cdot \beta(n)$. Also, for $n\in\mathbb{Z}$, define a shift operator $S_n \colon \mathcal{F}\to \mathcal{F}$ by $S_n(\alpha)(t)=\alpha(t+n)$ for all $t \in \mathbb{Z}$. A function $\alpha \in \mathcal{F}$ is called \emph{shifty} if \begin{itemize} \item $\alpha(m)=0$ for all integers $m<0$ and $m>0$ and \item There exists $\beta \in \mathcal{F}$ and integers $k \neq l$ such that for all $n \in \mathbb{Z}$ \begin{equation*} S_n(\alpha)\star\beta = \begin{cases} 1 & n \in \{k,l\} \\ 0 & n \not \in \{k,l\} \end{cases} \; . \end{equation*} \end{itemize} How many shifty functions are there in $\mathcal{F}$?",2
aimo3-q9-m1,"Let $\mathcal{F}$ be the set of functions $\alpha \colon \mathbb{Z}\to \mathbb{Z}$ for which there are only finitely many $n \in \mathbb{Z}$ such that $\alpha(n) \neq 0$. For two functions $\alpha$ and $\beta$ in $\mathcal{F}$, define their product $\alpha\star\beta$ to be $\sum\limits_{n\in\mathbb{Z}} \alpha(n)\cdot \beta(n)$. Also, for $n\in\mathbb{Z}$, define a shift operator $S_n \colon \mathcal{F}\to \mathcal{F}$ by $S_n(\alpha)(t)=\alpha(t+n)$ for all $t \in \mathbb{Z}$. A function $\alpha \in \mathcal{F}$ is called \emph{shifty} if \begin{itemize} \item $\alpha(m)=0$ for all integers $m<0$ and $m>1$ and \item There exists $\beta \in \mathcal{F}$ and integers $k \neq l$ such that for all $n \in \mathbb{Z}$ \begin{equation*} S_n(\alpha)\star\beta = \begin{cases} 1 & n \in \{k,l\} \\ 0 & n \not \in \{k,l\} \end{cases} \; . \end{equation*} \end{itemize} How many shifty functions are there in $\mathcal{F}$?",6
aimo3-q9-m10,"Let $\mathcal{F}$ be the set of functions $\alpha \colon \mathbb{Z}\to \mathbb{Z}$ for which there are only finitely many $n \in \mathbb{Z}$ such that $\alpha(n) \neq 0$. For two functions $\alpha$ and $\beta$ in $\mathcal{F}$, define their product $\alpha\star\beta$ to be $\sum\limits_{n\in\mathbb{Z}} \alpha(n)\cdot \beta(n)$. Also, for $n\in\mathbb{Z}$, define a shift operator $S_n \colon \mathcal{F}\to \mathcal{F}$ by $S_n(\alpha)(t)=\alpha(t+n)$ for all $t \in \mathbb{Z}$. A function $\alpha \in \mathcal{F}$ is called \emph{shifty} if \begin{itemize} \item $\alpha(m)=0$ for all integers $m<0$ and $m>10$ and \item There exists $\beta \in \mathcal{F}$ and integers $k \neq l$ such that for all $n \in \mathbb{Z}$ \begin{equation*} S_n(\alpha)\star\beta = \begin{cases} 1 & n \in \{k,l\} \\ 0 & n \not \in \{k,l\} \end{cases} \; . \end{equation*} \end{itemize} How many shifty functions are there in $\mathcal{F}$?",270
aimo3-q9-m11,"Let $\mathcal{F}$ be the set of functions $\alpha \colon \mathbb{Z}\to \mathbb{Z}$ for which there are only finitely many $n \in \mathbb{Z}$ such that $\alpha(n) \neq 0$. For two functions $\alpha$ and $\beta$ in $\mathcal{F}$, define their product $\alpha\star\beta$ to be $\sum\limits_{n\in\mathbb{Z}} \alpha(n)\cdot \beta(n)$. Also, for $n\in\mathbb{Z}$, define a shift operator $S_n \colon \mathcal{F}\to \mathcal{F}$ by $S_n(\alpha)(t)=\alpha(t+n)$ for all $t \in \mathbb{Z}$. A function $\alpha \in \mathcal{F}$ is called \emph{shifty} if \begin{itemize} \item $\alpha(m)=0$ for all integers $m<0$ and $m>11$ and \item There exists $\beta \in \mathcal{F}$ and integers $k \neq l$ such that for all $n \in \mathbb{Z}$ \begin{equation*} S_n(\alpha)\star\beta = \begin{cases} 1 & n \in \{k,l\} \\ 0 & n \not \in \{k,l\} \end{cases} \; . \end{equation*} \end{itemize} How many shifty functions are there in $\mathcal{F}$?",338
aimo3-q9-m2,"Let $\mathcal{F}$ be the set of functions $\alpha \colon \mathbb{Z}\to \mathbb{Z}$ for which there are only finitely many $n \in \mathbb{Z}$ such that $\alpha(n) \neq 0$. For two functions $\alpha$ and $\beta$ in $\mathcal{F}$, define their product $\alpha\star\beta$ to be $\sum\limits_{n\in\mathbb{Z}} \alpha(n)\cdot \beta(n)$. Also, for $n\in\mathbb{Z}$, define a shift operator $S_n \colon \mathcal{F}\to \mathcal{F}$ by $S_n(\alpha)(t)=\alpha(t+n)$ for all $t \in \mathbb{Z}$. A function $\alpha \in \mathcal{F}$ is called \emph{shifty} if \begin{itemize} \item $\alpha(m)=0$ for all integers $m<0$ and $m>2$ and \item There exists $\beta \in \mathcal{F}$ and integers $k \neq l$ such that for all $n \in \mathbb{Z}$ \begin{equation*} S_n(\alpha)\star\beta = \begin{cases} 1 & n \in \{k,l\} \\ 0 & n \not \in \{k,l\} \end{cases} \; . \end{equation*} \end{itemize} How many shifty functions are there in $\mathcal{F}$?",14
aimo3-q9-m3,"Let $\mathcal{F}$ be the set of functions $\alpha \colon \mathbb{Z}\to \mathbb{Z}$ for which there are only finitely many $n \in \mathbb{Z}$ such that $\alpha(n) \neq 0$. For two functions $\alpha$ and $\beta$ in $\mathcal{F}$, define their product $\alpha\star\beta$ to be $\sum\limits_{n\in\mathbb{Z}} \alpha(n)\cdot \beta(n)$. Also, for $n\in\mathbb{Z}$, define a shift operator $S_n \colon \mathcal{F}\to \mathcal{F}$ by $S_n(\alpha)(t)=\alpha(t+n)$ for all $t \in \mathbb{Z}$. A function $\alpha \in \mathcal{F}$ is called \emph{shifty} if \begin{itemize} \item $\alpha(m)=0$ for all integers $m<0$ and $m>3$ and \item There exists $\beta \in \mathcal{F}$ and integers $k \neq l$ such that for all $n \in \mathbb{Z}$ \begin{equation*} S_n(\alpha)\star\beta = \begin{cases} 1 & n \in \{k,l\} \\ 0 & n \not \in \{k,l\} \end{cases} \; . \end{equation*} \end{itemize} How many shifty functions are there in $\mathcal{F}$?",24
aimo3-q9-m4,"Let $\mathcal{F}$ be the set of functions $\alpha \colon \mathbb{Z}\to \mathbb{Z}$ for which there are only finitely many $n \in \mathbb{Z}$ such that $\alpha(n) \neq 0$. For two functions $\alpha$ and $\beta$ in $\mathcal{F}$, define their product $\alpha\star\beta$ to be $\sum\limits_{n\in\mathbb{Z}} \alpha(n)\cdot \beta(n)$. Also, for $n\in\mathbb{Z}$, define a shift operator $S_n \colon \mathcal{F}\to \mathcal{F}$ by $S_n(\alpha)(t)=\alpha(t+n)$ for all $t \in \mathbb{Z}$. A function $\alpha \in \mathcal{F}$ is called \emph{shifty} if \begin{itemize} \item $\alpha(m)=0$ for all integers $m<0$ and $m>4$ and \item There exists $\beta \in \mathcal{F}$ and integers $k \neq l$ such that for all $n \in \mathbb{Z}$ \begin{equation*} S_n(\alpha)\star\beta = \begin{cases} 1 & n \in \{k,l\} \\ 0 & n \not \in \{k,l\} \end{cases} \; . \end{equation*} \end{itemize} How many shifty functions are there in $\mathcal{F}$?",40
aimo3-q9-m5,"Let $\mathcal{F}$ be the set of functions $\alpha \colon \mathbb{Z}\to \mathbb{Z}$ for which there are only finitely many $n \in \mathbb{Z}$ such that $\alpha(n) \neq 0$. For two functions $\alpha$ and $\beta$ in $\mathcal{F}$, define their product $\alpha\star\beta$ to be $\sum\limits_{n\in\mathbb{Z}} \alpha(n)\cdot \beta(n)$. Also, for $n\in\mathbb{Z}$, define a shift operator $S_n \colon \mathcal{F}\to \mathcal{F}$ by $S_n(\alpha)(t)=\alpha(t+n)$ for all $t \in \mathbb{Z}$. A function $\alpha \in \mathcal{F}$ is called \emph{shifty} if \begin{itemize} \item $\alpha(m)=0$ for all integers $m<0$ and $m>5$ and \item There exists $\beta \in \mathcal{F}$ and integers $k \neq l$ such that for all $n \in \mathbb{Z}$ \begin{equation*} S_n(\alpha)\star\beta = \begin{cases} 1 & n \in \{k,l\} \\ 0 & n \not \in \{k,l\} \end{cases} \; . \end{equation*} \end{itemize} How many shifty functions are there in $\mathcal{F}$?",58
aimo3-q9-m50,"Let $\mathcal{F}$ be the set of functions $\alpha \colon \mathbb{Z}\to \mathbb{Z}$ for which there are only finitely many $n \in \mathbb{Z}$ such that $\alpha(n) \neq 0$. For two functions $\alpha$ and $\beta$ in $\mathcal{F}$, define their product $\alpha\star\beta$ to be $\sum\limits_{n\in\mathbb{Z}} \alpha(n)\cdot \beta(n)$. Also, for $n\in\mathbb{Z}$, define a shift operator $S_n \colon \mathcal{F}\to \mathcal{F}$ by $S_n(\alpha)(t)=\alpha(t+n)$ for all $t \in \mathbb{Z}$. A function $\alpha \in \mathcal{F}$ is called \emph{shifty} if \begin{itemize} \item $\alpha(m)=0$ for all integers $m<0$ and $m>50$ and \item There exists $\beta \in \mathcal{F}$ and integers $k \neq l$ such that for all $n \in \mathbb{Z}$ \begin{equation*} S_n(\alpha)\star\beta = \begin{cases} 1 & n \in \{k,l\} \\ 0 & n \not \in \{k,l\} \end{cases} \; . \end{equation*} \end{itemize} How many shifty functions are there in $\mathcal{F}$?",86774
aimo3-q9-m6,"Let $\mathcal{F}$ be the set of functions $\alpha \colon \mathbb{Z}\to \mathbb{Z}$ for which there are only finitely many $n \in \mathbb{Z}$ such that $\alpha(n) \neq 0$. For two functions $\alpha$ and $\beta$ in $\mathcal{F}$, define their product $\alpha\star\beta$ to be $\sum\limits_{n\in\mathbb{Z}} \alpha(n)\cdot \beta(n)$. Also, for $n\in\mathbb{Z}$, define a shift operator $S_n \colon \mathcal{F}\to \mathcal{F}$ by $S_n(\alpha)(t)=\alpha(t+n)$ for all $t \in \mathbb{Z}$. A function $\alpha \in \mathcal{F}$ is called \emph{shifty} if \begin{itemize} \item $\alpha(m)=0$ for all integers $m<0$ and $m>6$ and \item There exists $\beta \in \mathcal{F}$ and integers $k \neq l$ such that for all $n \in \mathbb{Z}$ \begin{equation*} S_n(\alpha)\star\beta = \begin{cases} 1 & n \in \{k,l\} \\ 0 & n \not \in \{k,l\} \end{cases} \; . \end{equation*} \end{itemize} How many shifty functions are there in $\mathcal{F}$?",84
aimo3-q9-m7,"Let $\mathcal{F}$ be the set of functions $\alpha \colon \mathbb{Z}\to \mathbb{Z}$ for which there are only finitely many $n \in \mathbb{Z}$ such that $\alpha(n) \neq 0$. For two functions $\alpha$ and $\beta$ in $\mathcal{F}$, define their product $\alpha\star\beta$ to be $\sum\limits_{n\in\mathbb{Z}} \alpha(n)\cdot \beta(n)$. Also, for $n\in\mathbb{Z}$, define a shift operator $S_n \colon \mathcal{F}\to \mathcal{F}$ by $S_n(\alpha)(t)=\alpha(t+n)$ for all $t \in \mathbb{Z}$. A function $\alpha \in \mathcal{F}$ is called \emph{shifty} if \begin{itemize} \item $\alpha(m)=0$ for all integers $m<0$ and $m>7$ and \item There exists $\beta \in \mathcal{F}$ and integers $k \neq l$ such that for all $n \in \mathbb{Z}$ \begin{equation*} S_n(\alpha)\star\beta = \begin{cases} 1 & n \in \{k,l\} \\ 0 & n \not \in \{k,l\} \end{cases} \; . \end{equation*} \end{itemize} How many shifty functions are there in $\mathcal{F}$?",116
aimo3-q9-m9,"Let $\mathcal{F}$ be the set of functions $\alpha \colon \mathbb{Z}\to \mathbb{Z}$ for which there are only finitely many $n \in \mathbb{Z}$ such that $\alpha(n) \neq 0$. For two functions $\alpha$ and $\beta$ in $\mathcal{F}$, define their product $\alpha\star\beta$ to be $\sum\limits_{n\in\mathbb{Z}} \alpha(n)\cdot \beta(n)$. Also, for $n\in\mathbb{Z}$, define a shift operator $S_n \colon \mathcal{F}\to \mathcal{F}$ by $S_n(\alpha)(t)=\alpha(t+n)$ for all $t \in \mathbb{Z}$. A function $\alpha \in \mathcal{F}$ is called \emph{shifty} if \begin{itemize} \item $\alpha(m)=0$ for all integers $m<0$ and $m>9$ and \item There exists $\beta \in \mathcal{F}$ and integers $k \neq l$ such that for all $n \in \mathbb{Z}$ \begin{equation*} S_n(\alpha)\star\beta = \begin{cases} 1 & n \in \{k,l\} \\ 0 & n \not \in \{k,l\} \end{cases} \; . \end{equation*} \end{itemize} How many shifty functions are there in $\mathcal{F}$?",210
arc145-c-n10000,"Let $N = 10000$. Given a permutation $P$ of $(1, 2, \ldots, 2N)$, the score is defined as follows: divide $P$ into two subsequences $A$ and $B$, each of length $N$ (maintaining order), then calculate $\sum_{i=1}^{N} A_i \times B_i$. The score is the maximum value achievable across all possible divisions.

Find the maximum score $M$ across all permutations of $(1, 2, \ldots, 2N)$, then count how many permutations achieve this maximum score. Output the count modulo $998244353$.",391163238
arc145-c-n2,"Let $N = 2$. Given a permutation $P$ of $(1, 2, \ldots, 2N)$, the score is defined as follows: divide $P$ into two subsequences $A$ and $B$, each of length $N$ (maintaining order), then calculate $\sum_{i=1}^{N} A_i \times B_i$. The score is the maximum value achievable across all possible divisions.

Find the maximum score $M$ across all permutations of $(1, 2, \ldots, 2N)$, then count how many permutations achieve this maximum score. Output the count modulo $998244353$.",16
arc146-c-n146,"Let $N = 146$. Count the number of sets $S$ of non-negative integers in the range $[0, 2^N)$ where every non-empty subset $T$ of $S$ satisfies at least one of the following conditions:
- $T$ has an odd number of elements, OR
- The XOR of all elements in $T$ is non-zero.

Output the count modulo $998244353$.",743874490
arc146-c-n2,"Let $N = 2$. Count the number of sets $S$ of non-negative integers in the range $[0, 2^N)$ where every non-empty subset $T$ of $S$ satisfies at least one of the following conditions:
- $T$ has an odd number of elements, OR
- The XOR of all elements in $T$ is non-zero.

Output the count modulo $998244353$.",15
imo-2010-sl-c2-n14,"On some planet, there are $2^{14}$ countries. Each country has a flag $14$ units wide and one unit high composed of $14$ fields of size $1 \times 1$, each field being either yellow or blue. No two countries have the same flag.

We say that a set of $14$ flags is diverse if these flags can be arranged into a $14 \times 14$ square so that all $14$ fields on its main diagonal will have the same color.

Determine the smallest positive integer $M$ such that among any $M$ distinct flags, there exists a diverse set of $14$ flags.",4097
imo-2010-sl-c2-n16,"On some planet, there are $2^{16}$ countries. Each country has a flag $16$ units wide and one unit high composed of $16$ fields of size $1 \times 1$, each field being either yellow or blue. No two countries have the same flag.

We say that a set of $16$ flags is diverse if these flags can be arranged into a $16 \times 16$ square so that all $16$ fields on its main diagonal will have the same color.

Determine the smallest positive integer $M$ such that among any $M$ distinct flags, there exists a diverse set of $16$ flags.",16385
imo-2011-sl-c1-n6,"We are given a balance and $6$ weights of weight $2^0, 2^1, 2^2, 2^3, 2^4, 2^5$. We are to place each of the $6$ weights on the balance, one after another, in such a way that the right pan is never heavier than the left pan.

At each step we choose one of the weights that has not yet been placed on the balance, and place it on either the left pan or the right pan, until all of the weights have been placed.

Determine the number of ways in which this can be done.",10395
imo-2011-sl-c1-n7,"We are given a balance and $7$ weights of weight $2^0, 2^1, 2^2, 2^3, 2^4, 2^5, 2^6$. We are to place each of the $7$ weights on the balance, one after another, in such a way that the right pan is never heavier than the left pan.

At each step we choose one of the weights that has not yet been placed on the balance, and place it on either the left pan or the right pan, until all of the weights have been placed.

Determine the number of ways in which this can be done.",135135
imo-2017-sl-c2-n4,"Let $n = 4$. Define a chameleon to be any sequence of $3n$ letters, with exactly $n$ occurrences of each of the letters $a$, $b$, and $c$. Define a swap to be the transposition of two adjacent letters in a chameleon.

For any chameleon $X$, let $f(X)$ be the maximum number of swaps needed to transform $X$ into any other chameleon. Find the maximum value of $f(X)$ over all chameleons $X$.",24
imo-2017-sl-c2-n58,"Let $n = 58$. Define a chameleon to be any sequence of $3n$ letters, with exactly $n$ occurrences of each of the letters $a$, $b$, and $c$. Define a swap to be the transposition of two adjacent letters in a chameleon.

For any chameleon $X$, let $f(X)$ be the maximum number of swaps needed to transform $X$ into any other chameleon. Find the maximum value of $f(X)$ over all chameleons $X$.",5046
imo-2017-sl-c2-n82,"Let $n = 82$. Define a chameleon to be any sequence of $3n$ letters, with exactly $n$ occurrences of each of the letters $a$, $b$, and $c$. Define a swap to be the transposition of two adjacent letters in a chameleon.

For any chameleon $X$, let $f(X)$ be the maximum number of swaps needed to transform $X$ into any other chameleon. Find the maximum value of $f(X)$ over all chameleons $X$.",10086
imo-2019-p5-n10,"The Bank of Bath issues coins with an H on one side and a T on the other. Harry has $10$ of these coins arranged in a line from left to right. He repeatedly performs the following operation: if there are exactly $k > 0$ coins showing H, then he turns over the $k$th coin from the left; otherwise, all coins show T and he stops.

For each initial configuration $C$, let $L(C)$ denote the number of operations before Harry stops.

Determine the sum of $L(C)$ over all $2^{10}$ possible initial configurations $C$.",28160
imo-2019-p5-n8,"The Bank of Bath issues coins with an H on one side and a T on the other. Harry has $8$ of these coins arranged in a line from left to right. He repeatedly performs the following operation: if there are exactly $k > 0$ coins showing H, then he turns over the $k$th coin from the left; otherwise, all coins show T and he stops.

For each initial configuration $C$, let $L(C)$ denote the number of operations before Harry stops.

Determine the sum of $L(C)$ over all $2^8$ possible initial configurations $C$.",4608
imo-2020-p4-n100,"There are $10000$ stations on a slope of a mountain, all at different altitudes. Each of two cable car companies, $A$ and $B$, operates $k$ cable cars; each cable car provides a transfer from one station to a higher one (with no intermediate stops). The $k$ cable cars of $A$ have $k$ different starting points and $k$ different finishing points, and a cable car that starts higher also finishes higher. The same conditions hold for $B$.

We say that two stations are linked by a company if one can start from the lower station and reach the higher one by using one or more cars of that company (no other movements between stations are allowed).

Determine the smallest positive integer $k$ for which one can guarantee that there are two stations that are linked by both companies.",9901
imo-2020-p4-n33,"There are $1089$ stations on a slope of a mountain, all at different altitudes. Each of two cable car companies, $A$ and $B$, operates $k$ cable cars; each cable car provides a transfer from one station to a higher one (with no intermediate stops). The $k$ cable cars of $A$ have $k$ different starting points and $k$ different finishing points, and a cable car that starts higher also finishes higher. The same conditions hold for $B$.

We say that two stations are linked by a company if one can start from the lower station and reach the higher one by using one or more cars of that company (no other movements between stations are allowed).

Determine the smallest positive integer $k$ for which one can guarantee that there are two stations that are linked by both companies.",1057
imo-2020-sl-c1-n18,"Find the number of permutations $a_1, a_2, \ldots, a_{18}$ of the sequence $1, 2, \ldots, 18$ satisfying $a_1 \le 2a_2 \le 3a_3 \le \cdots \le 18a_{18}$.",4181
imo-2020-sl-c1-n23,"Find the number of permutations $a_1, a_2, \ldots, a_{23}$ of the sequence $1, 2, \ldots, 23$ satisfying $a_1 \le 2a_2 \le 3a_3 \le \cdots \le 23a_{23}$.",46368
imo-2021-sl-c2-n100,"Let $n = 100$. An integer $m \ge n+1$ is called $n$-colourful if, given infinitely many marbles in each of $n$ colours $C_1, C_2, \dots, C_n$, it is possible to place $m$ of them around a circle so that in any group of $n+1$ consecutive marbles there is at least one marble of colour $C_i$ for each $i = 1, \dots, n$.

Find the largest positive integer which is not $n$-colourful.",9901
imo-2021-sl-c2-n200,"Let $n = 200$. An integer $m \ge n+1$ is called $n$-colourful if, given infinitely many marbles in each of $n$ colours $C_1, C_2, \dots, C_n$, it is possible to place $m$ of them around a circle so that in any group of $n+1$ consecutive marbles there is at least one marble of colour $C_i$ for each $i = 1, \dots, n$.

Find the largest positive integer which is not $n$-colourful.",39801
imo-2021-sl-c2-n4,"Let $n = 4$. An integer $m \ge n+1$ is called $n$-colourful if, given infinitely many marbles in each of $n$ colours $C_1, C_2, \dots, C_n$, it is possible to place $m$ of them around a circle so that in any group of $n+1$ consecutive marbles there is at least one marble of colour $C_i$ for each $i = 1, \dots, n$.

Find the largest positive integer which is not $n$-colourful.",13
imo-2022-p6-n200,"A Nordic square is an $n \times n$ board containing all the integers from $1$ to $n^2$ so that each cell contains exactly one number. Two different cells are considered adjacent if they share an edge. Every cell that is adjacent only to cells containing larger numbers is called a valley. An uphill path is a sequence of one or more cells such that:

(i) the first cell in the sequence is a valley,

(ii) each subsequent cell in the sequence is adjacent to the previous cell, and

(iii) the numbers written in the cells in the sequence are in increasing order.

Find the smallest possible total number of uphill paths in a Nordic square when $n = 200$.",79601
imo-2022-p6-n4,"A Nordic square is an $n \times n$ board containing all the integers from $1$ to $n^2$ so that each cell contains exactly one number. Two different cells are considered adjacent if they share an edge. Every cell that is adjacent only to cells containing larger numbers is called a valley. An uphill path is a sequence of one or more cells such that:

(i) the first cell in the sequence is a valley,

(ii) each subsequent cell in the sequence is adjacent to the previous cell, and

(iii) the numbers written in the cells in the sequence are in increasing order.

Find the smallest possible total number of uphill paths in a Nordic square when $n = 4$.",25
imo-2023-p5-g3456,"Let n be a positive integer. A Japanese triangle consists of 1 + 2 + · · · + n circles arranged in an equilateral triangular shape such that for each 1 ≤ i ≤ n, the i th row contains exactly i circles, exactly one of which is colored red. A ninja path in a Japanese triangle is a sequence of n circles obtained by starting in the top row, then repeatedly going from a circle to one of the two circles immediately below it and finishing in the bottom row. f(n) is defined to be the greatest k such that in each Japanese triangle there is a ninja path containing at least k red circles. g(n) is defined to be f(1) + f(2) + f(3) ... + f(n). Calculate g(3456).",37389
imo-2024-p5-f3,"Turbo the snail is in the top row of a grid with k+2 rows and k+1 columns and wants to get to the bottom row, where k >= 3. However, there are k hidden monsters, one in every row except the first and last, with no two monsters in the same column. Turbo makes a series of attempts to go from the first row to the last row. On each attempt, he chooses to start on any cell in the first row, then repeatedly moves to an orthogonal neighbor. (He is allowed to return to a previously visited cell.) If Turbo reaches a cell with a monster, his attempt ends and he is transported back to the first row to start a new attempt. The monsters do not move between attempts, and Turbo remembers whether or not each cell he has visited contains a monster. If he reaches any cell in the last row, his attempt ends and Turbo wins. Let f(k) be the smallest integer n such that Turbo has a strategy which guarantees being able to reach the bottom row in at most n attempts, regardless of how the monsters are placed. Calculate f(3).",3
imo-2024-p5-f4,"Turbo the snail is in the top row of a grid with k+2 rows and k+1 columns and wants to get to the bottom row, where k >= 4. However, there are k hidden monsters, one in every row except the first and last, with no two monsters in the same column. Turbo makes a series of attempts to go from the first row to the last row. On each attempt, he chooses to start on any cell in the first row, then repeatedly moves to an orthogonal neighbor. (He is allowed to return to a previously visited cell.) If Turbo reaches a cell with a monster, his attempt ends and he is transported back to the first row to start a new attempt. The monsters do not move between attempts, and Turbo remembers whether or not each cell he has visited contains a monster. If he reaches any cell in the last row, his attempt ends and Turbo wins. Let f(k) be the smallest integer n such that Turbo has a strategy which guarantees being able to reach the bottom row in at most n attempts, regardless of how the monsters are placed. Calculate f(4).",3
imo-2024-p5-g210,"Turbo the snail is in the top row of a grid with k+2 rows and k+1 columns and wants to get to the bottom row, where k >= 4. However, there are k hidden monsters, one in every row except the first and last, with no two monsters in the same column. Turbo makes a series of attempts to go from the first row to the last row. On each attempt, he chooses to start on any cell in the first row, then repeatedly moves to an orthogonal neighbor. (He is allowed to return to a previously visited cell.) If Turbo reaches a cell with a monster, his attempt ends and he is transported back to the first row to start a new attempt. The monsters do not move between attempts, and Turbo remembers whether or not each cell he has visited contains a monster. If he reaches any cell in the last row, his attempt ends and Turbo wins. Let f(k) be the smallest integer n such that Turbo has a strategy which guarantees being able to reach the bottom row in at most n attempts, regardless of how the monsters are placed. Let g(x) = f(4) + f(5) + ... + f(x), where x >= 4. Calculate g(210).",621
imo-2024-p5-g5,"Turbo the snail is in the top row of a grid with k+2 rows and k+1 columns and wants to get to the bottom row, where k >= 4. However, there are k hidden monsters, one in every row except the first and last, with no two monsters in the same column. Turbo makes a series of attempts to go from the first row to the last row. On each attempt, he chooses to start on any cell in the first row, then repeatedly moves to an orthogonal neighbor. (He is allowed to return to a previously visited cell.) If Turbo reaches a cell with a monster, his attempt ends and he is transported back to the first row to start a new attempt. The monsters do not move between attempts, and Turbo remembers whether or not each cell he has visited contains a monster. If he reaches any cell in the last row, his attempt ends and Turbo wins. Let f(k) be the smallest integer n such that Turbo has a strategy which guarantees being able to reach the bottom row in at most n attempts, regardless of how the monsters are placed. Let g(x) = f(4) + f(5) + ... + f(x), where x >= 4. Calculate g(5).",6
imo-2024-p5,"Turbo the snail is in the top row of a grid with 2024 rows and 2023 columns and wants to get to the bottom row. However, there are 2022 hidden monsters, one in every row except the first and last, with no two monsters in the same column. Turbo makes a series of attempts to go from the first row to the last row. On each attempt, he chooses to start on any cell in the first row, then repeatedly moves to an orthogonal neighbor. (He is allowed to return to a previously visited cell.) If Turbo reaches a cell with a monster, his attempt ends and he is transported back to the first row to start a new attempt. The monsters do not move between attempts, and Turbo remembers whether or not each cell he has visited contains a monster. If he reaches any cell in the last row, his attempt ends and Turbo wins. Find the smallest integer n such that Turbo has a strategy which guarantees being able to reach the bottom row in at most n attempts, regardless of how the monsters are placed.",3
imo-2025-p6-simplified-4,"Consider a 4 × 4 grid of unit squares. Matilda wishes to place on the grid some rectangular tiles, possibly of different sizes, such that each side of every tile lies on a grid line and every unit square is covered by at most one tile. Determine the minimum number of tiles Matilda needs to place so that each row and each column of the grid has exactly one unit square that is not covered by any tile.",5
imo-2025-p6-simplified-9,"Consider a 9 × 9 grid of unit squares. Matilda wishes to place on the grid some rectangular tiles, possibly of different sizes, such that each side of every tile lies on a grid line and every unit square is covered by at most one tile. Determine the minimum number of tiles Matilda needs to place so that each row and each column of the grid has exactly one unit square that is not covered by any tile.",12
imo-2025-p6,"Consider a 2025 × 2025 grid of unit squares. Matilda wishes to place on the grid some rectangular tiles, possibly of different sizes, such that each side of every tile lies on a grid line and every unit square is covered by at most one tile. Determine the minimum number of tiles Matilda needs to place so that each row and each column of the grid has exactly one unit square that is not covered by any tile.",2112
pe-450-T1000,"A hypocycloid is the curve drawn by a point on a small circle rolling inside a larger circle. The parametric equations of a hypocycloid centered at the origin, and starting at the right most point is given by:

$x(t) = (R - r) \cos(t) + r \cos(\frac {R - r} r t)$
$y(t) = (R - r) \sin(t) - r \sin(\frac {R - r} r t)$

Where $R$ is the radius of the large circle and $r$ the radius of the small circle.

Let $C(R, r)$ be the set of distinct points with integer coordinates on the hypocycloid with radius $R$ and $r$ and for which there is a corresponding value of $t$ such that $\sin(t)$ and $\cos(t)$ are rational numbers.

Let $S(R, r) = \sum_{(x,y) \in C(R, r)} |x| + |y|$ be the sum of the absolute values of the $x$ and $y$ coordinates of the points in $C(R, r)$.

Let $T(N) = \sum_{R = 3}^N \sum_{r=1}^{\lfloor \frac {R - 1} 2 \rfloor} S(R, r)$ be the sum of $S(R, r)$ for $R$ and $r$ positive integers, $R\leq N$ and $2r < R$.

You are given $T(3) = 10$, $T(10) = 524$, $T(100) = 580442$.

Find $T(10^3)$.",REDACTED
pe-474-F50,"For a positive integer $n$ and digits $d$, we define $F(n, d)$ as the number of the divisors of $n$ whose last digits equal $d$.

For example, $F(84, 4) = 3$. Among the divisors of $84$ ($1, 2, 3, 4, 6, 7, 12, 14, 21, 28, 42, 84$), three of them ($4, 14, 84$) have the last digit $4$.

We can also verify that $F(12!, 12) = 11$.

Find $F(50!, 123)$.",REDACTED
pe-478-E10,"Let us consider mixtures of three substances: A, B and C. A mixture can be described by a ratio of the amounts of A, B, and C in it, i.e., $(a : b : c)$. For example, a mixture described by the ratio $(2 : 3 : 5)$ contains $20\%$ A, $30\%$ B and $50\%$ C.

For the purposes of this problem, we cannot separate the individual components from a mixture. However, we can combine different amounts of different mixtures to form mixtures with new ratios.

For example, say we have three mixtures with ratios $(3 : 0 : 2)$, $(3: 6 : 11)$ and $(3 : 3 : 4)$. By mixing $10$ units of the first, $20$ units of the second and $30$ units of the third, we get a new mixture with ratio $(6 : 5 : 9)$, since:

$(10 \cdot \tfrac 3 5$ + $20 \cdot \tfrac 3 {20} + 30 \cdot \tfrac 3 {10} : 10 \cdot \tfrac 0 5 + 20 \cdot \tfrac 6 {20} + 30 \cdot \tfrac 3 {10} : 10 \cdot \tfrac 2 5 + 20 \cdot \tfrac {11} {20} + 30 \cdot \tfrac 4 {10})
= (18 : 15 : 27) = (6 : 5 : 9)$

However, with the same three mixtures, it is impossible to form the ratio $(3 : 2 : 1)$, since the amount of B is always less than the amount of C.

Let $n$ be a positive integer. Suppose that for every triple of integers $(a, b, c)$ with $0 \le a, b, c \le n$ and $\gcd(a, b, c) = 1$, we have a mixture with ratio $(a : b : c)$. Let $M(n)$ be the set of all such mixtures.

For example, $M(2)$ contains the $19$ mixtures with the following ratios:

$$\begin{align}
\{&(0 : 0 : 1), (0 : 1 : 0), (0 : 1 : 1), (0 : 1 : 2), (0 : 2 : 1),\\
&(1 : 0 : 0), (1 : 0 : 1), (1 : 0 : 2), (1 : 1 : 0), (1 : 1 : 1),\\
&(1 : 1 : 2), (1 : 2 : 0), (1 : 2 : 1), (1 : 2 : 2), (2 : 0 : 1),\\
&(2 : 1 : 0), (2 : 1 : 1), (2 : 1 : 2), (2 : 2 : 1)\}.
\end{align}$$

Let $E(n)$ be the number of subsets of $M(n)$ which can produce the mixture with ratio $(1 : 1 : 1)$, i.e., the mixture with equal parts A, B and C.

You are given $E(1) = 103$, $E(2) = 520447$.

Find $E(10) \bmod 11^8$.",REDACTED
pe-626-c8,"A binary matrix is a matrix consisting entirely of $0$s and $1$s. Consider the following transformations that can be performed on a binary matrix:

- Swap any two rows

- Swap any two columns

- Flip all elements in a single row ($1$s become $0$s, $0$s become $1$s)

- Flip all elements in a single column

Two binary matrices $A$ and $B$ will be considered equivalent if there is a sequence of such transformations that when applied to $A$ yields $B$. For example, the following two matrices are equivalent:

$A=\begin{pmatrix}
  1 & 0 & 1 \\
  0 & 0 & 1 \\
  0 & 0 & 0 \\
\end{pmatrix} \quad B=\begin{pmatrix}
  0 & 0 & 0 \\
  1 & 0 & 0 \\
  0 & 0 & 1 \\
\end{pmatrix}$
via the sequence of two transformations ""Flip all elements in column 3"" followed by ""Swap rows 1 and 2"".

Define $c(n)$ to be the maximum number of $n\times n$ binary matrices that can be found such that no two are equivalent. For example, $c(3)=3$. You are also given that $c(5)=39$.

Find $c(8)$.",REDACTED
pe-652-D10000,"Consider the values of $\log_2(8)$, $\log_4(64)$ and $\log_3(27)$. All three are equal to $3$.

Generally, the function $f(m,n)=\log_m(n)$ over integers $m,n \ge 2$ has the property that

$f(m_1,n_1)=f(m_2,n_2)$ if

- $\, m_1=a^e, n_1=a^f, m_2=b^e,n_2=b^f \,$ for some integers $a,b,e,f \, \,$ or

-  $ \, m_1=a^e, n_1=b^e, m_2=a^f,n_2=b^f \,$ for some integers $a,b,e,f \,$

We call a function $g(m,n)$ over integers $m,n \ge 2$ proto-logarithmic  if

- $\quad  \, \, \, \, g(m_1,n_1)=g(m_2,n_2)$ if any integers $a,b,e,f$ fulfilling 1. or 2. can be found

- and $\, g(m_1,n_1) \ne g(m_2,n_2)$ if no integers $a,b,e,f$ fulfilling 1. or 2. can be found.

Let $D(N)$ be the number of distinct values that any proto-logarithmic function $g(m,n)$ attains over $2\le m, n\le N$.

For example, $D(5)=13$, $D(10)=69$, $D(100)=9607$.

Find $D(10000)$.",REDACTED
pe-677-g10,"Let $g(n)$ be the number of undirected graphs with $n$ nodes satisfying the following properties:

- The graph is connected and has no cycles or multiple edges.

- Each node is either red, blue, or yellow.

- A red node may have no more than 4 edges connected to it.

- A blue or yellow node may have no more than 3 edges connected to it.

- An edge may not directly connect a yellow node to a yellow node.

For example, $g(2)=5$, $g(3)=15$, and $g(4) = 57$.

Find $g(10)$.",REDACTED
pe-681-SP100,"Given positive integers $a \le b \le c \le d$, it may be possible to form quadrilaterals with edge lengths $a,b,c,d$ (in any order). When this is the case, let $M(a,b,c,d)$ denote the maximal area of such a quadrilateral.
For example, $M(2,2,3,3)=6$, attained e.g. by a $2\times 3$ rectangle.

Let $SP(n)$ be the sum of $a+b+c+d$ over all choices $a \le b \le c \le d$ for which $M(a,b,c,d)$ is a positive integer not exceeding $n$.

$SP(10)=186$.

Find $SP(100)$.",REDACTED
pe-711-S12,"Oscar and Eric play the following game. First, they agree on a positive integer $n$, and they begin by writing its binary representation on a blackboard. They then take turns, with Oscar going first, to write a number on the blackboard in binary representation, such that the sum of all written numbers does not exceed $2n$.

The game ends when there are no valid moves left. Oscar wins if the number of $1$s on the blackboard is odd, and Eric wins if it is even.

Let $S(N)$ be the sum of all $n \le 2^N$ for which Eric can guarantee winning, assuming optimal play.

For example, the first few values of $n$ for which Eric can guarantee winning are $1,3,4,7,15,16$. Hence $S(4)=46$.

Find $S(12)$.",REDACTED
pe-712-S100,"For any integer $n>0$ and prime number $p,$ define $\nu_p(n)$ as the greatest integer $r$ such that $p^r$ divides $n$.

Define $$D(n, m)  = \sum_{p \text{ prime}} \left| \nu_p(n) - \nu_p(m)\right|.$$ For example, $D(14,24) = 4$.

Furthermore, define $$S(N) = \sum_{1 \le n, m \le N} D(n, m).$$ You are given $S(10) = 210$.

Find $S(10^2)$.",REDACTED
pe-732-Q15,"$N$ trolls are in a hole that is $D_N$ cm deep. The $n$-th troll is characterized by:

- the distance from his feet to his shoulders in cm, $h_n$

- the length of his arms in cm, $l_n$

- his IQ (Irascibility Quotient), $q_n$.

Trolls can pile up on top of each other, with each troll standing on the shoulders of the one below him. A troll can climb out of the hole and escape if his hands can reach to the surface. Once a troll escapes he cannot participate any further in the escaping effort.

The trolls execute an optimal strategy for maximizing the total IQ of the escaping trolls, defined as $Q(N)$.

Let

$r_n = \left[ \left( 5^n \bmod (10^9 + 7) \right) \bmod 101 \right] + 50$

$h_n = r_{3n}$

$l_n = r_{3n+1}$

$q_n = r_{3n+2}$

$D_N = \frac{1}{\sqrt{2}} \sum_{n=0}^{N-1} h_n$.

For example, the first troll ($n=0$) is 51cm tall to his shoulders, has 55cm long arms, and has an IQ of 75.

You are given that $Q(5) = 401$.

Find $Q(15)$.",REDACTED
pe-791-S1000,"Denote the average of $k$ numbers $x_1, ..., x_k$ by $\bar{x} = \frac{1}{k} \sum_i x_i$. Their variance is defined as $\frac{1}{k} \sum_i \left( x_i - \bar{x} \right) ^ 2$.

Let $S(n)$ be the sum of all quadruples of integers $(a,b,c,d)$ satisfying $1 \leq a \leq b \leq c \leq d \leq n$ such that their average is exactly twice their variance.

For $n=5$, there are $5$ such quadruples, namely: $(1, 1, 1, 3), (1, 1, 3, 3), (1, 2, 3, 4), (1, 3, 4, 4), (2, 2, 3, 5)$.

Hence $S(5)=48$.

Find $S(10^3)$.",REDACTED
pe-827-Q1000,"Define $Q(n)$ to be the smallest number that occurs in exactly $n$ Pythagorean triples $(a,b,c)$ where $a \lt b \lt c$.

For example, $15$ is the smallest number occurring in exactly $5$ Pythagorean triples:
$$(9,12,\mathbf{15})\quad (8,\mathbf{15},17)\quad (\mathbf{15},20,25)\quad (\mathbf{15},36,39)\quad (\mathbf{15},112,113)$$
and so $Q(5) = 15$.

You are also given $Q(10)=48$.

Find $Q(10^3)$.",REDACTED
pe-847-H20,"Jack has three plates in front of him. The giant has $N$ beans that he distributes to the three plates. All the beans look the same, but one of them is a magic bean. Jack doesn't know which one it is, but the giant knows.

Jack can ask the giant questions of the form: ""Does this subset of the beans contain the magic bean?"" In each question Jack may choose any subset of beans from a single plate, and the giant will respond truthfully.

If the three plates contain $a$, $b$ and $c$ beans respectively, we let $h(a, b, c)$ be the minimal number of questions Jack needs to ask in order to guarantee he locates the magic bean. For example, $h(1, 2, 3) = 3$ and $h(2, 3, 3) = 4$.

Let $H(N)$ be the sum of $h(a, b, c)$ over all triples of non-negative integers $a$, $b$, $c$ with $1 \leq a + b + c \leq N$.

You are given $H(6) = 203$.

Find $H(20)$.",REDACTED
pe-882-S10,"Dr. One and Dr. Zero are playing the following partisan game.

The game begins with one $1$, two $2$'s, three $3$'s, ..., $n$ $n$'s. Starting with Dr. One, they make moves in turn.

Dr. One chooses a number and changes it by removing a $1$ from its binary expansion.

Dr. Zero chooses a number and changes it by removing a $0$ from its binary expansion.

The player that is unable to move loses.

Note that leading zeros are not allowed in any binary expansion; in particular nobody can make a move on the number $0$.

They soon realize that Dr. Zero can never win the game. In order to make it more interesting, Dr. Zero is allowed to ""skip the turn"" several times, i.e. passing the turn back to Dr. One without making a move.

For example, when $n = 2$, Dr. Zero can win the game if allowed to skip $2$ turns. A sample game:
$$
[1, 2, 2]\xrightarrow{\textrm{Dr. One}}[1, 0, 2]\xrightarrow{\textrm{Dr. Zero}}[1, 0, 1]\xrightarrow{\textrm{Dr. One}}[1, 0, 0]\xrightarrow[\textrm{skip}]{\textrm{Dr. Zero}}
[1, 0, 0]\xrightarrow{\textrm{Dr. One}}[0, 0, 0]\xrightarrow[\textrm{skip}]{\textrm{Dr. Zero}}[0, 0, 0].
$$

Let $S(n)$ be the minimal number of skips needed so that Dr. Zero has a winning strategy.

You are given $S(2) = 2$, $S(5) = 17$.

Find $S(10)$.",REDACTED
pe-917-A10,"The sequence $s_n$ is defined by $s_1 = 102022661$ and $s_n = s_{n-1}^2 \bmod {998388889}$ for $n > 1$.

Let $a_n = s_{2n - 1}$ and $b_n = s_{2n}$ for $n=1,2,...$

Define an $N \times N$ matrix whose values are $M_{i,j} = a_i + b_j$.

Let $A(N)$ be the minimal path sum from $M_{1,1}$ (top left) to $M_{N,N}$ (bottom right), where each step is either right or down.

You are given $A(1) = 966774091$, $A(2) = 2388327490$.

Find $A(10)$.",REDACTED
pe-937-G7,"Let $\theta=\sqrt{-2}$.

Define $T$ to be the set of numbers of the form $a+b\theta$, where $a$ and $b$ are integers and either $a>0$, or $a=0$ and $b>0$. For a set $S \subseteq T$ and element $z \in T$, define $p(S,z)$ to be the number of ways of choosing two distinct elements from $S$ with product either $z$ or $-z$.

For example if $S=\{1,2,4\}$ and $z=4$, there is only one valid pair of elements with product $\pm4$, namely $1$ and $4$. Thus, in this case $p(S,z)=1$.

For another example, if $S=\{1,\theta,1+\theta,2-\theta\}$ and $z=2-\theta$, we have $1\cdot(2-\theta)=z$ and $\theta\cdot(1+\theta)=-z$, giving $p(S,z)=2$.

Let $A$ and $B$ be two sets satisfying the following conditions:

- $1 \in A$

- $A \cap B = \emptyset$

- $A \cup B = T$

- $p(A,z) = p(B,z)$ for all $z\in T$

Remarkably, these four conditions uniquely determine the sets $A$ and $B$.

Let $F_n$ be the set of the first $n$ factorials: $F_n=\{1!,2!,\dots,n!\}$, and define $G(n)$ to be the sum of all elements of $F_n\cap A$.

You are given $G(4) = 25$.

Find $G(7)$.",REDACTED
pe-947-S10,"The $(a,b,m)$-sequence, where $0 \leq a,b < m$, is defined as

$\begin{align*}
g(0)&=a\\
g(1)&=b\\
g(n)&= \big(g(n-1) + g(n-2)\big) \bmod m
\end{align*}$

All $(a,b,m)$-sequences are periodic with period denoted by $p(a,b,m)$.

The first few terms of the $(0,1,8)$-sequence are $(0,1,1,2,3,5,0,5,5,2,7,1,0,1,1,2,\ldots )$ and so $p(0,1,8)=12$.

Let $\displaystyle s(m)=\sum_{a=0}^{m-1}\sum_{b=0}^{m-1} p(a,b,m)^2$. For example, $s(3)=513$ and $s(10)=225820$.

Define $\displaystyle S(M)=\sum_{m=1}^{M}s(m)$. You are given $S(3)=542$.

Find $S(10)$.",REDACTED
pe-954-C10000,"A positive integer is called heptaphobic if it is not divisible by seven and no number divisible by seven can be produced by swapping two of its digits. Note that leading zeros are not allowed before or after the swap.

For example, $17$ and $1305$ are heptaphobic, but $14$ and $132$ are not because $14$ and $231$ are divisible by seven.

Let $C(N)$ count heptaphobic numbers smaller than $N$. You are given $C(100) = 74$.

Find $C(10^4)$.",REDACTED
pe-957-g3,"There is a plane on which all points are initially white, except three red points and two blue points. On each day, every line passing through a red point and a blue point is constructed. Then every white point, where two different such lines meet, turns blue. Let $g(n)$ be the maximal possible number of blue points after $n$ days. For example, $g(1)=8$ and $g(2)=28$. Find $g(3)$.",REDACTED
pe-973-X10,"A game is played with $n$ cards.
At the start the cards are dealt out onto a table to get $n$ piles of size one.

Each round proceeds as follows:

- Select a pile at random and pick it up.

- Randomly choose a pile from the table and add the top card of the picked-up pile to it.

- Redistribute any remaining cards from the picked-up pile by dealing them into new single-card piles.

The game ends when all cards are in a single pile.

At the end of each round a score is obtained by bitwise-XORing the size of each pile. The score is summed across the rounds. Let $X(n)$ be the expected total score at the end of the game.

You are given $X(2) = 2$, $X(4) = 14$.

Find $X(10)$.",REDACTED
stress-test-matmul,"Let $M$ be the $n \times n$ matrix where $M_{ij} = \gcd(i, j)$ for $1 \le i, j \le n$. Define $T(n) = \text{tr}(M^3) \mod (10^9 + 7)$, where $\text{tr}$ denotes the trace. You are given that $T(100) = 107127472$. Find $T(15000)$.",336629703
