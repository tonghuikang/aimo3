{
  "problem": {
    "id": "pe-524",
    "statement": "Consider the following algorithm for sorting a list:\n\n- 1. Starting from the beginning of the list, check each pair of adjacent elements in turn.\n\n- 2. If the elements are out of order:\n\n- a. Move the smallest element of the pair at the beginning of the list.\n\n- b. Restart the process from step 1.\n\n- 3. If all pairs are in order, stop.\n\nFor example, the list $\\{\\,4\\,1\\,3\\,2\\,\\}$ is sorted as follows:\n\n- $\\underline{4\\,1}\\,3\\,2$ ($4$ and $1$ are out of order so move $1$ to the front of the list)\n\n- $1\\,\\underline{4\\,3}\\,2$ ($4$ and $3$ are out of order so move $3$ to the front of the list)\n\n- $\\underline{3\\,1}\\,4\\,2$ ($3$ and $1$ are out of order so move $1$ to the front of the list)\n\n- $1\\,3\\,\\underline{4\\,2}$ ($4$ and $2$ are out of order so move $2$ to the front of the list)\n\n- $\\underline{2\\,1}\\,3\\,4$ ($2$ and $1$ are out of order so move $1$ to the front of the list)\n\n- $1\\,2\\,3\\,4$ (The list is now sorted)\n\nLet $F(L)$ be the number of times step 2a is executed to sort list $L$. For example, $F(\\{\\,4\\,1\\,3\\,2\\,\\}) = 5$.\n\nWe can list all permutations $P$ of the integers $\\{1, 2, \\dots, n\\}$ in lexicographical order, and assign to each permutation an index $I_n(P)$ from $1$ to $n!$ corresponding to its position in the list.\n\nLet $Q(n, k) = \\min(I_n(P))$ for $F(P) = k$, the index of the first permutation requiring exactly $k$ steps to sort with First Sort. If there is no permutation for which $F(P) = k$, then $Q(n, k)$ is undefined.\n\nFor $n = 4$ we have:\n\n<table border=\"1\" style=\"text-align:left;\">\n<tr><th>P</th><th>I4(P)</th><th>F(P)</th><th></th></tr>\n<tr><td>{1, 2, 3, 4}</td><td>1</td><td>0</td><td>Q(4, 0) = 1</td></tr>\n<tr><td>{1, 2, 4, 3}</td><td>2</td><td>4</td><td>Q(4, 4) = 2</td></tr>\n<tr><td>{1, 3, 2, 4}</td><td>3</td><td>2</td><td>Q(4, 2) = 3</td></tr>\n<tr><td>{1, 3, 4, 2}</td><td>4</td><td>2</td><td></td></tr>\n<tr><td>{1, 4, 2, 3}</td><td>5</td><td>6</td><td>Q(4, 6) = 5</td></tr>\n<tr><td>{1, 4, 3, 2}</td><td>6</td><td>4</td><td></td></tr>\n<tr><td>{2, 1, 3, 4}</td><td>7</td><td>1</td><td>Q(4, 1) = 7</td></tr>\n<tr><td>{2, 1, 4, 3}</td><td>8</td><td>5</td><td>Q(4, 5) = 8</td></tr>\n<tr><td>{2, 3, 1, 4}</td><td>9</td><td>1</td><td></td></tr>\n<tr><td>{2, 3, 4, 1}</td><td>10</td><td>1</td><td></td></tr>\n<tr><td>{2, 4, 1, 3}</td><td>11</td><td>5</td><td></td></tr>\n<tr><td>{2, 4, 3, 1}</td><td>12</td><td>3</td><td>Q(4, 3) = 12</td></tr>\n<tr><td>{3, 1, 2, 4}</td><td>13</td><td>3</td><td></td></tr>\n<tr><td>{3, 1, 4, 2}</td><td>14</td><td>3</td><td></td></tr>\n<tr><td>{3, 2, 1, 4}</td><td>15</td><td>2</td><td></td></tr>\n<tr><td>{3, 2, 4, 1}</td><td>16</td><td>2</td><td></td></tr>\n<tr><td>{3, 4, 1, 2}</td><td>17</td><td>3</td><td></td></tr>\n<tr><td>{3, 4, 2, 1}</td><td>18</td><td>2</td><td></td></tr>\n<tr><td>{4, 1, 2, 3}</td><td>19</td><td>7</td><td>Q(4, 7) = 19</td></tr>\n<tr><td>{4, 1, 3, 2}</td><td>20</td><td>5</td><td></td></tr>\n<tr><td>{4, 2, 1, 3}</td><td>21</td><td>6</td><td></td></tr>\n<tr><td>{4, 2, 3, 1}</td><td>22</td><td>4</td><td></td></tr>\n<tr><td>{4, 3, 1, 2}</td><td>23</td><td>4</td><td></td></tr>\n<tr><td>{4, 3, 2, 1}</td><td>24</td><td>3</td><td></td></tr>\n</table>\n\nLet $R(k) = \\min(Q(n, k))$ over all $n$ for which $Q(n, k)$ is defined.\n\nFind $R(12^{12})$.\n\nGive your answer modulo $99991$.",
    "answer": 68077
  },
  "tokens": [
    200006,
    17360,
    200008,
    3575,
    553,
    17554,
    162016,
    11,
    261,
    4410,
    6439,
    2359,
    22203,
    656,
    7788,
    17527,
    558,
    87447,
    100594,
    25,
    220,
    1323,
    19,
    12,
    3218,
    279,
    30377,
    289,
    25,
    1932,
    279,
    2,
    20574,
    279,
    877,
    22752,
    279,
    8470,
    495,
    4584,
    316,
    15792,
    26534,
    3490,
    306,
    634,
    13464,
    328,
    4525,
    13,
    623,
    3490,
    738,
    625,
    413,
    10147,
    316,
    290,
    1825,
    13,
    1328,
    4584,
    1757,
    413,
    2061,
    395,
    8812,
    57927,
    11,
    889,
    625,
    395,
    3490,
    484,
    382,
    15663,
    316,
    413,
    15263,
    316,
    290,
    1825,
    350,
    68,
    1940,
    13,
    1261,
    9278,
    51659,
    11,
    16584,
    11,
    503,
    6291,
    6294,
    5958,
    481,
    4952,
    261,
    3176,
    15683,
    26534,
    3490,
    316,
    22752,
    11,
    480,
    738,
    413,
    30830,
    306,
    261,
    2608,
    1500,
    643,
    155283,
    55166,
    5870,
    13,
    22752,
    738,
    9570,
    483,
    290,
    4733,
    328,
    290,
    20860,
    503,
    1058,
    842,
    1934,
    220,
    6106,
    13,
    15,
    12068,
    13,
    7380,
    3158,
    395,
    495,
    6223,
    382,
    16124,
    364,
    2,
    13888,
    18403,
    25,
    8450,
    11,
    49159,
    11,
    1721,
    13,
    21030,
    2804,
    413,
    7360,
    395,
    1753,
    3176,
    13,
    200007,
    200006,
    77944,
    200008,
    2,
    68406,
    279,
    3575,
    738,
    17722,
    290,
    4792,
    326,
    622,
    290,
    1721,
    6052,
    306,
    2381,
    172278,
    108872,
    200007,
    200006,
    1428,
    200008,
    49377,
    290,
    3992,
    22184,
    395,
    51375,
    261,
    1562,
    1402,
    12,
    220,
    16,
    13,
    46049,
    591,
    290,
    10526,
    328,
    290,
    1562,
    11,
    2371,
    2454,
    10610,
    328,
    39069,
    8632,
    306,
    3716,
    364,
    12,
    220,
    17,
    13,
    1843,
    290,
    8632,
    553,
    842,
    328,
    2569,
    1402,
    12,
    261,
    13,
    25485,
    290,
    42173,
    3577,
    328,
    290,
    10610,
    540,
    290,
    10526,
    328,
    290,
    1562,
    364,
    12,
    287,
    13,
    111684,
    290,
    2273,
    591,
    5983,
    220,
    16,
    364,
    12,
    220,
    18,
    13,
    1843,
    722,
    24702,
    553,
    306,
    2569,
    11,
    5666,
    364,
    2653,
    4994,
    11,
    290,
    1562,
    126456,
    90,
    40037,
    19,
    40037,
    16,
    40037,
    18,
    40037,
    17,
    40037,
    59,
    61526,
    382,
    20099,
    472,
    18183,
    1402,
    12,
    126456,
    91045,
    90,
    19,
    40037,
    16,
    21170,
    11,
    18,
    40037,
    17,
    3,
    3653,
    19,
    3,
    326,
    548,
    16,
    3,
    553,
    842,
    328,
    2569,
    813,
    5275,
    548,
    16,
    3,
    316,
    290,
    5567,
    328,
    290,
    1562,
    1029,
    12,
    548,
    16,
    40037,
    59,
    91045,
    90,
    19,
    40037,
    18,
    21170,
    11,
    17,
    3,
    3653,
    19,
    3,
    326,
    548,
    18,
    3,
    553,
    842,
    328,
    2569,
    813,
    5275,
    548,
    18,
    3,
    316,
    290,
    5567,
    328,
    290,
    1562,
    1029,
    12,
    126456,
    91045,
    90,
    18,
    40037,
    16,
    21170,
    11,
    19,
    40037,
    17,
    3,
    3653,
    18,
    3,
    326,
    548,
    16,
    3,
    553,
    842,
    328,
    2569,
    813,
    5275,
    548,
    16,
    3,
    316,
    290,
    5567,
    328,
    290,
    1562,
    1029,
    12,
    548,
    16,
    40037,
    18,
    40037,
    59,
    91045,
    90,
    19,
    40037,
    17,
    61526,
    3653,
    19,
    3,
    326,
    548,
    17,
    3,
    553,
    842,
    328,
    2569,
    813,
    5275,
    548,
    17,
    3,
    316,
    290,
    5567,
    328,
    290,
    1562,
    1029,
    12,
    126456,
    91045,
    90,
    17,
    40037,
    16,
    21170,
    11,
    18,
    40037,
    19,
    3,
    3653,
    17,
    3,
    326,
    548,
    16,
    3,
    553,
    842,
    328,
    2569,
    813,
    5275,
    548,
    16,
    3,
    316,
    290,
    5567,
    328,
    290,
    1562,
    1029,
    12,
    548,
    16,
    40037,
    17,
    40037,
    18,
    40037,
    19,
    3,
    350,
    976,
    1562,
    382,
    1954,
    20099,
    1029,
    12845,
    548,
    37,
    11075,
    38081,
    413,
    290,
    2086,
    328,
    4238,
    5983,
    220,
    17,
    64,
    382,
    30830,
    316,
    4506,
    1562,
    548,
    43,
    25507,
    2214,
    4994,
    11,
    548,
    37,
    23074,
    90,
    40037,
    19,
    40037,
    16,
    40037,
    18,
    40037,
    17,
    40037,
    59,
    9263,
    314,
    220,
    20,
    3,
    364,
    2167,
    665,
    1562,
    722,
    174595,
    548,
    47,
    3,
    328,
    290,
    54912,
    126456,
    90,
    16,
    11,
    220,
    17,
    11,
    2381,
    183433,
    11,
    297,
    59,
    61526,
    306,
    37772,
    291,
    44118,
    2569,
    11,
    326,
    14975,
    316,
    2454,
    135200,
    448,
    3472,
    548,
    40,
    2170,
    8952,
    38081,
    591,
    548,
    16,
    3,
    316,
    548,
    77,
    0,
    3,
    21824,
    316,
    1617,
    4010,
    306,
    290,
    1562,
    364,
    12845,
    548,
    48,
    2406,
    11,
    372,
    8,
    314,
    2381,
    1493,
    16705,
    2170,
    8952,
    915,
    3,
    395,
    548,
    37,
    8952,
    8,
    314,
    372,
    108989,
    290,
    3472,
    328,
    290,
    1577,
    135200,
    39241,
    9707,
    548,
    74,
    3,
    10331,
    316,
    4506,
    483,
    8338,
    25945,
    13,
    1843,
    1354,
    382,
    860,
    135200,
    395,
    1118,
    548,
    37,
    8952,
    8,
    314,
    372,
    108989,
    1815,
    548,
    48,
    2406,
    11,
    372,
    38081,
    382,
    10118,
    364,
    2653,
    548,
    77,
    314,
    220,
    19,
    3,
    581,
    679,
    1402,
    54505,
    6761,
    580,
    16,
    1,
    2713,
    580,
    919,
    21097,
    85462,
    28392,
    27873,
    3784,
    404,
    116807,
    808,
    404,
    3784,
    404,
    184494,
    19,
    8952,
    28678,
    404,
    3784,
    404,
    29,
    37,
    8952,
    28678,
    404,
    3784,
    404,
    3003,
    404,
    3003,
    371,
    523,
    27873,
    3784,
    2336,
    11679,
    16,
    11,
    220,
    17,
    11,
    220,
    18,
    11,
    220,
    19,
    7391,
    2336,
    3784,
    2336,
    29,
    16,
    808,
    2336,
    3784,
    2336,
    29,
    15,
    808,
    2336,
    3784,
    2336,
    29,
    48,
    7,
    19,
    11,
    220,
    15,
    8,
    314,
    220,
    16,
    808,
    2336,
    3003,
    371,
    523,
    27873,
    3784,
    2336,
    11679,
    16,
    11,
    220,
    17,
    11,
    220,
    19,
    11,
    220,
    18,
    7391,
    2336,
    3784,
    2336,
    29,
    17,
    808,
    2336,
    3784,
    2336,
    29,
    19,
    808,
    2336,
    3784,
    2336,
    29,
    48,
    7,
    19,
    11,
    220,
    19,
    8,
    314,
    220,
    17,
    808,
    2336,
    3003,
    371,
    523,
    27873,
    3784,
    2336,
    11679,
    16,
    11,
    220,
    18,
    11,
    220,
    17,
    11,
    220,
    19,
    7391,
    2336,
    3784,
    2336,
    29,
    18,
    808,
    2336,
    3784,
    2336,
    29,
    17,
    808,
    2336,
    3784,
    2336,
    29,
    48,
    7,
    19,
    11,
    220,
    17,
    8,
    314,
    220,
    18,
    808,
    2336,
    3003,
    371,
    523,
    27873,
    3784,
    2336,
    11679,
    16,
    11,
    220,
    18,
    11,
    220,
    19,
    11,
    220,
    17,
    7391,
    2336,
    3784,
    2336,
    29,
    19,
    808,
    2336,
    3784,
    2336,
    29,
    17,
    808,
    2336,
    3784,
    2336,
    3003,
    2336,
    3003,
    371,
    523,
    27873,
    3784,
    2336,
    11679,
    16,
    11,
    220,
    19,
    11,
    220,
    17,
    11,
    220,
    18,
    7391,
    2336,
    3784,
    2336,
    29,
    20,
    808,
    2336,
    3784,
    2336,
    29,
    21,
    808,
    2336,
    3784,
    2336,
    29,
    48,
    7,
    19,
    11,
    220,
    21,
    8,
    314,
    220,
    20,
    808,
    2336,
    3003,
    371,
    523,
    27873,
    3784,
    2336,
    11679,
    16,
    11,
    220,
    19,
    11,
    220,
    18,
    11,
    220,
    17,
    7391,
    2336,
    3784,
    2336,
    29,
    21,
    808,
    2336,
    3784,
    2336,
    29,
    19,
    808,
    2336,
    3784,
    2336,
    3003,
    2336,
    3003,
    371,
    523,
    27873,
    3784,
    2336,
    11679,
    17,
    11,
    220,
    16,
    11,
    220,
    18,
    11,
    220,
    19,
    7391,
    2336,
    3784,
    2336,
    29,
    22,
    808,
    2336,
    3784,
    2336,
    29,
    16,
    808,
    2336,
    3784,
    2336,
    29,
    48,
    7,
    19,
    11,
    220,
    16,
    8,
    314,
    220,
    22,
    808,
    2336,
    3003,
    371,
    523,
    27873,
    3784,
    2336,
    11679,
    17,
    11,
    220,
    16,
    11,
    220,
    19,
    11,
    220,
    18,
    7391,
    2336,
    3784,
    2336,
    29,
    23,
    808,
    2336,
    3784,
    2336,
    29,
    20,
    808,
    2336,
    3784,
    2336,
    29,
    48,
    7,
    19,
    11,
    220,
    20,
    8,
    314,
    220,
    23,
    808,
    2336,
    3003,
    371,
    523,
    27873,
    3784,
    2336,
    11679,
    17,
    11,
    220,
    18,
    11,
    220,
    16,
    11,
    220,
    19,
    7391,
    2336,
    3784,
    2336,
    29,
    24,
    808,
    2336,
    3784,
    2336,
    29,
    16,
    808,
    2336,
    3784,
    2336,
    3003,
    2336,
    3003,
    371,
    523,
    27873,
    3784,
    2336,
    11679,
    17,
    11,
    220,
    18,
    11,
    220,
    19,
    11,
    220,
    16,
    7391,
    2336,
    3784,
    2336,
    29,
    702,
    808,
    2336,
    3784,
    2336,
    29,
    16,
    808,
    2336,
    3784,
    2336,
    3003,
    2336,
    3003,
    371,
    523,
    27873,
    3784,
    2336,
    11679,
    17,
    11,
    220,
    19,
    11,
    220,
    16,
    11,
    220,
    18,
    7391,
    2336,
    3784,
    2336,
    29,
    994,
    808,
    2336,
    3784,
    2336,
    29,
    20,
    808,
    2336,
    3784,
    2336,
    3003,
    2336,
    3003,
    371,
    523,
    27873,
    3784,
    2336,
    11679,
    17,
    11,
    220,
    19,
    11,
    220,
    18,
    11,
    220,
    16,
    7391,
    2336,
    3784,
    2336,
    29,
    899,
    808,
    2336,
    3784,
    2336,
    29,
    18,
    808,
    2336,
    3784,
    2336,
    29,
    48,
    7,
    19,
    11,
    220,
    18,
    8,
    314,
    220,
    899,
    808,
    2336,
    3003,
    371,
    523,
    27873,
    3784,
    2336,
    11679,
    18,
    11,
    220,
    16,
    11,
    220,
    17,
    11,
    220,
    19,
    7391,
    2336,
    3784,
    2336,
    29,
    1311,
    808,
    2336,
    3784,
    2336,
    29,
    18,
    808,
    2336,
    3784,
    2336,
    3003,
    2336,
    3003,
    371,
    523,
    27873,
    3784,
    2336,
    11679,
    18,
    11,
    220,
    16,
    11,
    220,
    19,
    11,
    220,
    17,
    7391,
    2336,
    3784,
    2336,
    29,
    1265,
    808,
    2336,
    3784,
    2336,
    29,
    18,
    808,
    2336,
    3784,
    2336,
    3003,
    2336,
    3003,
    371,
    523,
    27873,
    3784,
    2336,
    11679,
    18,
    11,
    220,
    17,
    11,
    220,
    16,
    11,
    220,
    19,
    7391,
    2336,
    3784,
    2336,
    29,
    1055,
    808,
    2336,
    3784,
    2336,
    29,
    17,
    808,
    2336,
    3784,
    2336,
    3003,
    2336,
    3003,
    371,
    523,
    27873,
    3784,
    2336,
    11679,
    18,
    11,
    220,
    17,
    11,
    220,
    19,
    11,
    220,
    16,
    7391,
    2336,
    3784,
    2336,
    29,
    1125,
    808,
    2336,
    3784,
    2336,
    29,
    17,
    808,
    2336,
    3784,
    2336,
    3003,
    2336,
    3003,
    371,
    523,
    27873,
    3784,
    2336,
    11679,
    18,
    11,
    220,
    19,
    11,
    220,
    16,
    11,
    220,
    17,
    7391,
    2336,
    3784,
    2336,
    29,
    1422,
    808,
    2336,
    3784,
    2336,
    29,
    18,
    808,
    2336,
    3784,
    2336,
    3003,
    2336,
    3003,
    371,
    523,
    27873,
    3784,
    2336,
    11679,
    18,
    11,
    220,
    19,
    11,
    220,
    17,
    11,
    220,
    16,
    7391,
    2336,
    3784,
    2336,
    29,
    1157,
    808,
    2336,
    3784,
    2336,
    29,
    17,
    808,
    2336,
    3784,
    2336,
    3003,
    2336,
    3003,
    371,
    523,
    27873,
    3784,
    2336,
    11679,
    19,
    11,
    220,
    16,
    11,
    220,
    17,
    11,
    220,
    18,
    7391,
    2336,
    3784,
    2336,
    29,
    858,
    808,
    2336,
    3784,
    2336,
    29,
    22,
    808,
    2336,
    3784,
    2336,
    29,
    48,
    7,
    19,
    11,
    220,
    22,
    8,
    314,
    220,
    858,
    808,
    2336,
    3003,
    371,
    523,
    27873,
    3784,
    2336,
    11679,
    19,
    11,
    220,
    16,
    11,
    220,
    18,
    11,
    220,
    17,
    7391,
    2336,
    3784,
    2336,
    29,
    455,
    808,
    2336,
    3784,
    2336,
    29,
    20,
    808,
    2336,
    3784,
    2336,
    3003,
    2336,
    3003,
    371,
    523,
    27873,
    3784,
    2336,
    11679,
    19,
    11,
    220,
    17,
    11,
    220,
    16,
    11,
    220,
    18,
    7391,
    2336,
    3784,
    2336,
    29,
    2040,
    808,
    2336,
    3784,
    2336,
    29,
    21,
    808,
    2336,
    3784,
    2336,
    3003,
    2336,
    3003,
    371,
    523,
    27873,
    3784,
    2336,
    11679,
    19,
    11,
    220,
    17,
    11,
    220,
    18,
    11,
    220,
    16,
    7391,
    2336,
    3784,
    2336,
    29,
    1709,
    808,
    2336,
    3784,
    2336,
    29,
    19,
    808,
    2336,
    3784,
    2336,
    3003,
    2336,
    3003,
    371,
    523,
    27873,
    3784,
    2336,
    11679,
    19,
    11,
    220,
    18,
    11,
    220,
    16,
    11,
    220,
    17,
    7391,
    2336,
    3784,
    2336,
    29,
    1860,
    808,
    2336,
    3784,
    2336,
    29,
    19,
    808,
    2336,
    3784,
    2336,
    3003,
    2336,
    3003,
    371,
    523,
    27873,
    3784,
    2336,
    11679,
    19,
    11,
    220,
    18,
    11,
    220,
    17,
    11,
    220,
    16,
    7391,
    2336,
    3784,
    2336,
    29,
    1494,
    808,
    2336,
    3784,
    2336,
    29,
    18,
    808,
    2336,
    3784,
    2336,
    3003,
    2336,
    3003,
    371,
    523,
    808,
    4202,
    3037,
    12845,
    548,
    49,
    12125,
    8,
    314,
    2381,
    1493,
    14437,
    2406,
    11,
    372,
    915,
    3,
    1072,
    722,
    548,
    77,
    3,
    395,
    1118,
    548,
    48,
    2406,
    11,
    372,
    38081,
    382,
    9113,
    364,
    11437,
    548,
    49,
    7,
    899,
    42923,
    899,
    9263,
    3,
    364,
    50117,
    634,
    6052,
    112372,
    548,
    9130,
    8956,
    25507,
    200007,
    200006,
    173781
  ],
  "model_version": "gpt-oss-120b"
}