# PE 515 Annotation Findings

## Problem
Compute
`D(10^9,10^5,10^5) = \sum_{10^9 \le p < 10^9+10^5,\ p\ \text{prime}} (d(p,p-1,10^5) \bmod p)`
with
- `d(p,n,0)` = modular inverse of `n (mod p)`
- `d(p,n,k) = \sum_{i=1}^n d(p,i,k-1)`.

## Correct Answer
- `2422639000800`

## Correct Approach
- For fixed prime `p`, write `S_k(p) = d(p,p-1,k) (mod p)`.
- Repeated prefix-sum identity:
  - `d(p,n,k) = \sum_{i=1}^n \binom{n-i+k-1}{k-1} i^{-1} (mod p)`.
- Set `n=p-1`, `k>=2`, and simplify the binomial term:
  - `\binom{t+k-2}{k-1} t^{-1} = \frac{(t+k-2)!}{(k-1)!\,t!}`.
  - This becomes a polynomial in `t` of degree `k-2` divided by `(k-1)!`.
- Since here `p \gg k` (all relevant primes are near `10^9`, `k=10^5`), degree `< p-1`.
  - Summing over `t=1..p-1` kills all non-constant terms modulo `p`.
  - The surviving constant term gives
    - `S_k(p) = (k-1)^{-1} (mod p)` (for `k>=2`).
- Therefore
  - `D(a,b,k) = \sum_{a\le p<a+b,\ p\ prime} (k-1)^{-1} (mod p)`.
- For this problem, sum `inv(99999) mod p` over primes `p` in `[10^9, 10^9+10^5)`.
  - Use a segmented sieve on the interval (4832 primes).
  - Total sum is `2422639000800`.
- Sanity checks:
  - `D(101,1,10) = inv(9) mod 101 = 45`.
  - `D(10^3,10^2,10^2) = \sum inv(99) = 8334`.
  - `D(10^6,10^3,10^3) = \sum inv(999) = 38162302`.

## Wrong Approach A
- Reindexing with an untracked sign change and then simplifying from the wrong signed formula.
- This can produce incorrect closed forms (e.g., coefficient-based formulas like `a_2/s!`) that fail on small checks.

## Wrong Approach B
- Applying invalid binomial congruences such as `\binom{p+n}{m} \equiv \binom{n}{m}+\binom{n}{m-1} (mod p)` without the proper conditions.
- This leads to incorrect modular reductions and wrong intermediate identities.

## Wrong Approach C
- Guessing formulas for `S_k(p)` by polynomial fitting/heuristics from small samples without a proof.
- May appear plausible on a few cases but is unreliable; the inverse formula must be derived algebraically.
