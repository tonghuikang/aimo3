# PE 572 Findings

## Correct answer
- `C(200) mod 99991 = 39429`
- Equivalent full count: `C(200) = 19737656`

## Correct approach
- Integer idempotents satisfy `M^2=M` and decompose by rank `r=0,1,2,3`.
- Trivial cases: rank 0 gives only `0`, rank 3 gives only `I`, so base contribution is `2`.
- Rank-1 idempotents are exactly matrices `M = u v^T` with integer primitive vectors `u,v` and `vÂ·u = 1`.
- Rank-2 idempotents are `I - u v^T` for the same `(u,v)` condition.
- Pair representation is unique up to simultaneous sign: `(u,v)` and `(-u,-v)` define the same matrix.
- Counting must use different box constraints for rank 1 and rank 2:
- Rank 1 constraint: `|u_i v_j| <= n` for all `i,j`.
- Rank 2 constraint: `|u_i v_j| <= n` for `i!=j`, and `u_i v_i in [1-n, 1+n]` for diagonal terms.
- Therefore the correct decomposition is `C(n)=2+R1(n)+R2(n)`, not a single doubled rank-1 count.

## Key values for n=200
- `R1(200)=9876015`
- `R2(200)=9861639`
- `C(200)=2+R1+R2=19737656`

## Wrong approaches and why they fail
- Wrong approach A: assume rank-1 and rank-2 counts are equal under `M -> I-M` inside the same `[-n,n]` box.
- Failure reason: `I-M` shifts diagonals by `+1`, so boundary behavior is asymmetric and the map does not preserve feasibility in the bounded box.
- Wrong approach B: treat rank-2 as rank-1 minus only matrices with a diagonal entry `-n` (single correction term).
- Failure reason: this correction is incomplete for larger `n`; it matches calibration points (`n=1,2`) but misses additional boundary configurations.
- Result from wrong corrections: `C(200)=19736864`, giving modulo result `38637` (incorrect).
