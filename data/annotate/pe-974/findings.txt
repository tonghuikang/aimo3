# PE 974 Findings

## Correct Answer
- `13310`

## Correct Approach
- A valid number uses only digits `{1,3,5,7,9}`, each with odd count, and is divisible by `105`.
- Divisibility by `5` forces the last digit to be `5`, so solve on the first `L-1` digits, then append `5`.
- Count prefixes with DP/automaton states:
  - parity mask of digit counts (5 bits),
  - remainder modulo `21` (equivalently modulo `7` + sum modulo `3`).
- For odd length `L`, accepted prefixes of length `L-1` must land in the pre-final state:
  - parity mask `27` (`1,3,7,9` odd, `5` even before final `5`),
  - remainder `10 (mod 21)` (so appending `5` gives remainder `0 mod 21`).
- Compute counts by odd length and cumulative totals. Key values:
  - cumulative through length `27` = `4,617,654,154,496,372`
  - length `29` count = `110,871,817,653,472,104`
- Therefore `Θ(10^16)` is in length `29`, with in-block rank
  - `10^16 - 4,617,654,154,496,372 = 5,382,345,845,503,628`.
- Recover the exact number by lexicographic unranking:
  - build digits left-to-right,
  - at each step, use DP completion counts for each next digit in order `1,3,5,7,9`.
- This gives
  - `Θ(10^16) = 13313751171933973557517973175`
  - `Θ(10^16) mod 99991 = 13310`.

## Wrong Approaches And Why They Fail
- Assuming each multiset contributes exactly `1/7` of permutations to divisibility-by-7:
  - false in general; residue classes are not exactly uniform for each multiset.
  - This gives incorrect per-length counts and wrong rank localization.
- DP with only parity + modulo-7 state (omitting modulo-3 tracking):
  - odd parity of digit counts does not enforce sum of digits `≡ 0 (mod 3)`.
  - Causes overcounting (e.g., length `7` overcount), so subsequent rank and answer are wrong.
