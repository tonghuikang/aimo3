# PE 685 Findings

## Problem
Compute
`S(10000) = sum_{n=1}^{10000} f(n^3, n^4) (mod 1,000,000,007)`,
where `f(d,m)` is the `m`-th positive integer (in increasing order) with decimal digit sum `d`.

## Correct Answer
`662878999`

## Correct Approach
- For each `n`, set `s = n^3`, `m = n^4`, and minimal feasible length `L0 = (s+8)//9`.
- Use deficit form at length `L`: `D(L) = 9L - s`, and write digits as `digit_i = 9 - e_i`.
  - `e_i >= 0`, `sum e_i = D(L)`.
  - At the first position, `e_1 <= 8`; later positions allow `<= 9`.
- Within fixed length, numeric ascending order is equivalent to lexicographic order on deficits with larger deficits earlier (since larger deficit means smaller digit).
- Count blocks combinatorially and unrank:
  - core count uses bounded stars-and-bars;
  - in needed branches residual deficits are small enough that closed forms with at most one inclusion-exclusion correction term suffice.
- Length selection for this problem is driven by `s mod 9` (`n^3 mod 9 in {0,1,8}`):
  - `s mod 9 = 1` (`D0=8`): rank is in minimal-length block.
  - `s mod 9 = 8` (`D0=1`): minimal-length block is too small; move to longer length (and for `n=2`, one more step is needed).
  - `s mod 9 = 0` (`D0=0`): only one minimal-length number (all 9s); for `m>1`, use length `L0+1`.
- Build `f(s,m) mod M` directly without materializing huge integers:
  - append explicit non-9 digits from unranking;
  - append long 9-runs via `x -> x*10^k + (10^k-1) (mod M)`.
- Sanity checks that must match: `S(3)=7128` and `S(10) mod M = 32287064`.

## Wrong Approaches And Why They Fail
- Skipping many zero-deficit positions without subtracting the full cumulative skipped block count from rank gives wrong residual rank and wrong digit placement.
- Using a local skip predicate (instead of cumulative block sums) causes off-by-one/invalid zero-skip lengths.
- These errors already break small validation (e.g., `n=3` gives `6579` instead of `6966`) and prevent a valid `S(10000)` result.
