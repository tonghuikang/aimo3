Correct answer: 653972374

Problem: Count sequences of die rolls with bounded adjacent equal pairs, summed over n.
- C(n) = number of length-n sequences over {1,...,6} with at most pi(n) adjacent equal pairs
- S(L) = sum of C(n) for n=1 to L, compute S(50,000,000) mod 10^9+7

Key formula derivation:
- Equal adjacent pairs c relates to runs r via c = n - r (runs = maximal blocks of equal values)
- Number of sequences with exactly r runs = binom(n-1, r-1) * 6 * 5^{r-1}
  (compositions for run lengths times color sequences with adjacent-different constraint)
- Therefore C(n) = 6 * sum_{c=0}^{pi(n)} binom(n-1, c) * 5^{n-c-1}
- Equivalently: C(n) = 6 * 5^{n-1} * sum_{c=0}^{pi(n)} binom(n-1, c) * (1/5)^c

Sanity check: when summing over all c (up to n-1), the sum gives (1+1/5)^{n-1} = (6/5)^{n-1},
so C(n) = 6 * 5^{n-1} * (6/5)^{n-1} = 6^n, matching total number of sequences.

Correct approach (O(L) iteration with recurrence):
- Define B_n = sum_{c=0}^{pi(n)} binom(n-1,c) * x^c where x = 1/5 mod M
- Then C(n) = 6 * 5^{n-1} * B_n
- Key recurrence using Pascal's identity binom(n,c) = binom(n-1,c) + binom(n-1,c-1):
  - If n+1 NOT prime (pi unchanged): B_{n+1} = (1+x)*B_n - binom(n-1, pi(n)) * x^{pi(n)+1}
  - If n+1 IS prime (pi increases by 1): B_{n+1} = (1+x)*B_n + binom(n-1, pi(n)+1) * x^{pi(n)+1}
- Maintain f = binom(n-1, r) and h = binom(n-1, r+1) where r = pi(n)
- Update f and h incrementally:
  - Non-prime case: f_new = f * n * inv(n-r), h_new = h * n * inv(n-r-1) (when denom > 0)
  - Prime case: f_new = f + h (Pascal's identity, no division!), h_new = f_new * (n-r-1) * inv(r+2)
- Also maintain x^{r+1} (power of x) and 5^{n-1} (power of 5) iteratively
- Precompute: sieve of primes up to L, modular inverses of 1..L

Both traces arrive at the correct answer through this approach, though they take different paths:
- Trace 37qe8s derives the B_n recurrence more directly
- Trace ndn7l8 takes a longer route through probability theory and G(n,c) DP before converging

Wrong intermediate approaches (corrected later):
- Boundary-update bug for `h = binom(n-1, r+1)`:
  using only `h_new = h * n * inv(n-r-1)` misses the zero-to-nonzero transition at `n=r+1`
  (e.g., should get `binom(3,3)=1`), which produced wrong intermediate values such as `B_5`.
- Prime-step recurrence index bug in the G(n,c) derivation:
  using `G(n-1, p_{n-1})` instead of `G(n-1, p_{n-1}+1)` for prime `n` gives wrong counts
  (e.g., predicts `C(2)=66` instead of `36`). If left uncorrected, this yields a wrong final answer.

Alternative approach explored but not directly used: swap summation order to sum over c first,
computing T_c = 6 * 5^{-c} * sum_{m} binom(m,c) * 5^m using generating function identity
sum_{m=c}^{inf} binom(m,c) * x^m = x^c / (1-x)^{c+1}. This gives O(pi(L)) approach if
the partial sums can be computed in O(1) per c.
