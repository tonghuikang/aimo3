# pe-940 Findings

## Correct answer
- `S(50) mod 1123581313 = 969134784`.

## Correct approach
- Define `B_n = A(0,n)`. From
  - `A(1,n)=A(0,n+1)+A(0,n)`
  - `A(1,n)=2A(1,n-1)+A(0,n-1)`
  derive
  - `B_{n+1}=B_n+3B_{n-1}`, with `B_0=0, B_1=1`.
- Represent each row as
  - `A(m,n)=c_m B_n + d_m B_{n+1}`.
- Using `A(m+1,n)=A(m,n+1)+A(m,n)`, derive coefficient recurrence
  - `c_{m+1}=c_m+3d_m`
  - `d_{m+1}=c_m+2d_m`
  with `c_0=1, d_0=0`.
- Matrix forms:
  - For `B`: `M=[[1,3],[1,0]]`, so `[B_{n+1},B_n]^T = M^n [1,0]^T`.
  - For `(c,d)`: `M'=[[1,3],[1,2]]`, so `[c_m,d_m]^T = (M')^m [1,0]^T`.
- For Fibonacci indices:
  - `A(f_i,f_j)=c_{f_i} B_{f_j} + d_{f_i} B_{f_j+1}`.
- Sum factorization:
  - `S(K)=sum_{i=2}^K sum_{j=2}^K A(f_i,f_j)`
  - `= (sum_i c_{f_i})(sum_j B_{f_j}) + (sum_i d_{f_i})(sum_j B_{f_j+1})` (mod `1123581313`).
- Validate against given checkpoints:
  - `S(3)=30`
  - `S(5)=10396`.

## Wrong approaches and why they fail
- Treating the system as underdetermined because only `A(0,0), A(0,1)` are given:
  - This misses that both recurrences jointly force `A(0,n)` via `B_{n+1}=B_n+3B_{n-1}`.
- Using truncated finite-sequence tests to reject recurrence preservation:
  - Boundary truncation artifacts can falsely suggest contradictions (e.g., claiming `A(1,n)` does not satisfy the same second-order recurrence), derailing the derivation.
- Staying in algebraic `sqrt(13)` form for modular arithmetic:
  - It is easy to mishandle division/inverses; integer matrix recurrences are safer and directly match the required modulus computations.

## Notes
- Reviewed traces converged to the correct numeric result after verification; no stable wrong final numeric output remained after corrections.
