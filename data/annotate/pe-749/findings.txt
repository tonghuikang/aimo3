Problem: Find S(16) mod 99991, where S(d) = sum of all "near power sum" numbers with at most d digits.
A positive integer n is a near power sum if there exists k >= 1 such that sum of k-th powers of its digits equals n+1 or n-1.

Correct answer: 79236

Given checks: S(2) = 110, S(6) = 2562701.

Key approach:
- Near power sum numbers are extremely rare (only 29 up to 16 digits).
- For a d-digit number n, the exponent k must satisfy d * 9^k >= 10^(d-1) roughly (otherwise sum too small).
- Also 9^k must not vastly exceed n, bounding k from above.
- For numbers up to 10^16, k is bounded at most around 53 (for digit 2 only), but in practice k <= 16 for all solutions found.
- Key algorithm: enumerate all digit count multisets (c0,...,c9) with sum(ci) = d for each digit length d (2..16), compute sum S = sum(ci * i^k), then check if S±1 has the same digit multiset.
- Alternatively, for each k from 1..Kmax and each multiset, compute sum s, generate candidate n = s±1, check if f_k(n) = s.

The 29 near power sum numbers up to 16 digits:
35, 75 (k=2, 2-digit)
528757, 629643, 688722, 715469 (k=6, 6-digit)
30405525 (k=10, 8-digit), 31672867, 44936324, 63645890, 63645891, 71419078, 73495876 (k=8, 8-digit)
116079879 (k=8, 9-digit), 647045075 (k=10, 9-digit)
1136483324 (k=10, 10-digit)
83311557354 (k=12, 11-digit)
310374095702, 785103993880, 785103993881, 989342580966 (k=12, 12-digit)
23046269501054, 37434032885798, 50914873393416, 75759895149717 (k=14, 14-digit)
637883611437063 (k=16, 15-digit)
4020913800954247, 4023730658941129, 4586833243299785 (k=16, 16-digit)

Sum = 13459471903176422. 13459471903176422 mod 99991 = 79236.

Note: k does NOT always equal number of digits d. Some numbers have k > d (e.g., 30405525 is 8-digit with k=10).
The exponent k is always even for all found solutions.

Wrong approaches:
- Restricting k = d only misses some numbers (finds only 24 instead of 29).
- Limiting k to max_digits (16) misses nothing in practice but is not theoretically guaranteed without bounding argument.
- Brute force over all n up to 10^16 is infeasible; multiset enumeration is necessary.
