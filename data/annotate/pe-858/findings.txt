Problem: PE 858 - Sum of LCMs over all subsets
G(N) = sum over all subsets S of {1,...,N} of lcm(S), with lcm(empty set) = 1.
Given: G(5) = 528, G(20) = 8463108648960.
Need: G(800) mod 1e9+7.

Correct Answer
- 973077199

Correct Approach
- Use Möbius inversion on the divisor lattice:
  - Let F(d) = #subsets with lcm exactly d.
  - Let A(d) = #numbers i in [1..N] with i | d, so subsets with lcm dividing d are 2^{A(d)}.
  - Then F(d) = sum_{e|d} μ(d/e) 2^{A(e)}.
- After swapping sums:
  - G(N) = sum_{e|L} 2^{A(e)} * e * h(L/e), where L = lcm(1..N), h(m)=sum_{t|m} μ(t)t=prod_{p|m}(1-p).
- Direct divisor enumeration is impossible for N=800, so split primes by exponent in L:
  - Small primes (exponent > 1): 2,3,5,7,11,13,17,19,23.
  - Large primes (exponent = 1): all other primes <= 800.
- Enumerate only exponent vectors of the 9 small primes:
  - State count = prod(a_p+1) = 340200 (feasible).
  - For each state e, compute dominated-count tables C_L(e) for L in {N} union {N//p for large p}, where C_L(e) counts small-part numbers <= L whose exponent vector is <= e.
- Contribution per small state e:
  - small-weight from the Möbius-transformed factor on small primes.
  - base factor 2^{C_N(e)}.
  - large-prime product factorizes as:
    - prod_{p large} (p * 2^{C_{N//p}(e)} + (1-p)).
- Sum all state contributions modulo 1e9+7.
- This reproduces small checks and yields G(800) mod 1e9+7 = 973077199.

Wrong Approaches And Why They Fail
- Primewise full factorization attempt (`G = prod_p F_p`) fails:
  - Max exponents for different primes are coupled by the same chosen subset S, so primes are not independent.
- Replacing union size by floor(N/m) fails for composite constraint sets:
  - For multiple prime-power constraints, union size needs full inclusion-exclusion over selected constraints, not a single floor term.
- Using classical Möbius μ directly on non-squarefree prime-power products fails:
  - Sign pattern in those expansions depends on chosen constraints, not on μ(d) for powered terms.
- Brute-force DP over all possible LCM/divisor states fails:
  - Divisor/state space for L_800 is astronomically large; must use the small-prime-state + large-prime factorization reduction.
