# PE 555 - McCarthy 91 Generalization

## Correct answer
- `S(10^6,10^6) mod 99991 = 24493`

## Correct approach
- Let `d = k - s` (`d > 0` since `s < k`).
- No fixed point can satisfy `n > m`, because then `M(n) = n - s != n` for `s >= 1`.
- For `n <= m`, fixed points exist iff `d` divides `s`.
- When `d | s`, the fixed-point set is exactly
  - `F_{m,k,s} = {m - s + 1, m - s + 2, ..., m - s + d}`.
- Therefore
  - `SF(m,k,s) = d(2m - 2s + d + 1)/2` if `d | s`,
  - `SF(m,k,s) = 0` otherwise.
- For `p = m = N`, rewrite the total as
  - `S(N,N) = sum_{s=1..N-1} sum_{d|s, s+d<=N} d(2N-2s+d+1)/2`.
- Substitute `s = d t` (`t = 1..floor(N/d)-1`), giving an `O(N)` computation:
  - with `L = floor(N/d) - 1`,
  - `S(N,N) = (1/2) * sum_{d=1..N-1} [L d (2N + d + 1) - d^2 L(L+1)]`.
- Evaluating at `N = 10^6` and reducing mod `99991` gives `24493`.
- This matches both provided checks:
  - `S(10,10) = 225`
  - `S(1000,1000) = 208724467`

## Wrong approaches and why they fail
- **Assuming the classical constant-output behavior for all `k > s`**
  - Claim: `M(n)=m-s+1` for all `n<=m`.
  - Failure example: `(m,k,s)=(10,5,2)` has cyclic outputs and no fixed points.

- **Using only `k <= 2s` (or truncated top block) as the fixed-point condition**
  - Missing the necessary divisibility condition `d | s`.
  - Failure example: `(m,k,s)=(100,13,10)` has `k<=2s` but no fixed points.

- **Overfitting small-`m` data to “only `k=2s` has fixed points”**
  - Works for some tiny cases but is false in general.
  - For `p=m=10`, this wrong model gives `130` (or `380` under a broader truncation variant), not the correct `225`.

- **Ignoring `d | s` in aggregation**
  - Overcounts many `(k,s)` pairs and breaks both sample totals.
