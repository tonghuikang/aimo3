# PE 956 Annotation Findings

## Problem
Compute `D(1000⋆, 1000) mod 999999001`, where:
- `Ω(n)` is total prime-factor count with multiplicity.
- `D(n,m) = Σ_{d|n, m|Ω(d)} d`.
- `n$ = ∏_{k=1}^n k!`, `n⋆ = ∏_{i=1}^n i$`.

## Correct Answer
- `882086212` (mod `999999001`)

## Correct Approach
- Rewrite superduperfactorial:
  - `n⋆ = ∏_{k=1}^n (k!)^{n+1-k}`
  - equivalently `n⋆ = ∏_{p=1}^n p^{T(p)}`, with `T(p) = (n-p+1)(n-p+2)/2`.
- For each prime `q ≤ n`, exponent in `n⋆` is:
  - `A_q = Σ_{p=1}^n v_q(p) * T(p)`.
- Build divisor/Omega generating function:
  - `F(x) = ∏_{q≤n} Σ_{e=0}^{A_q} (q x)^e`.
  - Coefficient of `x^k` equals sum of divisors `d` with `Ω(d)=k`.
- Use roots-of-unity filter (`m=1000`):
  - `D(n⋆,m) = (1/m) Σ_{j=0}^{m-1} F(ζ^j)`,
  - with `ζ` a primitive `m`-th root in `F_MOD`, `MOD=999999001`.
- This is valid since `MOD` is prime and `1000 | (MOD-1)`, so primitive 1000th roots exist and `1/1000` exists mod `MOD`.
- Evaluate each geometric factor by:
  - `Σ_{e=0}^{A_q} r^e = (r^{A_q+1}-1)/(r-1)`, `r = qζ^j`,
  - and if `r=1`, use `A_q+1`.
- Verified against the provided anchor:
  - `D(6⋆,6) = 6368195719791280` (exact), and mod `999999001` equals `81625078`.

## Wrong Approaches Observed
- Incorrect `MOD-1` factorization (including `101`, wrong power for `3`) leads to invalid primitive-root checks.
- Hard-coding `inv_m = inv(1000)` inside a generic `compute_D(..., m)` causes wrong validations for other `m` (e.g. wrong residue for the `m=6` check before fix).
- Confusing `n⋆` with `∏_{i=1}^n i!` (instead of `∏_{i=1}^n i$`) gives wrong sanity-check values (e.g. `24883200` instead of `5944066965504000` for `n=6`).
