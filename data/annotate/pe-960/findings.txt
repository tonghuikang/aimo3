Correct answer: 243559751 (mod 1e9+7)

Correct approach
- Let T be a labeled tree on n vertices (Cayley object), and let each move correspond to one tree edge.
- For each edge {u,v}, the removal amounts x_{uv}, x_{vu} are uniquely determined by
  - x_{uv} + x_{vu} = n for every edge
  - sum_{u~v} x_{vu} = n-1 for every vertex v.
- The per-tree score is
  - Score(T) = sum_{e in E(T)} min(s_e, n-s_e)
  where s_e is one component size after deleting edge e.
- Therefore
  - F(n) = (n-1)! * S_n
  - S_n = sum_{T} Score(T).
- Count trees where fixed ordered edge (i,j) has i-side size k:
  - C(n-2,k-1) * k^(k-2) * (n-k)^(n-k-2).
- Summing over ordered pairs (i,j), divide by 2 to get unordered edges, then weight by min(k,n-k):
  - S_n = n(n-1)/2 * sum_{k=1}^{n-1} C(n-2,k-1) * k^(k-2) * (n-k)^(n-k-2) * min(k,n-k).
- Final closed form:
  - F(n) = (n-1)! * n(n-1)/2 * sum_{k=1}^{n-1} C(n-2,k-1) * k^(k-2) * (n-k)^(n-k-2) * min(k,n-k).
- Computing this modulo 1e9+7 for n=100 gives 243559751.

Wrong approaches observed
- Degree-pattern collapse ("two degree-1 vertices, others degree-2/path only"): invalid; successful traces include non-path trees.
- Degree-only score formula attempts (ignoring cut-size dependence) overcount/undercount. A representative bad formula produced contradictions immediately (e.g. n=3 -> 36 instead of 12, n=4 -> 1584 instead of 360).
- Treating brute mismatch as theory failure before validating tooling: a buggy Pr√ºfer decode (leaf update order bug) created false counterexamples (e.g. incorrect G(4)=58 vs true 60).
- Over-restrictive root/orientation constraints (e.g. neighbor-degree condition) incorrectly rejected realizable trees.
