# PE 535 Fractal Sequence - Findings

## Problem
Compute the last 9 digits of \(T(10^{18})\), where \(T(n)\) is the sum of the first \(n\) terms of the fractal sequence \(S\).

## Given Checks
- \(T(1)=1\)
- \(T(20)=86\)
- \(T(10^3)=364089\)
- \(T(10^9)=498676527978348241\)

## Correct Answer
611778217

## Correct Approach
- Use block decomposition: each repeat term \(s_i\) is preceded by \(\lfloor\sqrt{s_i}\rfloor\) new circled integers.
- Define
  - \(A(n)=\sum_{j=1}^{n}\lfloor\sqrt{s_j}\rfloor\)
  - \(H(m)=\sum_{x=1}^{m}\lfloor\sqrt{x}\rfloor\)
  - block-end index \(L(k)=k+A(k)\).
- For any \(N\), find largest \(k\) with \(L(k)\le N\), and set \(r=N-L(k)\).
- Then
  - \(T(N)=T(k)+\frac{A(k)(A(k)+1)}{2}+rA(k)+\frac{r(r+1)}{2}\)
  - \(A(N)=A(k)+H(A(k)+r)\).
- Compute recursively with memoization; find \(k\) by binary search since \(n+A(n)\) is monotone; use direct precomputation for small \(n\).
- This matches all provided check values and yields \(T(10^{18})\bmod 10^9=611778217\).

## Wrong Approaches and Why They Fail
- **Incorrect floor-sqrt accumulation update**:
  - Using \(A(N)=A(k)+\big(H(A(k)+r)-H(A(k))\big)\) drops the \(H(A(k))\) part already present at \(L(k)\).
  - This undercounts \(A(N)\), propagates into bad block boundaries, and produces large errors (including near-half-scale errors at large \(N\)).
- **Heuristic asymptotics used as exact computation**:
  - Approximations such as \(C(N)\approx N-\alpha\sqrt{N}\) or \(T(N)\approx N(N+1)/2-cN^{5/3}\) are not sufficient for exact last-9-digit output.
  - These led to guessed outputs like \(0\).
- **Prefix-matching-only generation work**:
  - Queue/order simulations can match early terms but do not solve the exact large-\(N\) inversion step (finding repeat count/index map), so they do not scale to \(10^{18}\) without the recursive \(A/T\) formulation.
