# PE_874 Findings

## Problem Summary
Find `M(7000, p(7000)) mod 99991`, where `M(k,n)` is the maximum of `sum p(a_i)` over lists of length `n` with `0 <= a_i < k` and `sum a_i` divisible by `k`.

## Correct Answer
`24777`

## Key Values
- `k = 7000`
- `n = p(7000) = 70663` (the 7001st prime)
- `p(6999) = 70657` (the 7000th prime)
- Baseline residue with all `a_i = 6999`: required total reduction
  `D0 = (-n) mod 7000 = 6337`

## Correct Approach
- Start from all `a_i = k-1 = 6999` (max per-entry score).
- Let each changed entry contribute reduction depth `t` (so `a = 6999 - t`).
- Loss for one entry reduced by `t`:
  `C(t) = p(6999) - p(6999 - t)`.
- Need total depth sum `sum t_i = 6337` (choosing larger `6337 + 7000m` only adds extra positive loss).
- Minimize `sum C(t_i)` over integer depths summing to `6337`.
- This is an unbounded knapsack:
  `dp[w] = min_{1<=t<=w}(dp[w-t] + C(t))`, `dp[0]=0`.
- Optimal loss is `60202`.
- Therefore:
  `M = 70663 * 70657 - 60202 = 4992775389`,
  and `4992775389 mod 99991 = 24777`.

## Wrong Approaches
- **Single big reduction assumption**:
  Assume one entry reduced by all `6337` is always optimal.
  This gives loss `C(6337)=63380` and wrong result `19279`.
- **Naive marginal greedy**:
  Greedy on current marginal costs with incorrect tie handling can be suboptimal.
  This produced wrong result `21599` in one trace.

## Why Wrong Approaches Fail
- Prime-gap structure makes loss non-linear and irregular.
- Optimal depth allocation is a global partitioning problem, not a one-step local rule.
- You must solve the exact minimum-loss depth partition (DP), rather than forcing a single reduction or relying on unstable greedy tie choices.
