# Problem PE 387 - Strong, Right Truncatable Harshad Primes

## Correct Answer
- Sum of strong, right truncatable Harshad primes below `10^14`:
  `696067597313468`
- Required output:
  `696067597313468 mod 99991 = 35878`

## Correct Approach
1. Generate all right-truncatable Harshad numbers `h < 10^13` via DFS/BFS:
   - Start from `1..9`.
   - Extend with digit `d in {0..9}` to `h' = 10h + d`.
   - Keep `h'` only if `h' % (sum_digits(h)+d) == 0`.
2. Filter to strong Harshad prefixes:
   - `h` is strong iff `h / sum_digits(h)` is prime.
3. Build candidate primes:
   - For each strong right-truncatable `h`, test `p = 10h + d` for `d in {1,3,7,9}`.
   - Keep `p` if `p < 10^14` and `p` is prime.
4. Sum all such `p`, then reduce modulo `99991`.

## Required Validation Checks
- Reproduce the given benchmark:
  sum below `10000` is exactly `90619`.
- With the correct algorithm:
  - number of strong right-truncatable Harshad primes below `10^14`: `86`
  - total sum: `696067597313468`
  - modulo `99991`: `35878`

## Wrong Approaches and Why They Fail

### Wrong Approach 1: Skip the “strong” filter
- Mistake: use any right-truncatable Harshad prefix (without requiring `h / digit_sum(h)` prime).
- Wrong result:
  - sum = `51203202298432263`
  - mod `99991` = `22389` (wrong)

### Wrong Approach 2: Wrong prefix bound (`h < 10^12`)
- Mistake: cap right-truncatable Harshad generation one digit too early, missing valid 14-digit prime candidates.
- Wrong result:
  - sum = `47175350800711`
  - mod `99991` = `64432` (wrong)

### Wrong Approach 3: Memory-based guessing of known Project Euler output
- Mistake: rely on recalled constants instead of recomputation and benchmark verification.
- Effect: inconsistent candidate answers; no reliable derivation.
