# Problem pe-454: Egyptian Fractions Counting

## Problem
Count integer triples \((x,y,n)\) satisfying
\[
\frac1x+\frac1y=\frac1n,\quad x<y\le L,
\]
and compute \(F(10^{12})\bmod 99991\).

## Correct Answer
27534

## Correct Approach
- Rearrangement gives
  \[
  (x-n)(y-n)=n^2.
  \]
  Let \(a=x-n\), \(b=y-n\). Then \(ab=n^2\), \(a<b\), and \(b+n\le L\).
- Primitive scaling parameterization:
  - choose coprime \(u<v\), \(\gcd(u,v)=1\)
  - choose scale \(g\ge1\)
  - then
    \[
    n=guv,\quad x=gu(u+v),\quad y=gv(u+v).
    \]
- Therefore
  \[
  F(L)=\sum_{\substack{u<v\\(u,v)=1}}\left\lfloor\frac{L}{v(u+v)}\right\rfloor.
  \]
  With \(m=v\), \(n=u+v\):
  \[
  F(L)=\sum_{\substack{m<n<2m\\(m,n)=1}}\left\lfloor\frac{L}{mn}\right\rfloor.
  \]
- Remove coprimality by MÃ¶bius inversion:
  \[
  F(L)=\sum_{d\le\sqrt L}\mu(d)\,H\!\left(\left\lfloor\frac{L}{d^2}\right\rfloor\right),
  \]
  where
  \[
  H(T)=\sum_{m<n<2m}\left\lfloor\frac{T}{mn}\right\rfloor.
  \]
- Compute \(H(T)\) and related summatory terms using floor-division interval grouping / divisor-summatory techniques (not naive pair iteration).

## Wrong Approaches And Why They Fail
- **False divisor structure claim**: assuming every divisor \(b>n\) of \(n^2\) is of form \(b=nk\) with integer \(k\mid n\).
  - This is false (e.g., \(n=6\), divisor \(b=9\) of \(36\) is not a multiple of 6).
  - It leads to the incorrect shortcut
    \[
    F(L)=\sum_{k\ge2}\left\lfloor\frac{L}{k(k+1)}\right\rfloor,
    \]
    which already fails on the given check \(F(15)=4\).
- **Over-aggressive local simplifications**: piecewise formulas for inner counts (such as direct \(r/c-1\)-style replacements) applied outside their valid regime produce contradictions in test cases.
- **Complexity failure despite mostly-correct math**: repeated symbolic rewrites without committing to grouped summation cause algorithms that are still too slow at \(L=10^{12}\), ending in give-up outputs instead of computed values.

## Trace Outcomes
- Correct: `ut6zlk.txt`, `grw5cm.txt` (both reach 27534)
- Wrong: `4dtea1.txt`, `g7a7io.txt` (both end with placeholder 0)
