# Problem pe-496 Findings

## Problem Summary
Given integer-sided triangle ABC with incenter I and D = intersection of line AI with circumcircle (A ≠ D):
- F(L) = sum of BC for all integer-sided triangles satisfying AC = DI and BC ≤ L
- Find F(10^9) mod 99991

## Correct Answer
6660

## Key Formula
DI = 2R sin(A/2), where R is circumradius and A is angle at vertex A.

The condition AC = DI (i.e., b = DI) leads to: b = a / (2 cos(A/2)), or equivalently cos(A/2) = a/(2b).

## Correct Approach (jyjaio and tzs1zt)
Using half-angle formulas and algebraic manipulation, the condition reduces to:
- b = a²/d where d is a divisor of a²
- c = d - b
- Triangle inequalities require: a < d < 2a

Thus, all integer solutions are parameterized by:
1. Choose integer a ≥ 1
2. Find all divisors d of a² satisfying a < d < 2a
3. Each such d gives triangle (a, b, c) = (a, a²/d, d - a²/d)

Sum formula: F(L) = Σ_{a=1}^{L} a × N(a)
where N(a) = number of divisors d of a² with a < d < 2a

This parameterization allows efficient computation since we iterate over a directly.

## Wrong Approach (i20wa5) - Gets 16272
Uses the angular condition B = A/2 to derive a different parameterization:
- For coprime integers (p, q) with q > 3p
- a = 2(q² - p²), b = (q + p)², c = 3q² - 10pq + 3p²
- After reduction by gcd, get primitive triples

This approach:
1. Is mathematically correct but computationally less efficient
2. The trace struggles to enumerate all primitive triples efficiently
3. Mixes parameterizations and treats an odd-pair representation as effectively unique, even though collisions occur (same primitive BC value generated by different parameter pairs), which destabilizes counting
4. Uses ad-hoc search bounds that are shown by small-case checks to be unsafe, then falls back to an unproven counting routine
5. Overcounts and returns 16272 instead of 6660

## Key Decision Points
The critical insight is that parameterizing by 'a' directly (the jyjaio approach) is much more efficient and leads to correct counting. The (p,q) parameterization (i20wa5) requires generating all primitive triples separately and summing their contributions, which is error-prone for L = 10^9.

## Example Triangles (BC, AC, AB)
- (6, 4, 5): a=6, d=9, b=36/9=4, c=9-4=5 ✓
- (12, 8, 10): a=12, d=18, b=144/18=8, c=18-8=10 ✓
- (12, 9, 7): a=12, d=16, b=144/16=9, c=16-9=7 ✓
- (15, 9, 16): a=15, d=25, b=225/25=9, c=25-9=16 ✓
