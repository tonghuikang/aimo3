# Problem pe-410 Findings

## Correct answer
- `F(10^8,10^9) + F(10^9,10^8) (mod 99991) = 51150`.

## Correct approach
- Write the tangent line through `P(a,b)` and `Q(-a,c)` as
  `(c-b)x + 2ay - a(b+c) = 0`.
- Tangency to `x^2+y^2=r^2` gives
  `a^2(b+c)^2 - r^2(b-c)^2 = 4a^2r^2`.
- Let `X=b+c`, `Y=b-c`. Then
  `a^2(X^2-4r^2)=r^2Y^2`, with parity requirement `X ≡ Y (mod 2)` (equivalently integer `b,c`).
- A correct parameterization uses coprime positive integers `p,q`:
  `r = pq·r1`, `a = pq·a1`,
  `b = (r1(p^2+q^2) - a1(p^2-q^2))/2`,
  `c = (r1(p^2+q^2) + a1(p^2-q^2))/2`.
- Parity rule:
  if `pq` is odd, no extra parity constraint on `(r1,a1)`;
  if `pq` is even, require `r1 ≡ a1 (mod 2)`.
- Group by `D=pq`. The number of ordered coprime pairs `(p,q)` with product `D` is `2^{ω(D)}`.
- Therefore
  `F(R,X) = 2 * Σ_{D≤min(R,X)} 2^{ω(D)} * H_D`, where
  `rd = R//D`, `xd = X//D`, and
  - `H_D = rd*xd` for odd `D`
  - `H_D = floor(rd/2)*floor(xd/2) + ceil(rd/2)*ceil(xd/2)` for even `D`.
- Compute efficiently by divisor-interval grouping (`rd,xd` constant on intervals) plus fast prefix sums
  `S(N)=Σ_{n≤N}2^{ω(n)}` and `S_odd(N)=Σ_{n≤N,n odd}2^{ω(n)}`.
- With this pipeline, all provided checks are matched (`F(1,5)=10`, `F(2,10)=52`, `F(10,100)=3384`) and the final modulo is `51150`.

## Wrong approaches and why they fail
- GCD-only counting (`g(r,a)` depending only on `gcd(r,a)`) overcounts.
  Counterexample: `(r,a)=(2,4)` is miscounted if parity/integrality constraints are not enforced.
- Restricting to a primitive-Pythagorean-triple condition (e.g., forcing `p^2-q^2` to be a square) is too strict and misses valid families (such as those generated by `(p,q)=(1,2)`).
- Incorrect odd/even correction handling or an incorrect `S_odd` summation implementation yields wrong small checks (e.g., 56 or 60 instead of 52 for `F(2,10)`).
- Symbolic manipulations without an executable summatory algorithm lead to non-answers or placeholder outputs instead of the required numeric result.
