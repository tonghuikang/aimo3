Correct answer (mod 1,000,000,007): 94586478

Correct approach
- Write each n uniquely as n = d^2 * s with s squarefree. Then g(n) = d^2.
- Therefore
  S(N) = sum_{d<=sqrt(N)} d^2 * Q(floor(N/d^2)),
  where Q(x) is the count of squarefree integers <= x.
- Use Q(x) = sum_{k<=sqrt(x)} mu(k) * floor(x/k^2), then rearrange the double sum by setting m=d*k:
  S(N) = sum_{m<=sqrt(N)} A(m) * floor(N/m^2),
  A(m) = sum_{d|m} d^2 * mu(m/d).
- A(m) is Jordan totient J_2(m):
  A(m) = J_2(m) = m^2 * product_{p|m}(1 - 1/p^2).
- For N=10^14, compute J_2(m) for m<=10^7 with a linear sieve recurrence:
  - if p does not divide i: J2[i*p] = (p^2 - 1) * J2[i]
  - if p divides i: J2[i*p] = p^2 * J2[i]
- Finally sum J2[m] * floor(N/m^2) modulo 1,000,000,007.

Wrong approaches and why they fail
- Misreading g(n) as the squarefree part n/g(n) (instead of the largest square divisor).
  This gives wrong sample totals (e.g., S(10)=38 and S(100)=3233, not 24 and 767).
- Replacing J_2 with an Euler-phi-like weight m^2*prod_{p|m}(1-1/p)=m*phi(m).
  This underweights terms and gives wrong sample totals (e.g., S(10)=20 and S(100)=578).
- Computing Q(N/d^2) from scratch for every d via full Mobius summation.
  This is computationally infeasible at N=10^14 even though the formula itself is mathematically valid.
