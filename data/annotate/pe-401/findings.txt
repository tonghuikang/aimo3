# Project Euler 401 - Summatory Sigma2

## Correct Answer
281632621

## Problem Summary
Given
- `sigma_2(n) = sum_{d|n} d^2`
- `SIGMA_2(N) = sum_{n=1}^N sigma_2(n)`

compute `SIGMA_2(10^15) mod 10^9`.

## Correct Approach
1. Swap summations:
   - `SIGMA_2(N) = sum_{n<=N} sum_{d|n} d^2 = sum_{d=1}^N d^2 * floor(N/d)`.
2. Group by constant quotient `q = floor(N/d)`:
   - interval of `d`: `L = floor(N/(q+1)) + 1`, `R = floor(N/q)`.
3. Use square-prefix formula:
   - `S2(x) = 1^2 + ... + x^2 = x(x+1)(2x+1)/6`,
   - `sum_{d=L}^R d^2 = S2(R) - S2(L-1)`.
4. Evaluate in `O(sqrt(N))` by quotient grouping (or equivalent sqrt split).
5. For modulus `10^9` (non-prime), do exact integer division in `S2` first, then reduce modulo.

## Wrong Approaches And Why They Fail
1. **Wrong modular handling of `/6` in `S2`**
   - Bad pattern: reduce factors mod `10^9` first and then do `//6` on that modular product.
   - Why it fails: division by 6 is not valid in modular arithmetic mod `10^9` (`gcd(6,10^9) != 1`); integer division must happen before modulo.
   - Wrong result produced by this bad method: `947990955`.

2. **Dropping the large-`d` tail (only summing `d <= floor(sqrt(N))`)**
   - Bad pattern: compute only `sum_{d=1}^{floor(sqrt(N))} d^2 floor(N/d)` and stop.
   - Why it fails: misses all contributions from `d > floor(sqrt(N))`.
   - Wrong result produced: `73266836`.

3. **Using the wrong modulus (`10^9+7` instead of `10^9`)**
   - Bad pattern: solving the right sum but under the wrong modulus.
   - Why it fails: problem asks modulo `10^9` exactly.
   - Wrong result under `10^9+7`: `999515277`.
