Problem: PE 783 - Urn model with black/white balls
Correct answer: 78891 (which is 136666597 mod 99991)

Setup: Start with kn white balls. Each of n turns: add k black, remove 2k random. B_t = black removed on turn t. Compute E(n,k) = E[sum B_t^2]. Find E(10^6, 10) mod 99991.

Key observations:
1. Total balls after turn t = kn - kt (deterministic), so N_t (before removal) = k(n-t+2) is deterministic.
2. The ratio A_t = (N_t - 2k)/N_t = (n-t)/(n-t+2), independent of k.
3. B_t | X_t ~ Hypergeometric(N_t, X_t, 2k), where X_t = black count before removal.

Correct approach (DP on moments):
- Track E[X_t] = x_t and E[X_t^2] = w_t (or second factorial moment m2_t).
- Recurrence: x_{t+1} = A_t * x_t + k, with x_1 = k.
- Closed form: E[X_t] = k * t * (n - t + 2) / (n + 1).
- E[B_t] = 2k * t / (n+1).
- E[B_t^2] computed from x_t, w_t using hypergeometric moment formulas.
- Sum over t=1..n gives E(n,k), computed via O(n) loop.

Alternative correct approach (pair counting):
- E(n,k) = kn + 2 * sum_{pairs} P(same removal turn)
- E[C(B_t,2)] = beta_t * m2_t/2 where beta_t = (2k)(2k-1)/(N_t(N_t-1))
- E(n,k) = kn + sum_t beta_t * m2_t
- Can be expressed as closed-form sum over i=1..n-1.

Numerical result: E(10^6, 10) â‰ˆ 136666597.000063, rounds to 136666597.
136666597 mod 99991 = 78891.

Both traces in kkp9if arrive at correct answer via similar DP/moment approaches.
