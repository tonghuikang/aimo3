# Problem PE 843 - Periodic Circles

## Correct Answer
- \(S(100) \bmod 99991 = 57293\)

## Problem-Level Facts
- \(S(N)\) is the sum of **distinct** period lengths that appear for any \(n \in [3, N]\), not a per-\(n\) sum.
- The absolute-difference process can be analyzed through parity: over GF(2), the update is linear
  \(b_i = a_{i-1} + a_{i+1}\).
- Empirically and structurally, binary dynamics capture the period lengths needed for the integer process.

## Correct Approach
1. For each \(n\), analyze the GF(2) linear map \(A_n\) (rule-90-on-a-cycle form).
2. Use polynomial/ring decomposition of \(x^n - 1\) over GF(2):
   - For each irreducible factor \(f\) (excluding trivial zero-only behavior from \(x+1\)), compute the order of \(a=x+x^{-1}\) modulo \(f\).
   - Repeated factors from \(n=2^s m\) (with \(m\) odd) create 2-power lifting in component orders.
3. Build per-\(n\) period set from LCMs of component choices:
   - Each component must allow “off” choice (order 1) to represent zero projection in that component.
   - Include lifted orders for allowed 2-powers.
4. Union periods over \(n=3..100\), then sum.

## Required Validations
- Small-\(n\) brute-force checks (e.g., \(n \le 10\)) must match the algebraic construction.
- Benchmark check must match given \(S(30)=20381\).
- Final raw sum is \(S(100)=2816775424692\), so modulo \(99991\) is \(57293\).

## Wrong Approaches and Why They Fail
- Assuming “periods for a fixed \(n\) are all divisors of one maximal \(D(n)\)”:
  This fails against provided small examples and leads to contradictions (e.g., wrong reconstruction of \(S(6)\)).
- Heuristic “\(D(d)\)+ad-hoc extra divisor” generation (including the “only extra 5” assumption):
  It can be tuned to match \(S(30)\) but still gives wrong \(S(100)\) (1804).
- Building per-\(n\) periods without per-factor optional zero component:
  This misses valid periods (notably period 5 for \(n=17\)) and undercounts \(S(30)\) as 20376.
