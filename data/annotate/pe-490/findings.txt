# Findings for pe-490

## Correct answer
- `S(10^14) mod 10^9 = 777577686`.

## Correct approach
- Interpret `f(n)` as the number of Hamiltonian paths from `1` to `n` in the graph on `{1,...,n}` with edges `|i-j| <= 3`.
- Compute initial terms and use recurrence discovery (or transfer-matrix reasoning) to get:
  - `f(1..8) = 1,1,1,2,6,14,28,56`
  - For `n >= 9`:
    - `f(n) = 2f(n-1) - f(n-2) + 2f(n-3) + f(n-4) + f(n-5) - f(n-7) - f(n-8)`
- To sum cubes efficiently, define `X_n = [f(n), f(n-1), ..., f(n-7)]` and track all degree-3 monomials `X_n[i]X_n[j]X_n[k]` (`i <= j <= k`), giving `C(10,3)=120` states.
- Build the induced linear transition `Y_{n+1} = B Y_n` on those cubic monomials, then augment one accumulator state for prefix sums:
  - `S_{n+1} = S_n + f(n+1)^3`.
- Exponentiate the resulting `121 x 121` linear transition modulo `10^9` to jump to `L=10^14`.
- This reproduces all published checks:
  - `S(10)=18230635`
  - `S(20)=104207881192114219`
  - `S(1000) mod 10^9 = 225031475`
  - `S(10^6) mod 10^9 = 363486179`

## Wrong approaches and why they fail
- Using `f(1)=0` (instead of `f(1)=1`) gives an off-by-one prefix sum (`S(10)=18230634` instead of `18230635`).
- Deriving a recurrence for `g(n)=f(n)^3` via BM modulo a prime and then directly “sign-lifting” coefficients to integers is not reliable; it produced an immediate inconsistency (first failure at `n=121` in integer verification).
- Attempting to recover large integer `g`-recurrence coefficients via heavy exact linear solves is unnecessary and can time out; direct monomial-state transfer is both cleaner and robust.
