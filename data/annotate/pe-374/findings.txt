Problem: PE 374 - Maximum Integer Partition Product

Correct answer: 334420941

Problem summary: For n, consider partitions of n into distinct positive integer parts. f(n) = maximum product of parts, m(n) = number of parts in the maximizing partition. Compute sum_{n=1}^{10^14} f(n)*m(n) mod 982451653.

Correct approach:
1. For n <= 4, the optimum is one part: f(n)=n and m(n)=1.
2. For n >= 5, optimal partitions never use 1. For fixed k, the baseline partition is {2,3,...,k+1} with sum S_k = k(k+3)/2.
3. m(n)=k exactly on the block
   [k(k+3)/2, (k+1)(k+4)/2 - 1].
   So each k-block has length k+2.
4. Write n = S_k + d with 0 <= d <= k+1, then d = qk + r (0 <= r < k).
   Optimal parts are baseline + q on all entries, and +1 on the last r entries.
5. This gives
   f(n) = ((q+k+2)! / (q+1)!) / (q+k-r+2),
   i.e., a consecutive factorial ratio with one missing factor.
6. Because d <= k+1, for k >= 2 we always have q in {0,1}:
   - d = 0..k-1: f(n) = (k+2)! / (k+2-d)
   - d = k:     f(n) = (k+2)! / 2
   - d = k+1:   f(n) = (k+3)(k+1)! / 2
7. Sum by k-blocks up to N=10^14 (k_max about 1.4e7), using modular factorials and modular inverse prefix sums, plus one partial final block.
8. Validation anchor: sum_{n<=100} f(n)m(n) = 1683550844462.

Wrong approaches and why they fail:
1. Treating each k-block as only d=0..k (k+1 values) misses d=k+1 and drops one term per block, giving wrong totals.
2. Using an incorrect full-block boundary test for K_full (largest k with n_max(k) <= N) can classify a partial block as full, causing boundary overcount.
3. Heuristics like “always add extra to smallest part” or “always to largest part” are incomplete; the correct condition is a nondecreasing increment sequence, yielding q/q+1 tail distribution.
