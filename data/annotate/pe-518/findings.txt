Problem: Find S(n) = sum of a+b+c over all triples (a,b,c) of primes where a<b<c<n and a+1, b+1, c+1 form a geometric progression. Compute S(10^8) mod 99991.

Correct Answer: 13548

Key Insight - Parameterization:
If a+1, b+1, c+1 form a geometric progression with ratio r = p/q (in lowest terms), then:
- a+1 = q^2 * m
- b+1 = p * q * m
- c+1 = p^2 * m
where p > q > 0, gcd(p,q) = 1, m >= 1.

This is because for integer geometric progressions, the terms must be of this form.

Algorithm:
1. Generate primes up to n using sieve
2. For each prime a:
   - Factor a+1 to find all possible q values (divisors of the "square part" of a+1)
   - For each valid q, compute d = (a+1)/q^2
   - Iterate p > q with gcd(p,q) = 1
   - Check if b = d*p*q - 1 and c = d*p^2 - 1 are both prime and c < n
3. Sum all valid triples mod 99991

Example triples for n=100:
- (2,5,11): ratio 2, p=2, q=1, m=3
- (7,11,17): ratio 3/2, p=3, q=2, m=2
- (17,23,31): ratio 4/3, p=4, q=3, m=2

Both traces correctly derive the parameterization and implement working code to get 13548.
