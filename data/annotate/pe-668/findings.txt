## Problem: PE 668

## Correct answer
- Exact count up to `10^10`: `2,811,077,773`
- Required output modulo `99991`: `30790`

## Correct approach
- Let `P(n)` be the largest prime factor of `n` (for `n>1`).
- The condition “all prime factors are strictly less than `sqrt(n)`” is equivalent to:
  `P(n) < sqrt(n)`  iff  `P(n)^2 < n`.
- So smooth numbers are those with `P(n)^2 < n`; complement (unsmooth) has `P(n)^2 >= n`.

- For unsmooth `n>1`, write `n = p*m` with `p = P(n)`.
  Then `P(n)^2 >= n` becomes `p^2 >= p*m`, so `m <= p`.
  This gives a bijection:
  `unsmooth(N) = sum_{p prime <= N} min(p, floor(N/p))`.

- For `N = 10^10`, set `X = floor(sqrt(N)) = 100000`:
  `unsmooth(N) = S1 + S2`
  where
  `S1 = sum_{p <= X} p`,
  `S2 = sum_{p > X} floor(N/p)`.

- For `S2`, group by quotient `k = floor(N/p)` (`1 <= k <= X-1`):
  `S2 = sum_{k=1}^{X-1} k * (pi(floor(N/k)) - pi(floor(N/(k+1))))`
  and by summation by parts:
  `S2 = sum_{k=1}^{X-1} pi(floor(N/k)) - (X-1)*pi(X)`.

- Therefore:
  `smooth(N) = N - unsmooth(N)`.
- Sanity check at `N=100` gives `29` (including `1`), matching the statement.

## Wrong approaches and why they fail
- Wrong verifier predicate: checking `P(n) < isqrt(n)` instead of real `P(n) < sqrt(n)`.
  This wrongly rejects valid non-squares (e.g., `n=63`, `P(n)=7`, `sqrt(63)≈7.94`).
- Faulty custom Lehmer `pi(x)` implementation (root/index boundary issues) produced incorrect prime counts for large arguments, yielding:
  - wrong smooth count `2,802,097,355`
  - wrong modulo answer `49562`.
- False confirmation from non-independent checks: recomputing with algebraically equivalent formulas that reuse the same buggy `pi(x)` routine does not validate correctness.
