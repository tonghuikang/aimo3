# PE 812 - Dynamical Polynomials Findings

## Problem
Count monic integer polynomials `f` of degree `n` such that
`f(x) | f(x^2 - 2)`.
Given checkpoints: `S(2)=6`, `S(5)=58`, `S(20)=122087`.
Need `S(10000) mod 998244353`.

## Correct Answer
`S(10000) mod 998244353 = 986262698`.

## Correct Approach
1. Use the Chebyshev substitution `x = z + z^{-1}` and define
   `F(z) = z^n f(z + z^{-1})`.
   Then `F` is monic reciprocal of degree `2n`, and the condition becomes `F(z) | F(z^2)`.
2. Factor `F` into cyclotomics:
   `F(z) = \prod_{k>=1} \Phi_k(z)^{a_k}`.
   Divisibility gives chain constraints `a_{2k} <= a_k` for all `k`.
3. Add the missing parity condition for `k=1`:
   because `\Phi_1(z)=z-1` has constant term `-1`, reciprocal/constant-term consistency requires `a_1` to be even.
4. Degree condition is
   `\sum_k a_k \varphi(k) = 2n`.
   So counting `S(n)` is counting exponent arrays `(a_k)` satisfying:
   - `a_k >= 0`
   - `a_{2k} <= a_k`
   - `a_1` even
   - weighted degree sum `2n`.
5. Convert to generating functions by odd chains `m,2m,4m,...`, then apply parity projection for `a_1` (even/odd split).
   Compute coefficients up to degree `2n` with formal power-series `exp/log` (NTT-friendly over `998244353`).
6. Validate with checkpoints (`58`, `122087`) before evaluating `n=10000`.

## Wrong Approaches And Why They Fail
- Ignoring the `a_1` parity constraint:
  overcounts invalid reciprocal-polynomial configurations.
- Truncating odd `m` too aggressively when building representation counts (`c_d`):
  misses valid contributions where `m` is larger but `\varphi(m)` is still small.
- Treating a handcrafted generator-degree multiset as fully independent:
  gives inconsistent checkpoint values (e.g., `S(5)=54`, `S(20)=69762`) and wrong final outputs.
- Getting stuck in performance optimization (DP/NTT variants) before mathematically reconciling checkpoint mismatches.

## Practical Verification Signals
- Any method must reproduce all three provided checkpoints exactly.
- If `S(5)` or `S(20)` mismatches, the counting model is structurally wrong (not just an implementation bug).
