## Problem pe-635 Findings

### Correct Answer
689294705

### Problem Summary
For each q, A_q(n) counts n-element subsets of {1,...,qn} whose element-sum is divisible by n.
We need
S_q(L) = \sum_{p\le L,\ p\ \text{prime}} A_q(p),
and the target is
S_2(10^8) + S_3(10^8) \pmod{1,000,000,009}.

### Correct Approach
1. Model residues modulo n:
   - In {1,...,qn}, each residue class mod n appears exactly q times.
   - Let x_r be how many elements are chosen from residue r; then \(\sum_r x_r=n\) and \(\sum_r r x_r\equiv 0\pmod n\).
2. Use a roots-of-unity filter + generating functions:
   - This yields
     \[
     A_q(n)=\frac1n\sum_{d\mid n}\varphi(d)(-1)^{n+n/d}\binom{qn/d}{n/d}.
     \]
3. Specialize to prime n=p:
   - For odd prime p,
     \[
     A_q(p)=\frac{\binom{qp}{p}+q(p-1)}{p}.
     \]
   - p=2 is exceptional and must be handled directly:
     - A_2(2)=2
     - A_3(2)=6
4. Compute S_2(10^8), S_3(10^8) modulo M=1,000,000,009 efficiently:
   - Sieve all primes p<=10^8.
   - Need binomials \(\binom{2p}{p}\) and \(\binom{3p}{p}\), so capture p!, (2p)!, (3p)! modulo M for prime p.
   - A practical method is a single forward factorial pass up to 3*10^8 (store only at indices p,2p,3p), then inverse-factorial recovery (backward pass or modular inverses) to evaluate binomials and sum contributions.

### Wrong Approaches And Why They Fail
1. Assuming residue sums are perfectly uniform:
   - Guessing \(A_q(n)=\binom{qn}{n}/n\) is false (e.g., n=5 gives non-integer 252/5, while A_2(5)=52).
2. Applying the odd-prime closed form to p=2:
   - This produces wrong counts; p=2 must be treated separately.
3. Over-searching for extra closed-form prime-sum identities after deriving the prime formula:
   - These detours do not reduce complexity versus the direct factorial/binomial computation strategy needed for L=10^8.
