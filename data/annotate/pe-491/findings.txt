# Problem pe-491: Double Pandigital Numbers Divisible by 11

## Correct Answer: 38631

## Problem Summary
Count 20-digit double pandigital numbers (each digit 0-9 appears exactly twice) that:
1. Have no leading zero
2. Are divisible by 11
Return the count modulo 99991.

## Correct Approach
Use a parity-split counting model with the 11-divisibility rule.

1. **Divisibility condition**: A number is divisible by 11 iff \(S_{odd} - S_{even} \equiv 0 \pmod{11}\), where odd/even are alternating positions.

2. **Key insight**: Total digit sum is \(2(0+1+\cdots+9)=90\), so \(S_{odd}+S_{even}=90\). Therefore:
   - \(2S_{odd} \equiv 90 \pmod{11}\)
   - \(S_{odd} \equiv 1 \pmod{11}\)

3. **Counting setup**: For each digit \(i\in\{0,\dots,9\}\), let \(a_i\in\{0,1,2\}\) be the number of copies in odd positions, and \(b_i=2-a_i\) in even positions.
   - Constraint 1: \(\sum a_i=10\)
   - Constraint 2: \(\sum i\,a_i\equiv 1 \pmod{11}\)

4. **Formula per valid assignment**:
   \[
   \text{contribution}=\frac{10!}{\prod b_i!}\cdot \frac{9!}{\prod a_i!}\cdot(10-a_0),
   \]
   where the \((10-a_0)\) factor is exactly the leading-zero correction on the odd-side arrangement.

5. **Enumeration**: Loop over all \(3^{10}=59049\) vectors \((a_i)\), keep only vectors satisfying the two constraints, sum contributions, then reduce mod \(99991\).

## Wrong Approaches Observed
- **Dropped even-position multinomial factor**: Using only \((9!/\prod a_i!)(10-a_0)\) as the full per-vector contribution omits \((10!/\prod b_i!)\), producing the wrong modulo result **67591**.
- **Buggy verification subtraction**: In brute-force checking, using the leading-zero count directly instead of `N_even_total - leading_zero_count` yields a false mismatch and wrong modulo **83050**.

## Final Result
- Correct answer modulo 99991: **38631**.
