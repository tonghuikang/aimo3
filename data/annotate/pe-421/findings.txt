Problem: PE 421 - Sum of distinct prime factors of n^15+1

Correct Answer: 81624

Correct approach:
1. Swap summations:
   S = sum_{n=1..N} s(n,M) = sum_{p<=M} p * A(p),
   where A(p) = #{1<=n<=N : n^15 ≡ -1 (mod p)}.
2. For odd prime p, in (Z/pZ)^* the equation x^15 = -1 has exactly d = gcd(15, p-1) solutions.
   The solvability condition is always satisfied for odd p (equivalently, x = -1 is always a solution, and group-theoretic condition reduces automatically because d is odd).
3. Therefore for p>2:
   A(p) = d * floor(N/p) + t(p),
   where t(p) counts solution residues in [1, N mod p].
   For p=2, A(2)=N/2 (N=10^11 is even).
4. Classify d by prime residue class (mod 30):
   - d=15 for p ≡ 1 (mod 30)
   - d=5 for p ≡ 11 (mod 30)
   - d=3 for p ≡ 7,13,19 (mod 30)
   - d=1 for other odd prime classes
5. Compute t(p) exactly (not approximately): generate the subgroup of d-th roots of unity mod p, shift by -1 to get roots of x^15 ≡ -1, and count those <= N mod p.
6. Sum p*A(p) over all primes p<=10^8 (segmented sieve), reduce modulo 99991.

Wrong approaches and why they fail:
- "Only order 30 matters" (or "all p satisfy p ≡ 1 mod 30"):
  misses valid order-2/6/10 solutions (especially n ≡ -1), so it undercounts many primes.
- Treating the remainder term t(p) as negligible or replacing it by an average:
  gives only an approximation; exact modulo 99991 requires exact per-prime remainder counting.
- Inconsistent residue-class mapping for d=gcd(15,p-1) (especially mixing mod-15 classes without prime/parity constraints):
  misclassifies solution counts and corrupts the total.
