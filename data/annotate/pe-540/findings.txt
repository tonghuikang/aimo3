# Problem PE_540 - Primitive Pythagorean Triples

## Problem Summary
Count primitive Pythagorean triples with c ≤ N where N = 3141592653589793 (~π×10^15), answer modulo 99991.

## Correct Answer
53205

## Known Wrong Answers
- 50360 (eafgwz trace)
- 50359 (gkmsdc trace)

## Correct Approach
Primitive triples are generated by Euclid parameters:
- m > n > 0
- gcd(m,n) = 1
- m - n odd
- c = m² + n² ≤ N

So P(N) is the count of such pairs. Enforce gcd with Möbius inversion:
- P(N) = Σ_{d odd} μ(d) * T(⌊N/d²⌋)
- T(x) counts non-coprime pairs with opposite parity inside m²+n² ≤ x (with m>n handling folded into the parity-count geometry)

For this N, exact computation is done by:
- grouping equal values of ⌊N/d²⌋ (about O(N^{1/3}) distinct values),
- using fast odd-Möbius prefix sums for interval coefficients,
- evaluating T(x) exactly with integer-square-root block/grouping logic,
- validating against the given check P(10⁶)=159139.

This yields P(N) mod 99991 = 53205.

## Wrong Approaches And Why They Fail
- Wrong approach A (answer 50360):
  Uses asymptotic P(N) ≈ N/(2π) and takes floor/mod directly.
  Failure: the error term is not negligible mod 99991 at this scale, so approximation gives the wrong residue.

- Wrong approach B (answer 50359):
  Same asymptotic-led shortcut with ad hoc correction/rounding reasoning.
  Failure: no exact control of the lattice/Möbius correction terms; tiny-looking integer adjustments still change the final modulus.

- Recurring failure mode:
  Long symbolic reformulations without closing an exact executable counting pipeline (especially for T(x) and interval-weighted Möbius sums) lead to guess-based finalization near 5036x instead of the exact 53205.
