# Problem pe-914: Primitive Pythagorean Triangles Fitting Inside Circle

## Correct Answer
50612

## Correct Approach
A primitive Pythagorean triple can be written as
- `a = m^2 - n^2`, `b = 2mn`, `c = m^2 + n^2`
- `m > n > 0`, `gcd(m,n)=1`, opposite parity.

For a right triangle, the minimal enclosing circle has radius `c/2`. So fitting strictly inside radius `R` is exactly
- `c/2 < R`  <=>  `m^2 + n^2 < 2R`.

The inradius is
- `r = (a+b-c)/2 = n(m-n)`.

So we maximize `r = n(m-n)` under
- `m^2 + n^2 < 2R`
- `gcd(m,n)=1`
- `m-n` odd.

Using `u = m-n`, `v = n`, this is maximizing `uv` with
- `u^2 + 2uv + 2v^2 < 2R`
- `u` odd
- `gcd(u,v)=1`.

Continuous optimization gives `u/v = sqrt(2)` (equivalently `m/n = 1+sqrt(2)`), so the optimum is near
- `v0 = sqrt(R/(2+sqrt(2)))`.

Exact computation for `R = 10^18`:
- Search integer `v` near `v0`.
- For each `v`, take `u_max = floor(sqrt(2R - v^2)) - v`, then adjust downward to satisfy strict inequality, oddness, and coprimality.
- Best pair: `(v,u) = (541196602, 765366155)`.
- `r = uv = 414213562371805310`.
- `F(10^18) mod 99991 = 50612`.

Sanity check: for `R=100`, this method gives `(m,n)=(13,4)` and `r=36`, matching the statement.

## Wrong Approaches And Why They Fail
- Treating `F(R)` as exactly `floor((sqrt(2)-1)R)` (or equivalent floor formulas in terms of `2R-1`): this is only asymptotic and ignores discrete constraints. Example: at `R=100`, it gives `41`, but true `F(100)=36`.
- Restricting candidates only to Pell solutions `u^2 - 2v^2 = Â±1`: Pell points are good approximations to the optimal direction, but the true maximum under `m^2+n^2<2R` plus odd/coprime constraints is not guaranteed to lie exactly on this subset.
- Ignoring primitive constraints (`gcd`, parity) or the strict inequality (`c<2R`) overestimates the feasible maximum.
