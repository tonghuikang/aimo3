# PE 548 Findings

## Correct answer
- `\sum_{n \le 10^{16},\ g(n)=n} n \bmod 99991 = 71212`.
- `n=1` is included (`g(1)=1` via the trivial chain `{1}`).

## Correct mathematical structure
- Recurrence:
  - `g(1)=1`
  - `g(n)=\sum_{d\mid n,\ d<n} g(d)` for `n>1`.
- If `n=\prod p_i^{e_i}`, then `g(n)` depends only on exponent multiset `E=(e_1,\dots,e_k)` (divisor-lattice structure), not on prime identities.
- Interpreting chains as ordered nonempty multiset blocks gives, for fixed block count `b`:
  - `N_b(E)=\sum_{j=0}^{b} (-1)^j \binom{b}{j} \prod_i \binom{e_i+b-j-1}{b-j-1}`.
- Therefore:
  - `G(E)=\sum_{b=1}^{\sum e_i} N_b(E)` and `g(n)=G(E)`.
- Fixed-point condition is purely exponent-pattern matching:
  - `g(n)=n` iff the prime-factor exponent multiset of `G(E)` equals `E`.

## Correct computational approach
1. Enumerate exponent multisets `E` in sorted order (to avoid permutation duplicates).
2. Compute `G(E)` with the inclusion-exclusion formula above.
3. Prune branches when `G(E)>10^{16}` (monotonic growth in exponents).
4. Factor `G(E)` and keep `E` when exponent multisets match.
5. Add `n=1` separately.

This yields 21 numbers (including 1):
`1, 48, 1280, 2496, 28672, 29808, 454656, 2342912, 11534336, 57409536, 218103808, 34753216512, 73014444032, 583041810432, 1305670057984, 2624225017856, 404620279021568, 467515780104192, 1014849232437248, 4446425022726144, 5806013294837760`.

Their sum is `12144044603581281`, so modulo `99991` the answer is `71212`.

## Wrong approaches and why they fail
- **Assuming multiplicativity from `\sum_{d\mid n} g(d)=2g(n)`**:
  - This implication is invalid; `g` is not multiplicative, so this route gives contradictory or unusable formulas.
- **Counting via saturated chains then multiplying by block splits (`2^{L-1}`)**:
  - Overcounts, because many different saturated refinements collapse to the same non-saturated chain.
- **Truncating exponent search too aggressively (e.g., max tuple length 5)**:
  - Misses valid fixed points such as `5806013294837760` (`E=(1,1,1,1,1,28)`), producing an incomplete list and wrong final modulo.
