# Problem PE 884 - Findings

## Problem Summary
Repeatedly subtract the largest perfect cube not exceeding the current value.
Let `D(n)` be the number of subtraction steps to reach `0`.
Compute
`S(N) = sum_{1 <= n < N} D(n)` for `N = 10^17`, modulo `99991`.

## Correct Answer
`56395`

## Correct Approach
- Core recurrence for positive `n`:
  - `D(0) = 0`
  - `D(n) = 1 + D(n - floor(n^(1/3))^3)` for `n > 0`
- Work with cumulative sum `F(M) = sum_{0 <= n <= M} D(n)`, so `S(N) = F(N-1)`.
- Group by cube blocks `[k^3, (k+1)^3 - 1]` and define:
  - `B(k) = sum_{i=0}^{k-1} F(3i^2 + 3i)`
- Correct global recurrence (for `M >= 1`, `k = floor(M^(1/3))`):
  - `F(M) = M + B(k) + F(M - k^3)`
  - Base case: `F(0) = 0`
- Useful cube-step recurrence for iterative precompute:
  - `F(t^3) = F((t-1)^3) + L_t + F(L_t)`
  - `L_t = t^3 - (t-1)^3 = 3t^2 - 3t + 1`
- Precompute needed cube checkpoints up to `floor((10^17-1)^(1/3))`, memoize `F` values, and evaluate `F(10^17-1) mod 99991`.

## Wrong Approaches And Why They Fail
- Off-by-one cumulative recurrence:
  - Wrong formula used: `F(M) = M + 1 + B(k) + F(M - k^3)`.
  - This incorrectly treats the `i=0` block like positive blocks.
  - Immediate contradiction: it gives `S(100) = 596` instead of the required `512`.
- Root cause of the off-by-one:
  - Applying `D(n)=1 + D(n-k^3)` to the `n=0` case (or equivalently to the `i=0` block) is invalid.
  - `n=0` is a special base state with `D(0)=0` and must be handled separately.
- Non-productive detours:
  - Mixed-radix/asymptotic speculation without deriving a computable exact recurrence does not produce the required exact modular value.
